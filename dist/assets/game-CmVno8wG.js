import"./modulepreload-polyfill-B5Qt9EMX.js";var kt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Bs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Xn={},go;function Gs(){return go||(go=1,(function(){var e;function t(n){var o=0;return function(){return o<n.length?{done:!1,value:n[o++]}:{done:!0}}}var r=typeof Object.defineProperties=="function"?Object.defineProperty:function(n,o,s){return n==Array.prototype||n==Object.prototype||(n[o]=s.value),n};function i(n){n=[typeof globalThis=="object"&&globalThis,n,typeof window=="object"&&window,typeof self=="object"&&self,typeof kt=="object"&&kt];for(var o=0;o<n.length;++o){var s=n[o];if(s&&s.Math==Math)return s}throw Error("Cannot find global object")}var a=i(this);function u(n,o){if(o)e:{var s=a;n=n.split(".");for(var c=0;c<n.length-1;c++){var f=n[c];if(!(f in s))break e;s=s[f]}n=n[n.length-1],c=s[n],o=o(c),o!=c&&o!=null&&r(s,n,{configurable:!0,writable:!0,value:o})}}u("Symbol",function(n){function o(d){if(this instanceof o)throw new TypeError("Symbol is not a constructor");return new s(c+(d||"")+"_"+f++,d)}function s(d,h){this.h=d,r(this,"description",{configurable:!0,writable:!0,value:h})}if(n)return n;s.prototype.toString=function(){return this.h};var c="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",f=0;return o}),u("Symbol.iterator",function(n){if(n)return n;n=Symbol("Symbol.iterator");for(var o="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),s=0;s<o.length;s++){var c=a[o[s]];typeof c=="function"&&typeof c.prototype[n]!="function"&&r(c.prototype,n,{configurable:!0,writable:!0,value:function(){return l(t(this))}})}return n});function l(n){return n={next:n},n[Symbol.iterator]=function(){return this},n}function m(n){var o=typeof Symbol<"u"&&Symbol.iterator&&n[Symbol.iterator];return o?o.call(n):{next:t(n)}}function w(n){if(!(n instanceof Array)){n=m(n);for(var o,s=[];!(o=n.next()).done;)s.push(o.value);n=s}return n}var b=typeof Object.assign=="function"?Object.assign:function(n,o){for(var s=1;s<arguments.length;s++){var c=arguments[s];if(c)for(var f in c)Object.prototype.hasOwnProperty.call(c,f)&&(n[f]=c[f])}return n};u("Object.assign",function(n){return n||b});var z=typeof Object.create=="function"?Object.create:function(n){function o(){}return o.prototype=n,new o},A;if(typeof Object.setPrototypeOf=="function")A=Object.setPrototypeOf;else{var S;e:{var F={a:!0},E={};try{E.__proto__=F,S=E.a;break e}catch{}S=!1}A=S?function(n,o){if(n.__proto__=o,n.__proto__!==o)throw new TypeError(n+" is not extensible");return n}:null}var C=A;function H(n,o){if(n.prototype=z(o.prototype),n.prototype.constructor=n,C)C(n,o);else for(var s in o)if(s!="prototype")if(Object.defineProperties){var c=Object.getOwnPropertyDescriptor(o,s);c&&Object.defineProperty(n,s,c)}else n[s]=o[s];n.ya=o.prototype}function O(){this.m=!1,this.j=null,this.i=void 0,this.h=1,this.v=this.s=0,this.l=null}function K(n){if(n.m)throw new TypeError("Generator is already running");n.m=!0}O.prototype.u=function(n){this.i=n};function Y(n,o){n.l={ma:o,na:!0},n.h=n.s||n.v}O.prototype.return=function(n){this.l={return:n},this.h=this.v};function $(n,o,s){return n.h=s,{value:o}}function re(n){this.h=new O,this.i=n}function De(n,o){K(n.h);var s=n.h.j;return s?xe(n,"return"in s?s.return:function(c){return{value:c,done:!0}},o,n.h.return):(n.h.return(o),fe(n))}function xe(n,o,s,c){try{var f=o.call(n.h.j,s);if(!(f instanceof Object))throw new TypeError("Iterator result "+f+" is not an object");if(!f.done)return n.h.m=!1,f;var d=f.value}catch(h){return n.h.j=null,Y(n.h,h),fe(n)}return n.h.j=null,c.call(n.h,d),fe(n)}function fe(n){for(;n.h.h;)try{var o=n.i(n.h);if(o)return n.h.m=!1,{value:o.value,done:!1}}catch(s){n.h.i=void 0,Y(n.h,s)}if(n.h.m=!1,n.h.l){if(o=n.h.l,n.h.l=null,o.na)throw o.ma;return{value:o.return,done:!0}}return{value:void 0,done:!0}}function Re(n){this.next=function(o){return K(n.h),n.h.j?o=xe(n,n.h.j.next,o,n.h.u):(n.h.u(o),o=fe(n)),o},this.throw=function(o){return K(n.h),n.h.j?o=xe(n,n.h.j.throw,o,n.h.u):(Y(n.h,o),o=fe(n)),o},this.return=function(o){return De(n,o)},this[Symbol.iterator]=function(){return this}}function g(n){function o(c){return n.next(c)}function s(c){return n.throw(c)}return new Promise(function(c,f){function d(h){h.done?c(h.value):Promise.resolve(h.value).then(o,s).then(d,f)}d(n.next())})}function T(n){return g(new Re(new re(n)))}u("Promise",function(n){function o(h){this.i=0,this.j=void 0,this.h=[],this.u=!1;var p=this.l();try{h(p.resolve,p.reject)}catch(v){p.reject(v)}}function s(){this.h=null}function c(h){return h instanceof o?h:new o(function(p){p(h)})}if(n)return n;s.prototype.i=function(h){if(this.h==null){this.h=[];var p=this;this.j(function(){p.m()})}this.h.push(h)};var f=a.setTimeout;s.prototype.j=function(h){f(h,0)},s.prototype.m=function(){for(;this.h&&this.h.length;){var h=this.h;this.h=[];for(var p=0;p<h.length;++p){var v=h[p];h[p]=null;try{v()}catch(k){this.l(k)}}}this.h=null},s.prototype.l=function(h){this.j(function(){throw h})},o.prototype.l=function(){function h(k){return function(I){v||(v=!0,k.call(p,I))}}var p=this,v=!1;return{resolve:h(this.I),reject:h(this.m)}},o.prototype.I=function(h){if(h===this)this.m(new TypeError("A Promise cannot resolve to itself"));else if(h instanceof o)this.L(h);else{e:switch(typeof h){case"object":var p=h!=null;break e;case"function":p=!0;break e;default:p=!1}p?this.F(h):this.s(h)}},o.prototype.F=function(h){var p=void 0;try{p=h.then}catch(v){this.m(v);return}typeof p=="function"?this.M(p,h):this.s(h)},o.prototype.m=function(h){this.v(2,h)},o.prototype.s=function(h){this.v(1,h)},o.prototype.v=function(h,p){if(this.i!=0)throw Error("Cannot settle("+h+", "+p+"): Promise already settled in state"+this.i);this.i=h,this.j=p,this.i===2&&this.K(),this.H()},o.prototype.K=function(){var h=this;f(function(){if(h.D()){var p=a.console;typeof p<"u"&&p.error(h.j)}},1)},o.prototype.D=function(){if(this.u)return!1;var h=a.CustomEvent,p=a.Event,v=a.dispatchEvent;return typeof v>"u"?!0:(typeof h=="function"?h=new h("unhandledrejection",{cancelable:!0}):typeof p=="function"?h=new p("unhandledrejection",{cancelable:!0}):(h=a.document.createEvent("CustomEvent"),h.initCustomEvent("unhandledrejection",!1,!0,h)),h.promise=this,h.reason=this.j,v(h))},o.prototype.H=function(){if(this.h!=null){for(var h=0;h<this.h.length;++h)d.i(this.h[h]);this.h=null}};var d=new s;return o.prototype.L=function(h){var p=this.l();h.T(p.resolve,p.reject)},o.prototype.M=function(h,p){var v=this.l();try{h.call(p,v.resolve,v.reject)}catch(k){v.reject(k)}},o.prototype.then=function(h,p){function v(U,j){return typeof U=="function"?function(V){try{k(U(V))}catch(Q){I(Q)}}:j}var k,I,W=new o(function(U,j){k=U,I=j});return this.T(v(h,k),v(p,I)),W},o.prototype.catch=function(h){return this.then(void 0,h)},o.prototype.T=function(h,p){function v(){switch(k.i){case 1:h(k.j);break;case 2:p(k.j);break;default:throw Error("Unexpected state: "+k.i)}}var k=this;this.h==null?d.i(v):this.h.push(v),this.u=!0},o.resolve=c,o.reject=function(h){return new o(function(p,v){v(h)})},o.race=function(h){return new o(function(p,v){for(var k=m(h),I=k.next();!I.done;I=k.next())c(I.value).T(p,v)})},o.all=function(h){var p=m(h),v=p.next();return v.done?c([]):new o(function(k,I){function W(V){return function(Q){U[V]=Q,j--,j==0&&k(U)}}var U=[],j=0;do U.push(void 0),j++,c(v.value).T(W(U.length-1),I),v=p.next();while(!v.done)})},o});function N(n,o){n instanceof String&&(n+="");var s=0,c=!1,f={next:function(){if(!c&&s<n.length){var d=s++;return{value:o(d,n[d]),done:!1}}return c=!0,{done:!0,value:void 0}}};return f[Symbol.iterator]=function(){return f},f}u("Array.prototype.keys",function(n){return n||function(){return N(this,function(o){return o})}}),u("Array.prototype.fill",function(n){return n||function(o,s,c){var f=this.length||0;for(0>s&&(s=Math.max(0,f+s)),(c==null||c>f)&&(c=f),c=Number(c),0>c&&(c=Math.max(0,f+c)),s=Number(s||0);s<c;s++)this[s]=o;return this}});function Z(n){return n||Array.prototype.fill}u("Int8Array.prototype.fill",Z),u("Uint8Array.prototype.fill",Z),u("Uint8ClampedArray.prototype.fill",Z),u("Int16Array.prototype.fill",Z),u("Uint16Array.prototype.fill",Z),u("Int32Array.prototype.fill",Z),u("Uint32Array.prototype.fill",Z),u("Float32Array.prototype.fill",Z),u("Float64Array.prototype.fill",Z),u("Object.is",function(n){return n||function(o,s){return o===s?o!==0||1/o===1/s:o!==o&&s!==s}}),u("Array.prototype.includes",function(n){return n||function(o,s){var c=this;c instanceof String&&(c=String(c));var f=c.length;for(s=s||0,0>s&&(s=Math.max(s+f,0));s<f;s++){var d=c[s];if(d===o||Object.is(d,o))return!0}return!1}}),u("String.prototype.includes",function(n){return n||function(o,s){if(this==null)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(o instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return this.indexOf(o,s||0)!==-1}});var ee=this||self;function ae(n,o){n=n.split(".");var s=ee;n[0]in s||typeof s.execScript>"u"||s.execScript("var "+n[0]);for(var c;n.length&&(c=n.shift());)n.length||o===void 0?s[c]&&s[c]!==Object.prototype[c]?s=s[c]:s=s[c]={}:s[c]=o}function M(n){var o;e:{if((o=ee.navigator)&&(o=o.userAgent))break e;o=""}return o.indexOf(n)!=-1}var L=Array.prototype.map?function(n,o){return Array.prototype.map.call(n,o,void 0)}:function(n,o){for(var s=n.length,c=Array(s),f=typeof n=="string"?n.split(""):n,d=0;d<s;d++)d in f&&(c[d]=o.call(void 0,f[d],d,n));return c},q={},ne=null;function ve(n){var o=n.length,s=3*o/4;s%3?s=Math.floor(s):"=.".indexOf(n[o-1])!=-1&&(s="=.".indexOf(n[o-2])!=-1?s-2:s-1);var c=new Uint8Array(s),f=0;return Ge(n,function(d){c[f++]=d}),f!==s?c.subarray(0,f):c}function Ge(n,o){function s(v){for(;c<n.length;){var k=n.charAt(c++),I=ne[k];if(I!=null)return I;if(!/^[\s\xa0]*$/.test(k))throw Error("Unknown base64 encoding at char: "+k)}return v}ge();for(var c=0;;){var f=s(-1),d=s(0),h=s(64),p=s(64);if(p===64&&f===-1)break;o(f<<2|d>>4),h!=64&&(o(d<<4&240|h>>2),p!=64&&o(h<<6&192|p))}}function ge(){if(!ne){ne={};for(var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),o=["+/=","+/","-_=","-_.","-_"],s=0;5>s;s++){var c=n.concat(o[s].split(""));q[s]=c;for(var f=0;f<c.length;f++){var d=c[f];ne[d]===void 0&&(ne[d]=f)}}}}var Ee=typeof Uint8Array<"u",Pe=!(M("Trident")||M("MSIE"))&&typeof ee.btoa=="function";function je(n){if(!Pe){var o;o===void 0&&(o=0),ge(),o=q[o];for(var s=Array(Math.floor(n.length/3)),c=o[64]||"",f=0,d=0;f<n.length-2;f+=3){var h=n[f],p=n[f+1],v=n[f+2],k=o[h>>2];h=o[(h&3)<<4|p>>4],p=o[(p&15)<<2|v>>6],v=o[v&63],s[d++]=k+h+p+v}switch(k=0,v=c,n.length-f){case 2:k=n[f+1],v=o[(k&15)<<2]||c;case 1:n=n[f],s[d]=o[n>>2]+o[(n&3)<<4|k>>4]+v+c}return s.join("")}for(o="";10240<n.length;)o+=String.fromCharCode.apply(null,n.subarray(0,10240)),n=n.subarray(10240);return o+=String.fromCharCode.apply(null,n),btoa(o)}var Qe=RegExp("[-_.]","g");function vt(n){switch(n){case"-":return"+";case"_":return"/";case".":return"=";default:return""}}function it(n){if(!Pe)return ve(n);Qe.test(n)&&(n=n.replace(Qe,vt)),n=atob(n);for(var o=new Uint8Array(n.length),s=0;s<n.length;s++)o[s]=n.charCodeAt(s);return o}var st;function pe(){return st||(st=new Uint8Array(0))}var X={},R=typeof Uint8Array.prototype.slice=="function",_=0,y=0;function P(n){var o=0>n;n=Math.abs(n);var s=n>>>0;n=Math.floor((n-s)/4294967296),o&&(s=m(J(s,n)),o=s.next().value,n=s.next().value,s=o),_=s>>>0,y=n>>>0}var D=typeof BigInt=="function";function J(n,o){return o=~o,n?n=~n+1:o+=1,[n,o]}function me(n,o){this.i=n>>>0,this.h=o>>>0}function ye(n){if(!n)return Ye||(Ye=new me(0,0));if(!/^-?\d+$/.test(n))return null;if(16>n.length)P(Number(n));else if(D)n=BigInt(n),_=Number(n&BigInt(4294967295))>>>0,y=Number(n>>BigInt(32)&BigInt(4294967295));else{var o=+(n[0]==="-");y=_=0;for(var s=n.length,c=o,f=(s-o)%6+o;f<=s;c=f,f+=6)c=Number(n.slice(c,f)),y*=1e6,_=1e6*_+c,4294967296<=_&&(y+=_/4294967296|0,_%=4294967296);o&&(o=m(J(_,y)),n=o.next().value,o=o.next().value,_=n,y=o)}return new me(_,y)}var Ye;function et(n,o){return Error("Invalid wire type: "+n+" (at position "+o+")")}function Hn(){return Error("Failed to read varint, encoding is invalid.")}function Rr(n,o){return Error("Tried to read past the end of the data "+o+" > "+n)}function at(){throw Error("Invalid UTF8")}function kr(n,o){return o=String.fromCharCode.apply(null,o),n==null?o:n+o}var Yt=void 0,An,Ji=typeof TextDecoder<"u",Mr,qi=typeof TextEncoder<"u",Sr;function zr(n){if(n!==X)throw Error("illegal external caller")}function At(n,o){if(zr(o),this.V=n,n!=null&&n.length===0)throw Error("ByteString should be constructed with non-empty values")}function Cn(){return Sr||(Sr=new At(null,X))}function Hr(n){zr(X);var o=n.V;return o=o==null||Ee&&o!=null&&o instanceof Uint8Array?o:typeof o=="string"?it(o):null,o==null?o:n.V=o}function Qi(n){if(typeof n=="string")return{buffer:it(n),C:!1};if(Array.isArray(n))return{buffer:new Uint8Array(n),C:!1};if(n.constructor===Uint8Array)return{buffer:n,C:!1};if(n.constructor===ArrayBuffer)return{buffer:new Uint8Array(n),C:!1};if(n.constructor===At)return{buffer:Hr(n)||pe(),C:!0};if(n instanceof Uint8Array)return{buffer:new Uint8Array(n.buffer,n.byteOffset,n.byteLength),C:!1};throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, a ByteString or an Array of numbers")}function Ar(n,o){this.i=null,this.m=!1,this.h=this.j=this.l=0,In(this,n,o)}function In(n,o,s){s=s===void 0?{}:s,n.S=s.S===void 0?!1:s.S,o&&(o=Qi(o),n.i=o.buffer,n.m=o.C,n.l=0,n.j=n.i.length,n.h=n.l)}Ar.prototype.reset=function(){this.h=this.l};function ct(n,o){if(n.h=o,o>n.j)throw Rr(n.j,o)}function Ct(n){var o=n.i,s=n.h,c=o[s++],f=c&127;if(c&128&&(c=o[s++],f|=(c&127)<<7,c&128&&(c=o[s++],f|=(c&127)<<14,c&128&&(c=o[s++],f|=(c&127)<<21,c&128&&(c=o[s++],f|=c<<28,c&128&&o[s++]&128&&o[s++]&128&&o[s++]&128&&o[s++]&128&&o[s++]&128)))))throw Hn();return ct(n,s),f}function Cr(n,o){if(0>o)throw Error("Tried to read a negative byte length: "+o);var s=n.h,c=s+o;if(c>n.j)throw Rr(o,n.j-s);return n.h=c,s}var Ir=[];function Pn(){this.h=[]}Pn.prototype.length=function(){return this.h.length},Pn.prototype.end=function(){var n=this.h;return this.h=[],n};function Pr(n,o,s){for(;0<s||127<o;)n.h.push(o&127|128),o=(o>>>7|s<<25)>>>0,s>>>=7;n.h.push(o)}function ut(n,o){for(;127<o;)n.h.push(o&127|128),o>>>=7;n.h.push(o)}function jn(n,o){if(Ir.length){var s=Ir.pop();In(s,n,o),n=s}else n=new Ar(n,o);this.h=n,this.j=this.h.h,this.i=this.l=-1,this.setOptions(o)}jn.prototype.setOptions=function(n){n=n===void 0?{}:n,this.ca=n.ca===void 0?!1:n.ca},jn.prototype.reset=function(){this.h.reset(),this.j=this.h.h,this.i=this.l=-1};function jr(n){var o=n.h;if(o.h==o.j)return!1;n.j=n.h.h;var s=Ct(n.h)>>>0;if(o=s>>>3,s&=7,!(0<=s&&5>=s))throw et(s,n.j);if(1>o)throw Error("Invalid field number: "+o+" (at position "+n.j+")");return n.l=o,n.i=s,!0}function Kt(n){switch(n.i){case 0:if(n.i!=0)Kt(n);else e:{n=n.h;for(var o=n.h,s=o+10,c=n.i;o<s;)if((c[o++]&128)===0){ct(n,o);break e}throw Hn()}break;case 1:n=n.h,ct(n,n.h+8);break;case 2:n.i!=2?Kt(n):(o=Ct(n.h)>>>0,n=n.h,ct(n,n.h+o));break;case 5:n=n.h,ct(n,n.h+4);break;case 3:o=n.l;do{if(!jr(n))throw Error("Unmatched start-group tag: stream EOF");if(n.i==4){if(n.l!=o)throw Error("Unmatched end-group tag");break}Kt(n)}while(!0);break;default:throw et(n.i,n.j)}}var Xt=[];function es(){this.j=[],this.i=0,this.h=new Pn}function wt(n,o){o.length!==0&&(n.j.push(o),n.i+=o.length)}function ts(n,o){if(o=o.R){wt(n,n.h.end());for(var s=0;s<o.length;s++)wt(n,Hr(o[s])||pe())}}var Ke=typeof Symbol=="function"&&typeof Symbol()=="symbol"?Symbol():void 0;function lt(n,o){return Ke?n[Ke]|=o:n.A!==void 0?n.A|=o:(Object.defineProperties(n,{A:{value:o,configurable:!0,writable:!0,enumerable:!1}}),o)}function Or(n,o){Ke?n[Ke]&&(n[Ke]&=~o):n.A!==void 0&&(n.A&=~o)}function de(n){var o;return Ke?o=n[Ke]:o=n.A,o??0}function Le(n,o){Ke?n[Ke]=o:n.A!==void 0?n.A=o:Object.defineProperties(n,{A:{value:o,configurable:!0,writable:!0,enumerable:!1}})}function On(n){return lt(n,1),n}function ns(n,o){Le(o,(n|0)&-51)}function Jt(n,o){Le(o,(n|18)&-41)}var $n={};function qt(n){return n!==null&&typeof n=="object"&&!Array.isArray(n)&&n.constructor===Object}var It,$r=[];Le($r,23),It=Object.freeze($r);function Bn(n){if(de(n.o)&2)throw Error("Cannot mutate an immutable Message")}function Gn(n){var o=n.length;(o=o?n[o-1]:void 0)&&qt(o)?o.g=1:(o={},n.push((o.g=1,o)))}function Br(n){var o=n.i+n.G;return n.B||(n.B=n.o[o]={})}function Ze(n,o){return o===-1?null:o>=n.i?n.B?n.B[o]:void 0:n.o[o+n.G]}function Fe(n,o,s,c){Bn(n),Pt(n,o,s,c)}function Pt(n,o,s,c){n.j&&(n.j=void 0),o>=n.i||c?Br(n)[o]=s:(n.o[o+n.G]=s,(n=n.B)&&o in n&&delete n[o])}function Zn(n,o,s,c){var f=Ze(n,o);Array.isArray(f)||(f=It);var d=de(f);if(d&1||On(f),c)d&2||lt(f,2),s&1||Object.freeze(f);else{c=!(s&2);var h=d&2;s&1||!h?c&&d&16&&!h&&Or(f,16):(f=On(Array.prototype.slice.call(f)),Pt(n,o,f))}return f}function Un(n,o){var s=Ze(n,o),c=s==null?s:typeof s=="number"||s==="NaN"||s==="Infinity"||s==="-Infinity"?Number(s):void 0;return c!=null&&c!==s&&Pt(n,o,c),c}function Gr(n,o,s,c,f){n.h||(n.h={});var d=n.h[s],h=Zn(n,s,3,f);if(!d){var p=h;d=[];var v=!!(de(n.o)&16);h=!!(de(p)&2);var k=p;!f&&h&&(p=Array.prototype.slice.call(p));for(var I=h,W=0;W<p.length;W++){var U=p[W],j=o,V=!1;if(V=V===void 0?!1:V,U=Array.isArray(U)?new j(U):V?new j:void 0,U!==void 0){j=U.o;var Q=V=de(j);h&&(Q|=2),v&&(Q|=16),Q!=V&&Le(j,Q),j=Q,I=I||!!(2&j),d.push(U)}}return n.h[s]=d,v=de(p),o=v|33,o=I?o&-9:o|8,v!=o&&(I=p,Object.isFrozen(I)&&(I=Array.prototype.slice.call(I)),Le(I,o),p=I),k!==p&&Pt(n,s,p),(f||c&&h)&&lt(d,2),c&&Object.freeze(d),d}return f||(f=Object.isFrozen(d),c&&!f?Object.freeze(d):!c&&f&&(d=Array.prototype.slice.call(d),n.h[s]=d)),d}function Qt(n,o,s){var c=!!(de(n.o)&2);if(o=Gr(n,o,s,c,c),n=Zn(n,s,3,c),!(c||de(n)&8)){for(c=0;c<o.length;c++){if(s=o[c],de(s.o)&2){var f=Nr(s,!1);f.j=s}else f=s;s!==f&&(o[c]=f,n[c]=f.o)}lt(n,8)}return o}function Ne(n,o,s){if(s!=null&&typeof s!="number")throw Error("Value of float/double field must be a number|null|undefined, found "+typeof s+": "+s);Fe(n,o,s)}function Zr(n,o,s,c,f){Bn(n);var d=Gr(n,s,o,!1,!1);return s=c??new s,n=Zn(n,o,2,!1),f!=null?(d.splice(f,0,s),n.splice(f,0,s.o)):(d.push(s),n.push(s.o)),s.C()&&Or(n,8),s}function en(n,o){return n??o}function We(n,o,s){return s=s===void 0?0:s,en(Un(n,o),s)}var tn;function rs(n){switch(typeof n){case"number":return isFinite(n)?n:String(n);case"object":if(n)if(Array.isArray(n)){if((de(n)&128)!==0)return n=Array.prototype.slice.call(n),Gn(n),n}else{if(Ee&&n!=null&&n instanceof Uint8Array)return je(n);if(n instanceof At){var o=n.V;return o==null?"":typeof o=="string"?o:n.V=je(o)}}}return n}function Ur(n,o,s,c){if(n!=null){if(Array.isArray(n))n=Dn(n,o,s,c!==void 0);else if(qt(n)){var f={},d;for(d in n)f[d]=Ur(n[d],o,s,c);n=f}else n=o(n,c);return n}}function Dn(n,o,s,c){var f=de(n);c=c?!!(f&16):void 0,n=Array.prototype.slice.call(n);for(var d=0;d<n.length;d++)n[d]=Ur(n[d],o,s,c);return s(f,n),n}function os(n){return n.ja===$n?n.toJSON():rs(n)}function is(n,o){n&128&&Gn(o)}function Dr(n,o,s){if(s=s===void 0?Jt:s,n!=null){if(Ee&&n instanceof Uint8Array)return n.length?new At(new Uint8Array(n),X):Cn();if(Array.isArray(n)){var c=de(n);return c&2?n:o&&!(c&32)&&(c&16||c===0)?(Le(n,c|2),n):(n=Dn(n,Dr,c&4?Jt:s,!0),o=de(n),o&4&&o&2&&Object.freeze(n),n)}return n.ja===$n?Fr(n):n}}function Lr(n,o,s,c,f,d,h){if(n=n.h&&n.h[s]){if(c=de(n),c&2?c=n:(d=L(n,Fr),Jt(c,d),Object.freeze(d),c=d),Bn(o),h=c==null?It:On([]),c!=null){for(d=!!c.length,n=0;n<c.length;n++){var p=c[n];d=d&&!(de(p.o)&2),h[n]=p.o}d=(d?8:0)|1,n=de(h),(n&d)!==d&&(Object.isFrozen(h)&&(h=Array.prototype.slice.call(h)),Le(h,n|d)),o.h||(o.h={}),o.h[s]=c}else o.h&&(o.h[s]=void 0);Pt(o,s,h,f)}else Fe(o,s,Dr(c,d,h),f)}function Fr(n){return de(n.o)&2||(n=Nr(n,!0),lt(n.o,2)),n}function Nr(n,o){var s=n.o,c=[];lt(c,16);var f=n.constructor.h;if(f&&c.push(f),f=n.B,f){c.length=s.length,c.fill(void 0,c.length,s.length);var d={};c[c.length-1]=d}(de(s)&128)!==0&&Gn(c),o=o||n.C()?Jt:ns,d=n.constructor,tn=c,c=new d(c),tn=void 0,n.R&&(c.R=n.R.slice()),d=!!(de(s)&16);for(var h=f?s.length-1:s.length,p=0;p<h;p++)Lr(n,c,p-n.G,s[p],!1,d,o);if(f)for(var v in f)Lr(n,c,+v,f[v],!0,d,o);return c}function ze(n,o,s){n==null&&(n=tn),tn=void 0;var c=this.constructor.i||0,f=0<c,d=this.constructor.h,h=!1;if(n==null){n=d?[d]:[];var p=48,v=!0;f&&(c=0,p|=128),Le(n,p)}else{if(!Array.isArray(n)||d&&d!==n[0])throw Error();var k=p=lt(n,0);if((v=(16&k)!==0)&&((h=(32&k)!==0)||(k|=32)),f){if(128&k)c=0;else if(0<n.length){var I=n[n.length-1];if(qt(I)&&"g"in I){c=0,k|=128,delete I.g;var W=!0,U;for(U in I){W=!1;break}W&&n.pop()}}}else if(128&k)throw Error();p!==k&&Le(n,k)}this.G=(d?0:-1)-c,this.h=void 0,this.o=n;e:{if(d=this.o.length,c=d-1,d&&(d=this.o[c],qt(d))){this.B=d,this.i=c-this.G;break e}o!==void 0&&-1<o?(this.i=Math.max(o,c+1-this.G),this.B=void 0):this.i=Number.MAX_VALUE}if(!f&&this.B&&"g"in this.B)throw Error('Unexpected "g" flag in sparse object of message that is not a group type.');if(s){o=v&&!h&&!0,f=this.i;var j;for(v=0;v<s.length;v++)h=s[v],h<f?(h+=this.G,(c=n[h])?Wr(c,o):n[h]=It):(j||(j=Br(this)),(c=j[h])?Wr(c,o):j[h]=It)}}ze.prototype.toJSON=function(){return Dn(this.o,os,is)},ze.prototype.C=function(){return!!(de(this.o)&2)};function Wr(n,o){if(Array.isArray(n)){var s=de(n),c=1;!o||s&2||(c|=16),(s&c)!==c&&Le(n,s|c)}}ze.prototype.ja=$n,ze.prototype.toString=function(){return this.o.toString()};function Vr(n,o,s){if(s){var c={},f;for(f in s){var d=s[f],h=d.qa;h||(c.J=d.wa||d.oa.W,d.ia?(c.aa=qr(d.ia),h=(function(p){return function(v,k,I){return p.J(v,k,I,p.aa)}})(c)):d.ka?(c.Z=Qr(d.da.P,d.ka),h=(function(p){return function(v,k,I){return p.J(v,k,I,p.Z)}})(c)):h=c.J,d.qa=h),h(o,n,d.da),c={J:c.J,aa:c.aa,Z:c.Z}}}ts(o,n)}var nn=Symbol();function Yr(n,o,s){return n[nn]||(n[nn]=function(c,f){return o(c,f,s)})}function Kr(n){var o=n[nn];if(!o){var s=Fn(n);o=function(c,f){return eo(c,f,s)},n[nn]=o}return o}function ss(n){var o=n.ia;if(o)return Kr(o);if(o=n.va)return Yr(n.da.P,o,n.ka)}function as(n){var o=ss(n),s=n.da,c=n.oa.U;return o?function(f,d){return c(f,d,s,o)}:function(f,d){return c(f,d,s)}}function Xr(n,o){var s=n[o];return typeof s=="function"&&s.length===0&&(s=s(),n[o]=s),Array.isArray(s)&&(Ot in s||jt in s||0<s.length&&typeof s[0]=="function")?s:void 0}function Jr(n,o,s,c,f,d){o.P=n[0];var h=1;if(n.length>h&&typeof n[h]!="number"){var p=n[h++];s(o,p)}for(;h<n.length;){s=n[h++];for(var v=h+1;v<n.length&&typeof n[v]!="number";)v++;switch(p=n[h++],v-=h,v){case 0:c(o,s,p);break;case 1:(v=Xr(n,h))?(h++,f(o,s,p,v)):c(o,s,p,n[h++]);break;case 2:v=h++,v=Xr(n,v),f(o,s,p,v,n[h++]);break;case 3:d(o,s,p,n[h++],n[h++],n[h++]);break;case 4:d(o,s,p,n[h++],n[h++],n[h++],n[h++]);break;default:throw Error("unexpected number of binary field arguments: "+v)}}return o}var rn=Symbol();function qr(n){var o=n[rn];if(!o){var s=Ln(n);o=function(c,f){return to(c,f,s)},n[rn]=o}return o}function Qr(n,o){var s=n[rn];return s||(s=function(c,f){return Vr(c,f,o)},n[rn]=s),s}var jt=Symbol();function cs(n,o){n.push(o)}function us(n,o,s){n.push(o,s.W)}function ls(n,o,s,c){var f=qr(c),d=Ln(c).P,h=s.W;n.push(o,function(p,v,k){return h(p,v,k,d,f)})}function fs(n,o,s,c,f,d){var h=Qr(c,d),p=s.W;n.push(o,function(v,k,I){return p(v,k,I,c,h)})}function Ln(n){var o=n[jt];return o||(o=Jr(n,n[jt]=[],cs,us,ls,fs),Ot in n&&jt in n&&(n.length=0),o)}var Ot=Symbol();function hs(n,o){n[0]=o}function ds(n,o,s,c){var f=s.U;n[o]=c?function(d,h,p){return f(d,h,p,c)}:f}function ps(n,o,s,c,f){var d=s.U,h=Kr(c),p=Fn(c).P;n[o]=function(v,k,I){return d(v,k,I,p,h,f)}}function ms(n,o,s,c,f,d,h){var p=s.U,v=Yr(c,f,d);n[o]=function(k,I,W){return p(k,I,W,c,v,h)}}function Fn(n){var o=n[Ot];return o||(o=Jr(n,n[Ot]={},hs,ds,ps,ms),Ot in n&&jt in n&&(n.length=0),o)}function eo(n,o,s){for(;jr(o)&&o.i!=4;){var c=o.l,f=s[c];if(!f){var d=s[0];d&&(d=d[c])&&(f=s[c]=as(d))}if(!f||!f(o,n,c)){f=o,c=n,d=f.j,Kt(f);var h=f;if(!h.ca){if(f=h.h.h-d,h.h.h=d,h=h.h,f==0)f=Cn();else{if(d=Cr(h,f),h.S&&h.m)f=h.i.subarray(d,d+f);else{h=h.i;var p=d;f=d+f,f=p===f?pe():R?h.slice(p,f):new Uint8Array(h.subarray(p,f))}f=f.length==0?Cn():new At(f,X)}(d=c.R)?d.push(f):c.R=[f]}}}return n}function to(n,o,s){for(var c=s.length,f=c%2==1,d=f?1:0;d<c;d+=2)(0,s[d+1])(o,n,s[d]);Vr(n,o,f?s[0]:void 0)}function $t(n,o){return{U:n,W:o}}var Ue=$t(function(n,o,s){if(n.i!==5)return!1;n=n.h;var c=n.i,f=n.h,d=c[f],h=c[f+1],p=c[f+2];return c=c[f+3],ct(n,n.h+4),h=(d<<0|h<<8|p<<16|c<<24)>>>0,n=2*(h>>31)+1,d=h>>>23&255,h&=8388607,Fe(o,s,d==255?h?NaN:1/0*n:d==0?n*Math.pow(2,-149)*h:n*Math.pow(2,d-150)*(h+Math.pow(2,23))),!0},function(n,o,s){if(o=Un(o,s),o!=null){ut(n.h,8*s+5),n=n.h;var c=+o;c===0?0<1/c?_=y=0:(y=0,_=2147483648):isNaN(c)?(y=0,_=2147483647):(c=(s=0>c?-2147483648:0)?-c:c,34028234663852886e22<c?(y=0,_=(s|2139095040)>>>0):11754943508222875e-54>c?(c=Math.round(c/Math.pow(2,-149)),y=0,_=(s|c)>>>0):(o=Math.floor(Math.log(c)/Math.LN2),c*=Math.pow(2,-o),c=Math.round(8388608*c),16777216<=c&&++o,y=0,_=(s|o+127<<23|c&8388607)>>>0)),s=_,n.h.push(s>>>0&255),n.h.push(s>>>8&255),n.h.push(s>>>16&255),n.h.push(s>>>24&255)}}),ys=$t(function(n,o,s){if(n.i!==0)return!1;var c=n.h,f=0,d=n=0,h=c.i,p=c.h;do{var v=h[p++];f|=(v&127)<<d,d+=7}while(32>d&&v&128);for(32<d&&(n|=(v&127)>>4),d=3;32>d&&v&128;d+=7)v=h[p++],n|=(v&127)<<d;if(ct(c,p),128>v)c=f>>>0,v=n>>>0,(n=v&2147483648)&&(c=~c+1>>>0,v=~v>>>0,c==0&&(v=v+1>>>0)),c=4294967296*v+(c>>>0);else throw Hn();return Fe(o,s,n?-c:c),!0},function(n,o,s){o=Ze(o,s),o!=null&&(typeof o=="string"&&ye(o),o!=null&&(ut(n.h,8*s),typeof o=="number"?(n=n.h,P(o),Pr(n,_,y)):(s=ye(o),Pr(n.h,s.i,s.h))))}),vs=$t(function(n,o,s){return n.i!==0?!1:(Fe(o,s,Ct(n.h)),!0)},function(n,o,s){if(o=Ze(o,s),o!=null&&o!=null)if(ut(n.h,8*s),n=n.h,s=o,0<=s)ut(n,s);else{for(o=0;9>o;o++)n.h.push(s&127|128),s>>=7;n.h.push(1)}}),no=$t(function(n,o,s){if(n.i!==2)return!1;var c=Ct(n.h)>>>0;n=n.h;var f=Cr(n,c);if(n=n.i,Ji){var d=n,h;(h=An)||(h=An=new TextDecoder("utf-8",{fatal:!0})),n=f+c,d=f===0&&n===d.length?d:d.subarray(f,n);try{var p=h.decode(d)}catch(W){if(Yt===void 0){try{h.decode(new Uint8Array([128]))}catch{}try{h.decode(new Uint8Array([97])),Yt=!0}catch{Yt=!1}}throw!Yt&&(An=void 0),W}}else{p=f,c=p+c,f=[];for(var v=null,k,I;p<c;)k=n[p++],128>k?f.push(k):224>k?p>=c?at():(I=n[p++],194>k||(I&192)!==128?(p--,at()):f.push((k&31)<<6|I&63)):240>k?p>=c-1?at():(I=n[p++],(I&192)!==128||k===224&&160>I||k===237&&160<=I||((d=n[p++])&192)!==128?(p--,at()):f.push((k&15)<<12|(I&63)<<6|d&63)):244>=k?p>=c-2?at():(I=n[p++],(I&192)!==128||(k<<28)+(I-144)>>30!==0||((d=n[p++])&192)!==128||((h=n[p++])&192)!==128?(p--,at()):(k=(k&7)<<18|(I&63)<<12|(d&63)<<6|h&63,k-=65536,f.push((k>>10&1023)+55296,(k&1023)+56320))):at(),8192<=f.length&&(v=kr(v,f),f.length=0);p=kr(v,f)}return Fe(o,s,p),!0},function(n,o,s){if(o=Ze(o,s),o!=null){var c=!1;if(c=c===void 0?!1:c,qi){if(c&&/(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])/.test(o))throw Error("Found an unpaired surrogate");o=(Mr||(Mr=new TextEncoder)).encode(o)}else{for(var f=0,d=new Uint8Array(3*o.length),h=0;h<o.length;h++){var p=o.charCodeAt(h);if(128>p)d[f++]=p;else{if(2048>p)d[f++]=p>>6|192;else{if(55296<=p&&57343>=p){if(56319>=p&&h<o.length){var v=o.charCodeAt(++h);if(56320<=v&&57343>=v){p=1024*(p-55296)+v-56320+65536,d[f++]=p>>18|240,d[f++]=p>>12&63|128,d[f++]=p>>6&63|128,d[f++]=p&63|128;continue}else h--}if(c)throw Error("Found an unpaired surrogate");p=65533}d[f++]=p>>12|224,d[f++]=p>>6&63|128}d[f++]=p&63|128}}o=f===d.length?d:d.subarray(0,f)}ut(n.h,8*s+2),ut(n.h,o.length),wt(n,n.h.end()),wt(n,o)}}),ro=$t(function(n,o,s,c,f){if(n.i!==2)return!1;o=Zr(o,s,c),s=n.h.j,c=Ct(n.h)>>>0;var d=n.h.h+c,h=d-s;if(0>=h&&(n.h.j=d,f(o,n,void 0,void 0,void 0),h=d-n.h.h),h)throw Error("Message parsing ended unexpectedly. Expected to read "+(c+" bytes, instead read "+(c-h)+" bytes, either the data ended unexpectedly or the message misreported its own length"));return n.h.h=d,n.h.j=s,!0},function(n,o,s,c,f){if(o=Qt(o,c,s),o!=null)for(c=0;c<o.length;c++){var d=n;ut(d.h,8*s+2);var h=d.h.end();wt(d,h),h.push(d.i),d=h,f(o[c],n),h=n;var p=d.pop();for(p=h.i+h.h.length()-p;127<p;)d.push(p&127|128),p>>>=7,h.i++;d.push(p),h.i++}});function Nn(n){return function(o,s){e:{if(Xt.length){var c=Xt.pop();c.setOptions(s),In(c.h,o,s),o=c}else o=new jn(o,s);try{var f=Fn(n),d=eo(new f.P,o,f);break e}finally{f=o.h,f.i=null,f.m=!1,f.l=0,f.j=0,f.h=0,f.S=!1,o.l=-1,o.i=-1,100>Xt.length&&Xt.push(o)}d=void 0}return d}}function Wn(n){return function(){var o=new es;to(this,o,Ln(n)),wt(o,o.h.end());for(var s=new Uint8Array(o.i),c=o.j,f=c.length,d=0,h=0;h<f;h++){var p=c[h];s.set(p,d),d+=p.length}return o.j=[s],s}}function gt(n){ze.call(this,n)}H(gt,ze);var oo=[gt,1,vs,2,Ue,3,no,4,no];gt.prototype.l=Wn(oo);function Vn(n){ze.call(this,n,-1,ws)}H(Vn,ze),Vn.prototype.addClassification=function(n,o){return Zr(this,1,gt,n,o),this};var ws=[1],io=Nn([Vn,1,ro,oo]);function Et(n){ze.call(this,n)}H(Et,ze);var so=[Et,1,Ue,2,Ue,3,Ue,4,Ue,5,Ue];Et.prototype.l=Wn(so);function ao(n){ze.call(this,n,-1,gs)}H(ao,ze);var gs=[1],co=Nn([ao,1,ro,so]);function on(n){ze.call(this,n)}H(on,ze);var uo=[on,1,Ue,2,Ue,3,Ue,4,Ue,5,Ue,6,ys],Es=Nn(uo);on.prototype.l=Wn(uo);function lo(n,o,s){if(s=n.createShader(s===0?n.VERTEX_SHADER:n.FRAGMENT_SHADER),n.shaderSource(s,o),n.compileShader(s),!n.getShaderParameter(s,n.COMPILE_STATUS))throw Error(`Could not compile WebGL shader.

`+n.getShaderInfoLog(s));return s}function fo(n){return Qt(n,gt,1).map(function(o){var s=Ze(o,1);return{index:s??0,score:We(o,2),label:Ze(o,3)!=null?en(Ze(o,3),""):void 0,displayName:Ze(o,4)!=null?en(Ze(o,4),""):void 0}})}function ho(n){return{x:We(n,1),y:We(n,2),z:We(n,3),visibility:Un(n,4)!=null?We(n,4):void 0}}function po(n){return n.map(function(o){return Qt(co(o),Et,1).map(ho)})}function Yn(n,o){this.i=n,this.h=o,this.m=0}function mo(n,o,s){return _s(n,o),typeof n.h.canvas.transferToImageBitmap=="function"?Promise.resolve(n.h.canvas.transferToImageBitmap()):s?Promise.resolve(n.h.canvas):typeof createImageBitmap=="function"?createImageBitmap(n.h.canvas):(n.j===void 0&&(n.j=document.createElement("canvas")),new Promise(function(c){n.j.height=n.h.canvas.height,n.j.width=n.h.canvas.width,n.j.getContext("2d",{}).drawImage(n.h.canvas,0,0,n.h.canvas.width,n.h.canvas.height),c(n.j)}))}function _s(n,o){var s=n.h;if(n.s===void 0){var c=lo(s,`
  attribute vec2 aVertex;
  attribute vec2 aTex;
  varying vec2 vTex;
  void main(void) {
    gl_Position = vec4(aVertex, 0.0, 1.0);
    vTex = aTex;
  }`,0),f=lo(s,`
  precision mediump float;
  varying vec2 vTex;
  uniform sampler2D sampler0;
  void main(){
    gl_FragColor = texture2D(sampler0, vTex);
  }`,1),d=s.createProgram();if(s.attachShader(d,c),s.attachShader(d,f),s.linkProgram(d),!s.getProgramParameter(d,s.LINK_STATUS))throw Error(`Could not compile WebGL program.

`+s.getProgramInfoLog(d));c=n.s=d,s.useProgram(c),f=s.getUniformLocation(c,"sampler0"),n.l={O:s.getAttribLocation(c,"aVertex"),N:s.getAttribLocation(c,"aTex"),xa:f},n.v=s.createBuffer(),s.bindBuffer(s.ARRAY_BUFFER,n.v),s.enableVertexAttribArray(n.l.O),s.vertexAttribPointer(n.l.O,2,s.FLOAT,!1,0,0),s.bufferData(s.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),s.STATIC_DRAW),s.bindBuffer(s.ARRAY_BUFFER,null),n.u=s.createBuffer(),s.bindBuffer(s.ARRAY_BUFFER,n.u),s.enableVertexAttribArray(n.l.N),s.vertexAttribPointer(n.l.N,2,s.FLOAT,!1,0,0),s.bufferData(s.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),s.STATIC_DRAW),s.bindBuffer(s.ARRAY_BUFFER,null),s.uniform1i(f,0)}c=n.l,s.useProgram(n.s),s.canvas.width=o.width,s.canvas.height=o.height,s.viewport(0,0,o.width,o.height),s.activeTexture(s.TEXTURE0),n.i.bindTexture2d(o.glName),s.enableVertexAttribArray(c.O),s.bindBuffer(s.ARRAY_BUFFER,n.v),s.vertexAttribPointer(c.O,2,s.FLOAT,!1,0,0),s.enableVertexAttribArray(c.N),s.bindBuffer(s.ARRAY_BUFFER,n.u),s.vertexAttribPointer(c.N,2,s.FLOAT,!1,0,0),s.bindFramebuffer(s.DRAW_FRAMEBUFFER?s.DRAW_FRAMEBUFFER:s.FRAMEBUFFER,null),s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT),s.colorMask(!0,!0,!0,!0),s.drawArrays(s.TRIANGLE_FAN,0,4),s.disableVertexAttribArray(c.O),s.disableVertexAttribArray(c.N),s.bindBuffer(s.ARRAY_BUFFER,null),n.i.bindTexture2d(0)}function bs(n){this.h=n}var Ts=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function xs(n,o){return o+n}function yo(n,o){window[n]=o}function Rs(n){var o=document.createElement("script");return o.setAttribute("src",n),o.setAttribute("crossorigin","anonymous"),new Promise(function(s){o.addEventListener("load",function(){s()},!1),o.addEventListener("error",function(){s()},!1),document.body.appendChild(o)})}function ks(){return T(function(n){switch(n.h){case 1:return n.s=2,$(n,WebAssembly.instantiate(Ts),4);case 4:n.h=3,n.s=0;break;case 2:return n.s=0,n.l=null,n.return(!1);case 3:return n.return(!0)}})}function Kn(n){if(this.h=n,this.listeners={},this.l={},this.L={},this.s={},this.v={},this.M=this.u=this.ga=!0,this.I=Promise.resolve(),this.fa="",this.D={},this.locateFile=n&&n.locateFile||xs,typeof window=="object")var o=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else if(typeof location<"u")o=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/";else throw Error("solutions can only be loaded on a web page or in a web worker");if(this.ha=o,n.options){o=m(Object.keys(n.options));for(var s=o.next();!s.done;s=o.next()){s=s.value;var c=n.options[s].default;c!==void 0&&(this.l[s]=typeof c=="function"?c():c)}}}e=Kn.prototype,e.close=function(){return this.j&&this.j.delete(),Promise.resolve()};function Ms(n){var o,s,c,f,d,h,p,v,k,I,W;return T(function(U){switch(U.h){case 1:return n.ga?(o=n.h.files===void 0?[]:typeof n.h.files=="function"?n.h.files(n.l):n.h.files,$(U,ks(),2)):U.return();case 2:if(s=U.i,typeof window=="object")return yo("createMediapipeSolutionsWasm",{locateFile:n.locateFile}),yo("createMediapipeSolutionsPackedAssets",{locateFile:n.locateFile}),h=o.filter(function(j){return j.data!==void 0}),p=o.filter(function(j){return j.data===void 0}),v=Promise.all(h.map(function(j){var V=sn(n,j.url);if(j.path!==void 0){var Q=j.path;V=V.then(function(ce){return n.overrideFile(Q,ce),Promise.resolve(ce)})}return V})),k=Promise.all(p.map(function(j){return j.simd===void 0||j.simd&&s||!j.simd&&!s?Rs(n.locateFile(j.url,n.ha)):Promise.resolve()})).then(function(){var j,V,Q;return T(function(ce){if(ce.h==1)return j=window.createMediapipeSolutionsWasm,V=window.createMediapipeSolutionsPackedAssets,Q=n,$(ce,j(V),2);Q.i=ce.i,ce.h=0})}),I=(function(){return T(function(j){return n.h.graph&&n.h.graph.url?j=$(j,sn(n,n.h.graph.url),0):(j.h=0,j=void 0),j})})(),$(U,Promise.all([k,v,I]),7);if(typeof importScripts!="function")throw Error("solutions can only be loaded on a web page or in a web worker");return c=o.filter(function(j){return j.simd===void 0||j.simd&&s||!j.simd&&!s}).map(function(j){return n.locateFile(j.url,n.ha)}),importScripts.apply(null,w(c)),f=n,$(U,createMediapipeSolutionsWasm(Module),6);case 6:f.i=U.i,n.m=new OffscreenCanvas(1,1),n.i.canvas=n.m,d=n.i.GL.createContext(n.m,{antialias:!1,alpha:!1,ua:typeof WebGL2RenderingContext<"u"?2:1}),n.i.GL.makeContextCurrent(d),U.h=4;break;case 7:if(n.m=document.createElement("canvas"),W=n.m.getContext("webgl2",{}),!W&&(W=n.m.getContext("webgl",{}),!W))return alert("Failed to create WebGL canvas context when passing video frame."),U.return();n.K=W,n.i.canvas=n.m,n.i.createContext(n.m,!0,!0,{});case 4:n.j=new n.i.SolutionWasm,n.ga=!1,U.h=0}})}function Ss(n){var o,s,c,f,d,h,p,v;return T(function(k){if(k.h==1){if(n.h.graph&&n.h.graph.url&&n.fa===n.h.graph.url)return k.return();if(n.u=!0,!n.h.graph||!n.h.graph.url){k.h=2;return}return n.fa=n.h.graph.url,$(k,sn(n,n.h.graph.url),3)}for(k.h!=2&&(o=k.i,n.j.loadGraph(o)),s=m(Object.keys(n.D)),c=s.next();!c.done;c=s.next())f=c.value,n.j.overrideFile(f,n.D[f]);if(n.D={},n.h.listeners)for(d=m(n.h.listeners),h=d.next();!h.done;h=d.next())p=h.value,Cs(n,p);v=n.l,n.l={},n.setOptions(v),k.h=0})}e.reset=function(){var n=this;return T(function(o){n.j&&(n.j.reset(),n.s={},n.v={}),o.h=0})},e.setOptions=function(n,o){var s=this;if(o=o||this.h.options){for(var c=[],f=[],d={},h=m(Object.keys(n)),p=h.next();!p.done;d={X:d.X,Y:d.Y},p=h.next())if(p=p.value,!(p in this.l&&this.l[p]===n[p])){this.l[p]=n[p];var v=o[p];v!==void 0&&(v.onChange&&(d.X=v.onChange,d.Y=n[p],c.push((function(k){return function(){var I;return T(function(W){if(W.h==1)return $(W,k.X(k.Y),2);I=W.i,I===!0&&(s.u=!0),W.h=0})}})(d))),v.graphOptionXref&&(p=Object.assign({},{calculatorName:"",calculatorIndex:0},v.graphOptionXref,{valueNumber:v.type===1?n[p]:0,valueBoolean:v.type===0?n[p]:!1,valueString:v.type===2?n[p]:""}),f.push(p)))}(c.length!==0||f.length!==0)&&(this.u=!0,this.H=(this.H===void 0?[]:this.H).concat(f),this.F=(this.F===void 0?[]:this.F).concat(c))}};function zs(n){var o,s,c,f,d,h,p;return T(function(v){switch(v.h){case 1:if(!n.u)return v.return();if(!n.F){v.h=2;break}o=m(n.F),s=o.next();case 3:if(s.done){v.h=5;break}return c=s.value,$(v,c(),4);case 4:s=o.next(),v.h=3;break;case 5:n.F=void 0;case 2:if(n.H){for(f=new n.i.GraphOptionChangeRequestList,d=m(n.H),h=d.next();!h.done;h=d.next())p=h.value,f.push_back(p);n.j.changeOptions(f),f.delete(),n.H=void 0}n.u=!1,v.h=0}})}e.initialize=function(){var n=this;return T(function(o){return o.h==1?$(o,Ms(n),2):o.h!=3?$(o,Ss(n),3):$(o,zs(n),0)})};function sn(n,o){var s,c;return T(function(f){return o in n.L?f.return(n.L[o]):(s=n.locateFile(o,""),c=fetch(s).then(function(d){return d.arrayBuffer()}),n.L[o]=c,f.return(c))})}e.overrideFile=function(n,o){this.j?this.j.overrideFile(n,o):this.D[n]=o},e.clearOverriddenFiles=function(){this.D={},this.j&&this.j.clearOverriddenFiles()},e.send=function(n,o){var s=this,c,f,d,h,p,v,k,I,W;return T(function(U){switch(U.h){case 1:return s.h.inputs?(c=1e3*(o??performance.now()),$(U,s.I,2)):U.return();case 2:return $(U,s.initialize(),3);case 3:for(f=new s.i.PacketDataList,d=m(Object.keys(n)),h=d.next();!h.done;h=d.next())if(p=h.value,v=s.h.inputs[p]){e:{var j=n[p];switch(v.type){case"video":var V=s.s[v.stream];if(V||(V=new Yn(s.i,s.K),s.s[v.stream]=V),V.m===0&&(V.m=V.i.createTexture()),typeof HTMLVideoElement<"u"&&j instanceof HTMLVideoElement)var Q=j.videoWidth,ce=j.videoHeight;else typeof HTMLImageElement<"u"&&j instanceof HTMLImageElement?(Q=j.naturalWidth,ce=j.naturalHeight):(Q=j.width,ce=j.height);ce={glName:V.m,width:Q,height:ce},Q=V.h,Q.canvas.width=ce.width,Q.canvas.height=ce.height,Q.activeTexture(Q.TEXTURE0),V.i.bindTexture2d(V.m),Q.texImage2D(Q.TEXTURE_2D,0,Q.RGBA,Q.RGBA,Q.UNSIGNED_BYTE,j),V.i.bindTexture2d(0),V=ce;break e;case"detections":for(V=s.s[v.stream],V||(V=new bs(s.i),s.s[v.stream]=V),V.data||(V.data=new V.h.DetectionListData),V.data.reset(j.length),ce=0;ce<j.length;++ce){Q=j[ce];var oe=V.data,_e=oe.setBoundingBox,Oe=ce,He=Q.la,te=new on;if(Ne(te,1,He.ra),Ne(te,2,He.sa),Ne(te,3,He.height),Ne(te,4,He.width),Ne(te,5,He.rotation),Fe(te,6,He.pa),He=te.l(),_e.call(oe,Oe,He),Q.ea)for(oe=0;oe<Q.ea.length;++oe){te=Q.ea[oe],_e=V.data,Oe=_e.addNormalizedLandmark,He=ce,te=Object.assign({},te,{visibility:te.visibility?te.visibility:0});var be=new Et;Ne(be,1,te.x),Ne(be,2,te.y),Ne(be,3,te.z),te.visibility&&Ne(be,4,te.visibility),te=be.l(),Oe.call(_e,He,te)}if(Q.ba)for(oe=0;oe<Q.ba.length;++oe)_e=V.data,Oe=_e.addClassification,He=ce,te=Q.ba[oe],be=new gt,Ne(be,2,te.score),te.index&&Fe(be,1,te.index),te.label&&Fe(be,3,te.label),te.displayName&&Fe(be,4,te.displayName),te=be.l(),Oe.call(_e,He,te)}V=V.data;break e;default:V={}}}switch(k=V,I=v.stream,v.type){case"video":f.pushTexture2d(Object.assign({},k,{stream:I,timestamp:c}));break;case"detections":W=k,W.stream=I,W.timestamp=c,f.pushDetectionList(W);break;default:throw Error("Unknown input config type: '"+v.type+"'")}}return s.j.send(f),$(U,s.I,4);case 4:f.delete(),U.h=0}})};function Hs(n,o,s){var c,f,d,h,p,v,k,I,W,U,j,V,Q,ce;return T(function(oe){switch(oe.h){case 1:if(!s)return oe.return(o);for(c={},f=0,d=m(Object.keys(s)),h=d.next();!h.done;h=d.next())p=h.value,v=s[p],typeof v!="string"&&v.type==="texture"&&o[v.stream]!==void 0&&++f;1<f&&(n.M=!1),k=m(Object.keys(s)),h=k.next();case 2:if(h.done){oe.h=4;break}if(I=h.value,W=s[I],typeof W=="string")return Q=c,ce=I,$(oe,As(n,I,o[W]),14);if(U=o[W.stream],W.type==="detection_list"){if(U){for(var _e=U.getRectList(),Oe=U.getLandmarksList(),He=U.getClassificationsList(),te=[],be=0;be<_e.size();++be){var tt=Es(_e.get(be)),Is=We(tt,1),Ps=We(tt,2),js=We(tt,3),Os=We(tt,4),$s=We(tt,5,0),an=void 0;an=an===void 0?0:an,tt={la:{ra:Is,sa:Ps,height:js,width:Os,rotation:$s,pa:en(Ze(tt,6),an)},ea:Qt(co(Oe.get(be)),Et,1).map(ho),ba:fo(io(He.get(be)))},te.push(tt)}_e=te}else _e=[];c[I]=_e,oe.h=7;break}if(W.type==="proto_list"){if(U){for(_e=Array(U.size()),Oe=0;Oe<U.size();Oe++)_e[Oe]=U.get(Oe);U.delete()}else _e=[];c[I]=_e,oe.h=7;break}if(U===void 0){oe.h=3;break}if(W.type==="float_list"){c[I]=U,oe.h=7;break}if(W.type==="proto"){c[I]=U,oe.h=7;break}if(W.type!=="texture")throw Error("Unknown output config type: '"+W.type+"'");return j=n.v[I],j||(j=new Yn(n.i,n.K),n.v[I]=j),$(oe,mo(j,U,n.M),13);case 13:V=oe.i,c[I]=V;case 7:W.transform&&c[I]&&(c[I]=W.transform(c[I])),oe.h=3;break;case 14:Q[ce]=oe.i;case 3:h=k.next(),oe.h=2;break;case 4:return oe.return(c)}})}function As(n,o,s){var c;return T(function(f){return typeof s=="number"||s instanceof Uint8Array||s instanceof n.i.Uint8BlobList?f.return(s):s instanceof n.i.Texture2dDataOut?(c=n.v[o],c||(c=new Yn(n.i,n.K),n.v[o]=c),f.return(mo(c,s,n.M))):f.return(void 0)})}function Cs(n,o){for(var s=o.name||"$",c=[].concat(w(o.wants)),f=new n.i.StringList,d=m(o.wants),h=d.next();!h.done;h=d.next())f.push_back(h.value);d=n.i.PacketListener.implement({onResults:function(p){for(var v={},k=0;k<o.wants.length;++k)v[c[k]]=p.get(k);var I=n.listeners[s];I&&(n.I=Hs(n,v,o.outs).then(function(W){W=I(W);for(var U=0;U<o.wants.length;++U){var j=v[c[U]];typeof j=="object"&&j.hasOwnProperty&&j.hasOwnProperty("delete")&&j.delete()}W&&(n.I=W)}))}}),n.j.attachMultiListener(f,d),f.delete()}e.onResults=function(n,o){this.listeners[o||"$"]=n},ae("Solution",Kn),ae("OptionType",{BOOL:0,NUMBER:1,ta:2,0:"BOOL",1:"NUMBER",2:"STRING"});function vo(n){return n===void 0&&(n=0),n===1?"hand_landmark_full.tflite":"hand_landmark_lite.tflite"}function wo(n){var o=this;n=n||{},this.h=new Kn({locateFile:n.locateFile,files:function(s){return[{url:"hands_solution_packed_assets_loader.js"},{simd:!1,url:"hands_solution_wasm_bin.js"},{simd:!0,url:"hands_solution_simd_wasm_bin.js"},{data:!0,url:vo(s.modelComplexity)}]},graph:{url:"hands.binarypb"},inputs:{image:{type:"video",stream:"input_frames_gpu"}},listeners:[{wants:["multi_hand_landmarks","multi_hand_world_landmarks","image_transformed","multi_handedness"],outs:{image:"image_transformed",multiHandLandmarks:{type:"proto_list",stream:"multi_hand_landmarks",transform:po},multiHandWorldLandmarks:{type:"proto_list",stream:"multi_hand_world_landmarks",transform:po},multiHandedness:{type:"proto_list",stream:"multi_handedness",transform:function(s){return s.map(function(c){return fo(io(c))[0]})}}}}],options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:typeof window!="object"||window.navigator===void 0?!1:"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},maxNumHands:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculator",fieldName:"int_value"}},modelComplexity:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorModelComplexity",fieldName:"int_value"},onChange:function(s){var c,f,d;return T(function(h){return h.h==1?(c=vo(s),f="third_party/mediapipe/modules/hand_landmark/"+c,$(h,sn(o.h,c),2)):(d=h.i,o.h.overrideFile(f,d),h.return(!0))})}},minDetectionConfidence:{type:1,graphOptionXref:{calculatorType:"TensorsToDetectionsCalculator",calculatorName:"handlandmarktrackinggpu__palmdetectiongpu__TensorsToDetectionsCalculator",fieldName:"min_score_thresh"}},minTrackingConfidence:{type:1,graphOptionXref:{calculatorType:"ThresholdingCalculator",calculatorName:"handlandmarktrackinggpu__handlandmarkgpu__ThresholdingCalculator",fieldName:"threshold"}}}})}e=wo.prototype,e.close=function(){return this.h.close(),Promise.resolve()},e.onResults=function(n){this.h.onResults(n)},e.initialize=function(){var n=this;return T(function(o){return $(o,n.h.initialize(),0)})},e.reset=function(){this.h.reset()},e.send=function(n){var o=this;return T(function(s){return $(s,o.h.send(n),0)})},e.setOptions=function(n){this.h.setOptions(n)},ae("Hands",wo),ae("HAND_CONNECTIONS",[[0,1],[1,2],[2,3],[3,4],[0,5],[5,6],[6,7],[7,8],[5,9],[9,10],[10,11],[11,12],[9,13],[13,14],[14,15],[15,16],[13,17],[0,17],[17,18],[18,19],[19,20]]),ae("VERSION","0.4.1675469240")}).call(Xn)),Xn}var fi=Gs(),Jn={},Eo;function Zs(){return Eo||(Eo=1,(function(){function e(g){var T=0;return function(){return T<g.length?{done:!1,value:g[T++]}:{done:!0}}}var t=typeof Object.defineProperties=="function"?Object.defineProperty:function(g,T,N){return g==Array.prototype||g==Object.prototype||(g[T]=N.value),g};function r(g){g=[typeof globalThis=="object"&&globalThis,g,typeof window=="object"&&window,typeof self=="object"&&self,typeof kt=="object"&&kt];for(var T=0;T<g.length;++T){var N=g[T];if(N&&N.Math==Math)return N}throw Error("Cannot find global object")}var i=r(this);function a(g,T){if(T)e:{var N=i;g=g.split(".");for(var Z=0;Z<g.length-1;Z++){var ee=g[Z];if(!(ee in N))break e;N=N[ee]}g=g[g.length-1],Z=N[g],T=T(Z),T!=Z&&T!=null&&t(N,g,{configurable:!0,writable:!0,value:T})}}a("Symbol",function(g){function T(ae){if(this instanceof T)throw new TypeError("Symbol is not a constructor");return new N(Z+(ae||"")+"_"+ee++,ae)}function N(ae,M){this.g=ae,t(this,"description",{configurable:!0,writable:!0,value:M})}if(g)return g;N.prototype.toString=function(){return this.g};var Z="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",ee=0;return T}),a("Symbol.iterator",function(g){if(g)return g;g=Symbol("Symbol.iterator");for(var T="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),N=0;N<T.length;N++){var Z=i[T[N]];typeof Z=="function"&&typeof Z.prototype[g]!="function"&&t(Z.prototype,g,{configurable:!0,writable:!0,value:function(){return u(e(this))}})}return g});function u(g){return g={next:g},g[Symbol.iterator]=function(){return this},g}function l(g){var T=typeof Symbol<"u"&&Symbol.iterator&&g[Symbol.iterator];return T?T.call(g):{next:e(g)}}function m(){this.i=!1,this.g=null,this.o=void 0,this.j=1,this.m=0,this.h=null}function w(g){if(g.i)throw new TypeError("Generator is already running");g.i=!0}m.prototype.l=function(g){this.o=g};function b(g,T){g.h={F:T,G:!0},g.j=g.m}m.prototype.return=function(g){this.h={return:g},this.j=this.m};function z(g){this.g=new m,this.h=g}function A(g,T){w(g.g);var N=g.g.g;return N?S(g,"return"in N?N.return:function(Z){return{value:Z,done:!0}},T,g.g.return):(g.g.return(T),F(g))}function S(g,T,N,Z){try{var ee=T.call(g.g.g,N);if(!(ee instanceof Object))throw new TypeError("Iterator result "+ee+" is not an object");if(!ee.done)return g.g.i=!1,ee;var ae=ee.value}catch(M){return g.g.g=null,b(g.g,M),F(g)}return g.g.g=null,Z.call(g.g,ae),F(g)}function F(g){for(;g.g.j;)try{var T=g.h(g.g);if(T)return g.g.i=!1,{value:T.value,done:!1}}catch(N){g.g.o=void 0,b(g.g,N)}if(g.g.i=!1,g.g.h){if(T=g.g.h,g.g.h=null,T.G)throw T.F;return{value:T.return,done:!0}}return{value:void 0,done:!0}}function E(g){this.next=function(T){return w(g.g),g.g.g?T=S(g,g.g.g.next,T,g.g.l):(g.g.l(T),T=F(g)),T},this.throw=function(T){return w(g.g),g.g.g?T=S(g,g.g.g.throw,T,g.g.l):(b(g.g,T),T=F(g)),T},this.return=function(T){return A(g,T)},this[Symbol.iterator]=function(){return this}}function C(g){function T(Z){return g.next(Z)}function N(Z){return g.throw(Z)}return new Promise(function(Z,ee){function ae(M){M.done?Z(M.value):Promise.resolve(M.value).then(T,N).then(ae,ee)}ae(g.next())})}a("Promise",function(g){function T(M){this.h=0,this.i=void 0,this.g=[],this.o=!1;var L=this.j();try{M(L.resolve,L.reject)}catch(q){L.reject(q)}}function N(){this.g=null}function Z(M){return M instanceof T?M:new T(function(L){L(M)})}if(g)return g;N.prototype.h=function(M){if(this.g==null){this.g=[];var L=this;this.i(function(){L.l()})}this.g.push(M)};var ee=i.setTimeout;N.prototype.i=function(M){ee(M,0)},N.prototype.l=function(){for(;this.g&&this.g.length;){var M=this.g;this.g=[];for(var L=0;L<M.length;++L){var q=M[L];M[L]=null;try{q()}catch(ne){this.j(ne)}}}this.g=null},N.prototype.j=function(M){this.i(function(){throw M})},T.prototype.j=function(){function M(ne){return function(ve){q||(q=!0,ne.call(L,ve))}}var L=this,q=!1;return{resolve:M(this.A),reject:M(this.l)}},T.prototype.A=function(M){if(M===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(M instanceof T)this.C(M);else{e:switch(typeof M){case"object":var L=M!=null;break e;case"function":L=!0;break e;default:L=!1}L?this.v(M):this.m(M)}},T.prototype.v=function(M){var L=void 0;try{L=M.then}catch(q){this.l(q);return}typeof L=="function"?this.D(L,M):this.m(M)},T.prototype.l=function(M){this.u(2,M)},T.prototype.m=function(M){this.u(1,M)},T.prototype.u=function(M,L){if(this.h!=0)throw Error("Cannot settle("+M+", "+L+"): Promise already settled in state"+this.h);this.h=M,this.i=L,this.h===2&&this.B(),this.H()},T.prototype.B=function(){var M=this;ee(function(){if(M.I()){var L=i.console;typeof L<"u"&&L.error(M.i)}},1)},T.prototype.I=function(){if(this.o)return!1;var M=i.CustomEvent,L=i.Event,q=i.dispatchEvent;return typeof q>"u"?!0:(typeof M=="function"?M=new M("unhandledrejection",{cancelable:!0}):typeof L=="function"?M=new L("unhandledrejection",{cancelable:!0}):(M=i.document.createEvent("CustomEvent"),M.initCustomEvent("unhandledrejection",!1,!0,M)),M.promise=this,M.reason=this.i,q(M))},T.prototype.H=function(){if(this.g!=null){for(var M=0;M<this.g.length;++M)ae.h(this.g[M]);this.g=null}};var ae=new N;return T.prototype.C=function(M){var L=this.j();M.s(L.resolve,L.reject)},T.prototype.D=function(M,L){var q=this.j();try{M.call(L,q.resolve,q.reject)}catch(ne){q.reject(ne)}},T.prototype.then=function(M,L){function q(ge,Ee){return typeof ge=="function"?function(Pe){try{ne(ge(Pe))}catch(je){ve(je)}}:Ee}var ne,ve,Ge=new T(function(ge,Ee){ne=ge,ve=Ee});return this.s(q(M,ne),q(L,ve)),Ge},T.prototype.catch=function(M){return this.then(void 0,M)},T.prototype.s=function(M,L){function q(){switch(ne.h){case 1:M(ne.i);break;case 2:L(ne.i);break;default:throw Error("Unexpected state: "+ne.h)}}var ne=this;this.g==null?ae.h(q):this.g.push(q),this.o=!0},T.resolve=Z,T.reject=function(M){return new T(function(L,q){q(M)})},T.race=function(M){return new T(function(L,q){for(var ne=l(M),ve=ne.next();!ve.done;ve=ne.next())Z(ve.value).s(L,q)})},T.all=function(M){var L=l(M),q=L.next();return q.done?Z([]):new T(function(ne,ve){function Ge(Pe){return function(je){ge[Pe]=je,Ee--,Ee==0&&ne(ge)}}var ge=[],Ee=0;do ge.push(void 0),Ee++,Z(q.value).s(Ge(ge.length-1),ve),q=L.next();while(!q.done)})},T});var H=typeof Object.assign=="function"?Object.assign:function(g,T){for(var N=1;N<arguments.length;N++){var Z=arguments[N];if(Z)for(var ee in Z)Object.prototype.hasOwnProperty.call(Z,ee)&&(g[ee]=Z[ee])}return g};a("Object.assign",function(g){return g||H});var O=this||self,K={facingMode:"user",width:640,height:480};function Y(g,T){this.video=g,this.i=0,this.h=Object.assign(Object.assign({},K),T)}Y.prototype.stop=function(){var g=this,T,N,Z,ee;return C(new E(new z(function(ae){if(g.g){for(T=g.g.getTracks(),N=l(T),Z=N.next();!Z.done;Z=N.next())ee=Z.value,ee.stop();g.g=void 0}ae.j=0})))},Y.prototype.start=function(){var g=this,T;return C(new E(new z(function(N){return navigator.mediaDevices&&navigator.mediaDevices.getUserMedia||alert("No navigator.mediaDevices.getUserMedia exists."),T=g.h,N.return(navigator.mediaDevices.getUserMedia({video:{facingMode:T.facingMode,width:T.width,height:T.height}}).then(function(Z){re(g,Z)}).catch(function(Z){var ee="Failed to acquire camera feed: "+Z;throw console.error(ee),alert(ee),Z}))})))};function $(g){window.requestAnimationFrame(function(){De(g)})}function re(g,T){g.g=T,g.video.srcObject=T,g.video.onloadedmetadata=function(){g.video.play(),$(g)}}function De(g){var T=null;g.video.paused||g.video.currentTime===g.i||(g.i=g.video.currentTime,T=g.h.onFrame()),T?T.then(function(){$(g)}):$(g)}var xe=["Camera"],fe=O;xe[0]in fe||typeof fe.execScript>"u"||fe.execScript("var "+xe[0]);for(var Re;xe.length&&(Re=xe.shift());)xe.length||Y===void 0?fe[Re]&&fe[Re]!==Object.prototype[Re]?fe=fe[Re]:fe=fe[Re]={}:fe[Re]=Y}).call(Jn)),Jn}var Us=Zs(),qn={},_o;function Ds(){return _o||(_o=1,(function(){function e(E){var C=0;return function(){return C<E.length?{done:!1,value:E[C++]}:{done:!0}}}var t=typeof Object.defineProperties=="function"?Object.defineProperty:function(E,C,H){return E==Array.prototype||E==Object.prototype||(E[C]=H.value),E};function r(E){E=[typeof globalThis=="object"&&globalThis,E,typeof window=="object"&&window,typeof self=="object"&&self,typeof kt=="object"&&kt];for(var C=0;C<E.length;++C){var H=E[C];if(H&&H.Math==Math)return H}throw Error("Cannot find global object")}var i=r(this);function a(E,C){if(C)e:{var H=i;E=E.split(".");for(var O=0;O<E.length-1;O++){var K=E[O];if(!(K in H))break e;H=H[K]}E=E[E.length-1],O=H[E],C=C(O),C!=O&&C!=null&&t(H,E,{configurable:!0,writable:!0,value:C})}}function u(E){var C=typeof Symbol<"u"&&Symbol.iterator&&E[Symbol.iterator];return C?C.call(E):{next:e(E)}}var l=typeof Object.assign=="function"?Object.assign:function(E,C){for(var H=1;H<arguments.length;H++){var O=arguments[H];if(O)for(var K in O)Object.prototype.hasOwnProperty.call(O,K)&&(E[K]=O[K])}return E};a("Object.assign",function(E){return E||l}),a("Array.prototype.fill",function(E){return E||function(C,H,O){var K=this.length||0;for(0>H&&(H=Math.max(0,K+H)),(O==null||O>K)&&(O=K),O=Number(O),0>O&&(O=Math.max(0,K+O)),H=Number(H||0);H<O;H++)this[H]=C;return this}});function m(E){return E||Array.prototype.fill}a("Int8Array.prototype.fill",m),a("Uint8Array.prototype.fill",m),a("Uint8ClampedArray.prototype.fill",m),a("Int16Array.prototype.fill",m),a("Uint16Array.prototype.fill",m),a("Int32Array.prototype.fill",m),a("Uint32Array.prototype.fill",m),a("Float32Array.prototype.fill",m),a("Float64Array.prototype.fill",m);var w=this||self;function b(E,C){E=E.split(".");var H=w;E[0]in H||typeof H.execScript>"u"||H.execScript("var "+E[0]);for(var O;E.length&&(O=E.shift());)E.length||C===void 0?H[O]&&H[O]!==Object.prototype[O]?H=H[O]:H=H[O]={}:H[O]=C}var z={color:"white",lineWidth:4,radius:6,visibilityMin:.5};function A(E){return E=E||{},Object.assign({},z,{fillColor:E.color},E)}function S(E,C){return E instanceof Function?E(C):E}function F(E,C,H){return Math.max(Math.min(C,H),Math.min(Math.max(C,H),E))}b("clamp",F),b("drawLandmarks",function(E,C,H){if(C){H=A(H),E.save();var O=E.canvas,K=0;C=u(C);for(var Y=C.next();!Y.done;Y=C.next())if(Y=Y.value,Y!==void 0&&(Y.visibility===void 0||Y.visibility>H.visibilityMin)){E.fillStyle=S(H.fillColor,{index:K,from:Y}),E.strokeStyle=S(H.color,{index:K,from:Y}),E.lineWidth=S(H.lineWidth,{index:K,from:Y});var $=new Path2D;$.arc(Y.x*O.width,Y.y*O.height,S(H.radius,{index:K,from:Y}),0,2*Math.PI),E.fill($),E.stroke($),++K}E.restore()}}),b("drawConnectors",function(E,C,H,O){if(C&&H){O=A(O),E.save();var K=E.canvas,Y=0;H=u(H);for(var $=H.next();!$.done;$=H.next()){var re=$.value;E.beginPath(),$=C[re[0]],re=C[re[1]],$&&re&&($.visibility===void 0||$.visibility>O.visibilityMin)&&(re.visibility===void 0||re.visibility>O.visibilityMin)&&(E.strokeStyle=S(O.color,{index:Y,from:$,to:re}),E.lineWidth=S(O.lineWidth,{index:Y,from:$,to:re}),E.moveTo($.x*K.width,$.y*K.height),E.lineTo(re.x*K.width,re.y*K.height)),++Y,E.stroke()}E.restore()}}),b("drawRectangle",function(E,C,H){H=A(H),E.save();var O=E.canvas;E.beginPath(),E.lineWidth=S(H.lineWidth,{}),E.strokeStyle=S(H.color,{}),E.fillStyle=S(H.fillColor,{}),E.translate(C.xCenter*O.width,C.yCenter*O.height),E.rotate(C.rotation*Math.PI/180),E.rect(-C.width/2*O.width,-C.height/2*O.height,C.width*O.width,C.height*O.height),E.translate(-C.xCenter*O.width,-C.yCenter*O.height),E.stroke(),E.fill(),E.restore()}),b("lerp",function(E,C,H,O,K){return F(O*(1-(E-C)/(H-C))+K*(1-(H-E)/(H-C)),O,K)})}).call(qn)),qn}var bo=Ds();let cn,To,ft={x:0,y:0},vn=!1,Bt=0;const Ve={speed:1,invertX:!0,invertY:!1,neutralY:.5,deadzone:.1};function Ls(e,t){const r=t.getContext("2d");cn=new fi.Hands({locateFile:i=>`https://cdn.jsdelivr.net/npm/@mediapipe/hands/${i}`}),cn.setOptions({maxNumHands:2,modelComplexity:1,minDetectionConfidence:.5,minTrackingConfidence:.5}),cn.onResults(i=>{Fs(i,t,r)}),To=new Us.Camera(e,{onFrame:async()=>{await cn.send({image:e})},width:320,height:240}),To.start(),Ys()}function Fs(e,t,r){if(r.save(),r.clearRect(0,0,t.width,t.height),r.drawImage(e.image,0,0,t.width,t.height),e.multiHandLandmarks){for(const i of e.multiHandLandmarks)bo.drawConnectors(r,i,fi.HAND_CONNECTIONS,{color:"#00FF00",lineWidth:5}),bo.drawLandmarks(r,i,{color:"#FF0000",lineWidth:2});if(e.multiHandLandmarks.length>0){const i=e.multiHandLandmarks[0];Ns(i)}else ft.x=0,ft.y=0,hi(0,0);e.multiHandLandmarks.length===2?Ws(e.multiHandLandmarks[0],e.multiHandLandmarks[1]):(vn=!1,ar(!1))}r.restore()}function Ns(e){const t=e[8];let r=(t.x-.5)*2,i=(t.y-Ve.neutralY)*2;Ve.invertX&&(r=-r),Ve.invertY&&(i=-i),Math.abs(r)<Ve.deadzone&&(r=0),Math.abs(i)<Ve.deadzone&&(i=0),r=Math.max(-1,Math.min(1,r)),i=Math.max(-1,Math.min(1,i)),ft.x=r*Ve.speed,ft.y=i*Ve.speed,hi(r,i),Vs(ft.x,ft.y)}function Ws(e,t){const r=e[0],i=t[0];Math.sqrt(Math.pow(r.x-i.x,2)+Math.pow(r.y-i.y,2))<.15?Bt++:Bt=Math.max(0,Bt-1),Bt>10?vn=!0:Bt===0&&(vn=!1)}function hi(e,t){const r=document.getElementById("joystick-dot");if(r){const a=50+e*35,u=50+t*35;r.style.left=`${a}px`,r.style.top=`${u}px`}}function Vs(e,t){const r=document.getElementById("stat-speed"),i=document.getElementById("stat-angle");if(r){const a=Math.sqrt(e*e+t*t).toFixed(2);r.textContent=a}if(i){let a=Math.atan2(t,e)*(180/Math.PI);i.textContent=a.toFixed(0)}}function ar(e){const t=document.getElementById("handshake-notification");t&&(t.style.display=e?"block":"none")}function Ys(){const e=document.getElementById("invert-x"),t=document.getElementById("invert-y"),r=document.getElementById("offset-y");e&&e.addEventListener("change",i=>Ve.invertX=i.target.checked),t&&t.addEventListener("change",i=>Ve.invertY=i.target.checked),r&&r.addEventListener("input",i=>Ve.neutralY=parseFloat(i.target.value))}function Ks(){return ft}function Xs(){return vn}const rt={INVALID_API_KEY:"INVALID_API_KEY",INVALID_BASE_URL:"INVALID_BASE_URL",WEB_RTC_ERROR:"WEB_RTC_ERROR",INVALID_INPUT:"INVALID_INPUT",MODEL_NOT_FOUND:"MODEL_NOT_FOUND",QUEUE_SUBMIT_ERROR:"QUEUE_SUBMIT_ERROR",QUEUE_STATUS_ERROR:"QUEUE_STATUS_ERROR",QUEUE_RESULT_ERROR:"QUEUE_RESULT_ERROR"};function qe(e,t,r,i){return{code:e,message:t,data:r,cause:i}}function Js(){return qe(rt.INVALID_API_KEY,"Missing API key. Pass `apiKey` to createDecartClient() or set the DECART_API_KEY environment variable.")}function qs(e){return qe(rt.INVALID_BASE_URL,`Invalid base URL${e?`: ${e}`:""}`)}function Qs(e){return qe(rt.WEB_RTC_ERROR,"WebRTC error",{cause:e})}function Zt(e){return qe(rt.INVALID_INPUT,e)}function Qn(e){return qe(rt.MODEL_NOT_FOUND,`Model ${e} not found`)}function xo(e,t){return qe(rt.QUEUE_SUBMIT_ERROR,e,{status:t})}function ea(e,t){return qe(rt.QUEUE_STATUS_ERROR,e,{status:t})}function ta(e,t){return qe(rt.QUEUE_RESULT_ERROR,e,{status:t})}const na="0.0.22";function ra(e=globalThis){return e.window?"runtime/browser":e.navigator?.userAgent?`runtime/${e.navigator.userAgent.toLowerCase()}`:e.process?.versions?.node?`runtime/node.js/${e.process.version.substring(0)}`:e.EdgeRuntime?"runtime/vercel-edge":"runtime/unknown"}function di(e,t=globalThis){return[`decart-js-sdk/${na}`,"lang/js",...e?[e]:[],ra(t)].join(" ")}async function pi(e){if(e instanceof Blob||e instanceof File)return e;if(e instanceof ReadableStream)return new Response(e).blob();if(typeof e=="string"||e instanceof URL){const t=typeof e=="string"?e:e.toString();if(!t.startsWith("http://")&&!t.startsWith("https://"))throw Zt("URL must start with http:// or https://");const r=await fetch(t);if(!r.ok)throw Zt(`Failed to fetch file from URL: ${r.statusText}`);return r.blob()}throw Zt("Invalid file input type")}function bn(e,t){return{"X-API-KEY":e,"User-Agent":di(t)}}function mi(e){const t=new FormData;for(const[r,i]of Object.entries(e))i!=null&&(i instanceof Blob?t.append(r,i):typeof i=="object"&&i!==null?t.append(r,JSON.stringify(i)):t.append(r,String(i)));return t}async function oa({baseUrl:e,apiKey:t,model:r,inputs:i,signal:a,integration:u}){const l=mi(i),m=`${e}${r.urlPath}`,w=await fetch(m,{method:"POST",headers:bn(t,u),body:l,signal:a});if(!w.ok){const b=await w.text().catch(()=>"Unknown error");throw qe("PROCESSING_ERROR",`Processing failed: ${w.status} - ${b}`)}return w.blob()}const ia=e=>{const{apiKey:t,baseUrl:r,integration:i}=e;return async u=>{const{model:l,signal:m,...w}=u,b=l.inputSchema.safeParse(w);if(!b.success)throw Zt(`Invalid inputs for ${l.name}: ${b.error.message}`);const z={};for(const[A,S]of Object.entries(b.data))A==="data"||A==="start"||A==="end"?z[A]=await pi(S):z[A]=S;return await oa({baseUrl:r,apiKey:t,model:l,inputs:z,signal:m,integration:i})}},Ro={interval:1500,initialDelay:500};function ko(e){return new Promise(t=>setTimeout(t,e))}async function sa({checkStatus:e,getContent:t,onStatusChange:r,signal:i}){for(await ko(Ro.initialDelay);;){if(i?.aborted)throw new Error("Polling aborted");const a=await e();if(r&&r(a),a.status==="completed")return{status:"completed",data:await t()};if(a.status==="failed")return{status:"failed",error:"Job failed"};await ko(Ro.interval)}}async function aa({baseUrl:e,apiKey:t,model:r,inputs:i,signal:a,integration:u}){const l=mi(i);if(!r.queueUrlPath)throw xo(`Model ${r.name} does not support queue processing`,400);const m=`${e}${r.queueUrlPath}`,w=await fetch(m,{method:"POST",headers:bn(t,u),body:l,signal:a});if(!w.ok){const b=await w.text().catch(()=>"Unknown error");throw xo(`Failed to submit job: ${w.status} - ${b}`,w.status)}return w.json()}async function Mo({baseUrl:e,apiKey:t,jobId:r,signal:i,integration:a}){const u=`${e}/v1/jobs/${r}`,l=await fetch(u,{method:"GET",headers:bn(t,a),signal:i});if(!l.ok){const m=await l.text().catch(()=>"Unknown error");throw ea(`Failed to get job status: ${l.status} - ${m}`,l.status)}return l.json()}async function So({baseUrl:e,apiKey:t,jobId:r,signal:i,integration:a}){const u=`${e}/v1/jobs/${r}/content`,l=await fetch(u,{method:"GET",headers:bn(t,a),signal:i});if(!l.ok){const m=await l.text().catch(()=>"Unknown error");throw ta(`Failed to get job content: ${l.status} - ${m}`,l.status)}return l.blob()}const ca=e=>{const{apiKey:t,baseUrl:r,integration:i}=e,a=async w=>{const{model:b,signal:z,...A}=w,S=b.inputSchema.safeParse(A);if(!S.success)throw Zt(`Invalid inputs for ${b.name}: ${S.error.message}`);const F={};for(const[E,C]of Object.entries(S.data))E==="data"||E==="start"||E==="end"?F[E]=await pi(C):F[E]=C;return aa({baseUrl:r,apiKey:t,model:b,inputs:F,signal:z,integration:i})};return{submit:a,status:async w=>Mo({baseUrl:r,apiKey:t,jobId:w,integration:i}),result:async w=>So({baseUrl:r,apiKey:t,jobId:w,integration:i}),submitAndPoll:async w=>{const{onStatusChange:b,signal:z,...A}=w,S=await a(A);return b&&b(S),sa({checkStatus:()=>Mo({baseUrl:r,apiKey:t,jobId:S.job_id,signal:z,integration:i}),getContent:()=>So({baseUrl:r,apiKey:t,jobId:S.job_id,signal:z,integration:i}),onStatusChange:b,signal:z})}}};function x(e,t,r){function i(m,w){if(m._zod||Object.defineProperty(m,"_zod",{value:{def:w,constr:l,traits:new Set},enumerable:!1}),m._zod.traits.has(e))return;m._zod.traits.add(e),t(m,w);const b=l.prototype,z=Object.keys(b);for(let A=0;A<z.length;A++){const S=z[A];S in m||(m[S]=b[S].bind(m))}}const a=r?.Parent??Object;class u extends a{}Object.defineProperty(u,"name",{value:e});function l(m){var w;const b=r?.Parent?new u:this;i(b,m),(w=b._zod).deferred??(w.deferred=[]);for(const z of b._zod.deferred)z();return b}return Object.defineProperty(l,"init",{value:i}),Object.defineProperty(l,Symbol.hasInstance,{value:m=>r?.Parent&&m instanceof r.Parent?!0:m?._zod?.traits?.has(e)}),Object.defineProperty(l,"name",{value:e}),l}class xt extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class yi extends Error{constructor(t){super(`Encountered unidirectional transform during encode: ${t}`),this.name="ZodEncodeError"}}const vi={};function dt(e){return vi}function ua(e){const t=Object.values(e).filter(i=>typeof i=="number");return Object.entries(e).filter(([i,a])=>t.indexOf(+i)===-1).map(([i,a])=>a)}function cr(e,t){return typeof t=="bigint"?t.toString():t}function mr(e){return{get value(){{const t=e();return Object.defineProperty(this,"value",{value:t}),t}}}}function yr(e){return e==null}function vr(e){const t=e.startsWith("^")?1:0,r=e.endsWith("$")?e.length-1:e.length;return e.slice(t,r)}function la(e,t){const r=(e.toString().split(".")[1]||"").length,i=t.toString();let a=(i.split(".")[1]||"").length;if(a===0&&/\d?e-\d?/.test(i)){const w=i.match(/\d?e-(\d?)/);w?.[1]&&(a=Number.parseInt(w[1]))}const u=r>a?r:a,l=Number.parseInt(e.toFixed(u).replace(".","")),m=Number.parseInt(t.toFixed(u).replace(".",""));return l%m/10**u}const zo=Symbol("evaluating");function ie(e,t,r){let i;Object.defineProperty(e,t,{get(){if(i!==zo)return i===void 0&&(i=zo,i=r()),i},set(a){Object.defineProperty(e,t,{value:a})},configurable:!0})}function mt(e,t,r){Object.defineProperty(e,t,{value:r,writable:!0,enumerable:!0,configurable:!0})}function yt(...e){const t={};for(const r of e){const i=Object.getOwnPropertyDescriptors(r);Object.assign(t,i)}return Object.defineProperties({},t)}function Ho(e){return JSON.stringify(e)}function fa(e){return e.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,"")}const wi="captureStackTrace"in Error?Error.captureStackTrace:(...e)=>{};function wn(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}const ha=mr(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{const e=Function;return new e(""),!0}catch{return!1}});function Wt(e){if(wn(e)===!1)return!1;const t=e.constructor;if(t===void 0||typeof t!="function")return!0;const r=t.prototype;return!(wn(r)===!1||Object.prototype.hasOwnProperty.call(r,"isPrototypeOf")===!1)}function gi(e){return Wt(e)?{...e}:Array.isArray(e)?[...e]:e}const da=new Set(["string","number","symbol"]);function Mt(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function ot(e,t,r){const i=new e._zod.constr(t??e._zod.def);return(!t||r?.parent)&&(i._zod.parent=e),i}function G(e){const t=e;if(!t)return{};if(typeof t=="string")return{error:()=>t};if(t?.message!==void 0){if(t?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");t.error=t.message}return delete t.message,typeof t.error=="string"?{...t,error:()=>t.error}:t}function pa(e){return Object.keys(e).filter(t=>e[t]._zod.optin==="optional"&&e[t]._zod.optout==="optional")}const ma={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function ya(e,t){const r=e._zod.def,i=yt(e._zod.def,{get shape(){const a={};for(const u in t){if(!(u in r.shape))throw new Error(`Unrecognized key: "${u}"`);t[u]&&(a[u]=r.shape[u])}return mt(this,"shape",a),a},checks:[]});return ot(e,i)}function va(e,t){const r=e._zod.def,i=yt(e._zod.def,{get shape(){const a={...e._zod.def.shape};for(const u in t){if(!(u in r.shape))throw new Error(`Unrecognized key: "${u}"`);t[u]&&delete a[u]}return mt(this,"shape",a),a},checks:[]});return ot(e,i)}function wa(e,t){if(!Wt(t))throw new Error("Invalid input to extend: expected a plain object");const r=e._zod.def.checks;if(r&&r.length>0)throw new Error("Object schemas containing refinements cannot be extended. Use `.safeExtend()` instead.");const a=yt(e._zod.def,{get shape(){const u={...e._zod.def.shape,...t};return mt(this,"shape",u),u},checks:[]});return ot(e,a)}function ga(e,t){if(!Wt(t))throw new Error("Invalid input to safeExtend: expected a plain object");const r={...e._zod.def,get shape(){const i={...e._zod.def.shape,...t};return mt(this,"shape",i),i},checks:e._zod.def.checks};return ot(e,r)}function Ea(e,t){const r=yt(e._zod.def,{get shape(){const i={...e._zod.def.shape,...t._zod.def.shape};return mt(this,"shape",i),i},get catchall(){return t._zod.def.catchall},checks:[]});return ot(e,r)}function _a(e,t,r){const i=yt(t._zod.def,{get shape(){const a=t._zod.def.shape,u={...a};if(r)for(const l in r){if(!(l in a))throw new Error(`Unrecognized key: "${l}"`);r[l]&&(u[l]=e?new e({type:"optional",innerType:a[l]}):a[l])}else for(const l in a)u[l]=e?new e({type:"optional",innerType:a[l]}):a[l];return mt(this,"shape",u),u},checks:[]});return ot(t,i)}function ba(e,t,r){const i=yt(t._zod.def,{get shape(){const a=t._zod.def.shape,u={...a};if(r)for(const l in r){if(!(l in u))throw new Error(`Unrecognized key: "${l}"`);r[l]&&(u[l]=new e({type:"nonoptional",innerType:a[l]}))}else for(const l in a)u[l]=new e({type:"nonoptional",innerType:a[l]});return mt(this,"shape",u),u},checks:[]});return ot(t,i)}function bt(e,t=0){if(e.aborted===!0)return!0;for(let r=t;r<e.issues.length;r++)if(e.issues[r]?.continue!==!0)return!0;return!1}function wr(e,t){return t.map(r=>{var i;return(i=r).path??(i.path=[]),r.path.unshift(e),r})}function un(e){return typeof e=="string"?e:e?.message}function pt(e,t,r){const i={...e,path:e.path??[]};if(!e.message){const a=un(e.inst?._zod.def?.error?.(e))??un(t?.error?.(e))??un(r.customError?.(e))??un(r.localeError?.(e))??"Invalid input";i.message=a}return delete i.inst,delete i.continue,t?.reportInput||delete i.input,i}function gr(e){return Array.isArray(e)?"array":typeof e=="string"?"string":"unknown"}function Vt(...e){const[t,r,i]=e;return typeof t=="string"?{message:t,code:"custom",input:r,inst:i}:{...t}}const Ei=(e,t)=>{e.name="$ZodError",Object.defineProperty(e,"_zod",{value:e._zod,enumerable:!1}),Object.defineProperty(e,"issues",{value:t,enumerable:!1}),e.message=JSON.stringify(t,cr,2),Object.defineProperty(e,"toString",{value:()=>e.message,enumerable:!1})},_i=x("$ZodError",Ei),Tn=x("$ZodError",Ei,{Parent:Error});function Ta(e,t=r=>r.message){const r={},i=[];for(const a of e.issues)a.path.length>0?(r[a.path[0]]=r[a.path[0]]||[],r[a.path[0]].push(t(a))):i.push(t(a));return{formErrors:i,fieldErrors:r}}function xa(e,t=r=>r.message){const r={_errors:[]},i=a=>{for(const u of a.issues)if(u.code==="invalid_union"&&u.errors.length)u.errors.map(l=>i({issues:l}));else if(u.code==="invalid_key")i({issues:u.issues});else if(u.code==="invalid_element")i({issues:u.issues});else if(u.path.length===0)r._errors.push(t(u));else{let l=r,m=0;for(;m<u.path.length;){const w=u.path[m];m===u.path.length-1?(l[w]=l[w]||{_errors:[]},l[w]._errors.push(t(u))):l[w]=l[w]||{_errors:[]},l=l[w],m++}}};return i(e),r}const xn=e=>(t,r,i,a)=>{const u=i?Object.assign(i,{async:!1}):{async:!1},l=t._zod.run({value:r,issues:[]},u);if(l instanceof Promise)throw new xt;if(l.issues.length){const m=new(a?.Err??e)(l.issues.map(w=>pt(w,u,dt())));throw wi(m,a?.callee),m}return l.value},Ao=xn(Tn),Rn=e=>async(t,r,i,a)=>{const u=i?Object.assign(i,{async:!0}):{async:!0};let l=t._zod.run({value:r,issues:[]},u);if(l instanceof Promise&&(l=await l),l.issues.length){const m=new(a?.Err??e)(l.issues.map(w=>pt(w,u,dt())));throw wi(m,a?.callee),m}return l.value},Co=Rn(Tn),kn=e=>(t,r,i)=>{const a=i?{...i,async:!1}:{async:!1},u=t._zod.run({value:r,issues:[]},a);if(u instanceof Promise)throw new xt;return u.issues.length?{success:!1,error:new(e??_i)(u.issues.map(l=>pt(l,a,dt())))}:{success:!0,data:u.value}},Ra=kn(Tn),Mn=e=>async(t,r,i)=>{const a=i?Object.assign(i,{async:!0}):{async:!0};let u=t._zod.run({value:r,issues:[]},a);return u instanceof Promise&&(u=await u),u.issues.length?{success:!1,error:new e(u.issues.map(l=>pt(l,a,dt())))}:{success:!0,data:u.value}},ka=Mn(Tn),Ma=e=>(t,r,i)=>{const a=i?Object.assign(i,{direction:"backward"}):{direction:"backward"};return xn(e)(t,r,a)},Sa=e=>(t,r,i)=>xn(e)(t,r,i),za=e=>async(t,r,i)=>{const a=i?Object.assign(i,{direction:"backward"}):{direction:"backward"};return Rn(e)(t,r,a)},Ha=e=>async(t,r,i)=>Rn(e)(t,r,i),Aa=e=>(t,r,i)=>{const a=i?Object.assign(i,{direction:"backward"}):{direction:"backward"};return kn(e)(t,r,a)},Ca=e=>(t,r,i)=>kn(e)(t,r,i),Ia=e=>async(t,r,i)=>{const a=i?Object.assign(i,{direction:"backward"}):{direction:"backward"};return Mn(e)(t,r,a)},Pa=e=>async(t,r,i)=>Mn(e)(t,r,i),ja=/^[cC][^\s-]{8,}$/,Oa=/^[0-9a-z]+$/,$a=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,Ba=/^[0-9a-vA-V]{20}$/,Ga=/^[A-Za-z0-9]{27}$/,Za=/^[a-zA-Z0-9_-]{21}$/,Ua=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,Da=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,Io=e=>e?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${e}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,La=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,Fa="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function Na(){return new RegExp(Fa,"u")}const Wa=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Va=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:))$/,Ya=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,Ka=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Xa=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,bi=/^[A-Za-z0-9_-]*$/,Ja=/^\+(?:[0-9]){6,14}[0-9]$/,Ti="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",qa=new RegExp(`^${Ti}$`);function xi(e){const t="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof e.precision=="number"?e.precision===-1?`${t}`:e.precision===0?`${t}:[0-5]\\d`:`${t}:[0-5]\\d\\.\\d{${e.precision}}`:`${t}(?::[0-5]\\d(?:\\.\\d+)?)?`}function Qa(e){return new RegExp(`^${xi(e)}$`)}function ec(e){const t=xi({precision:e.precision}),r=["Z"];e.local&&r.push(""),e.offset&&r.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");const i=`${t}(?:${r.join("|")})`;return new RegExp(`^${Ti}T(?:${i})$`)}const tc=e=>{const t=e?`[\\s\\S]{${e?.minimum??0},${e?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${t}$`)},nc=/^-?\d+$/,rc=/^-?\d+(?:\.\d+)?/,oc=/^(?:true|false)$/i,ic=/^[^A-Z]*$/,sc=/^[^a-z]*$/,Ie=x("$ZodCheck",(e,t)=>{var r;e._zod??(e._zod={}),e._zod.def=t,(r=e._zod).onattach??(r.onattach=[])}),Ri={number:"number",bigint:"bigint",object:"date"},ki=x("$ZodCheckLessThan",(e,t)=>{Ie.init(e,t);const r=Ri[typeof t.value];e._zod.onattach.push(i=>{const a=i._zod.bag,u=(t.inclusive?a.maximum:a.exclusiveMaximum)??Number.POSITIVE_INFINITY;t.value<u&&(t.inclusive?a.maximum=t.value:a.exclusiveMaximum=t.value)}),e._zod.check=i=>{(t.inclusive?i.value<=t.value:i.value<t.value)||i.issues.push({origin:r,code:"too_big",maximum:t.value,input:i.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),Mi=x("$ZodCheckGreaterThan",(e,t)=>{Ie.init(e,t);const r=Ri[typeof t.value];e._zod.onattach.push(i=>{const a=i._zod.bag,u=(t.inclusive?a.minimum:a.exclusiveMinimum)??Number.NEGATIVE_INFINITY;t.value>u&&(t.inclusive?a.minimum=t.value:a.exclusiveMinimum=t.value)}),e._zod.check=i=>{(t.inclusive?i.value>=t.value:i.value>t.value)||i.issues.push({origin:r,code:"too_small",minimum:t.value,input:i.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),ac=x("$ZodCheckMultipleOf",(e,t)=>{Ie.init(e,t),e._zod.onattach.push(r=>{var i;(i=r._zod.bag).multipleOf??(i.multipleOf=t.value)}),e._zod.check=r=>{if(typeof r.value!=typeof t.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof r.value=="bigint"?r.value%t.value===BigInt(0):la(r.value,t.value)===0)||r.issues.push({origin:typeof r.value,code:"not_multiple_of",divisor:t.value,input:r.value,inst:e,continue:!t.abort})}}),cc=x("$ZodCheckNumberFormat",(e,t)=>{Ie.init(e,t),t.format=t.format||"float64";const r=t.format?.includes("int"),i=r?"int":"number",[a,u]=ma[t.format];e._zod.onattach.push(l=>{const m=l._zod.bag;m.format=t.format,m.minimum=a,m.maximum=u,r&&(m.pattern=nc)}),e._zod.check=l=>{const m=l.value;if(r){if(!Number.isInteger(m)){l.issues.push({expected:i,format:t.format,code:"invalid_type",continue:!1,input:m,inst:e});return}if(!Number.isSafeInteger(m)){m>0?l.issues.push({input:m,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:i,continue:!t.abort}):l.issues.push({input:m,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:i,continue:!t.abort});return}}m<a&&l.issues.push({origin:"number",input:m,code:"too_small",minimum:a,inclusive:!0,inst:e,continue:!t.abort}),m>u&&l.issues.push({origin:"number",input:m,code:"too_big",maximum:u,inst:e})}}),uc=x("$ZodCheckMaxLength",(e,t)=>{var r;Ie.init(e,t),(r=e._zod.def).when??(r.when=i=>{const a=i.value;return!yr(a)&&a.length!==void 0}),e._zod.onattach.push(i=>{const a=i._zod.bag.maximum??Number.POSITIVE_INFINITY;t.maximum<a&&(i._zod.bag.maximum=t.maximum)}),e._zod.check=i=>{const a=i.value;if(a.length<=t.maximum)return;const l=gr(a);i.issues.push({origin:l,code:"too_big",maximum:t.maximum,inclusive:!0,input:a,inst:e,continue:!t.abort})}}),lc=x("$ZodCheckMinLength",(e,t)=>{var r;Ie.init(e,t),(r=e._zod.def).when??(r.when=i=>{const a=i.value;return!yr(a)&&a.length!==void 0}),e._zod.onattach.push(i=>{const a=i._zod.bag.minimum??Number.NEGATIVE_INFINITY;t.minimum>a&&(i._zod.bag.minimum=t.minimum)}),e._zod.check=i=>{const a=i.value;if(a.length>=t.minimum)return;const l=gr(a);i.issues.push({origin:l,code:"too_small",minimum:t.minimum,inclusive:!0,input:a,inst:e,continue:!t.abort})}}),fc=x("$ZodCheckLengthEquals",(e,t)=>{var r;Ie.init(e,t),(r=e._zod.def).when??(r.when=i=>{const a=i.value;return!yr(a)&&a.length!==void 0}),e._zod.onattach.push(i=>{const a=i._zod.bag;a.minimum=t.length,a.maximum=t.length,a.length=t.length}),e._zod.check=i=>{const a=i.value,u=a.length;if(u===t.length)return;const l=gr(a),m=u>t.length;i.issues.push({origin:l,...m?{code:"too_big",maximum:t.length}:{code:"too_small",minimum:t.length},inclusive:!0,exact:!0,input:i.value,inst:e,continue:!t.abort})}}),Sn=x("$ZodCheckStringFormat",(e,t)=>{var r,i;Ie.init(e,t),e._zod.onattach.push(a=>{const u=a._zod.bag;u.format=t.format,t.pattern&&(u.patterns??(u.patterns=new Set),u.patterns.add(t.pattern))}),t.pattern?(r=e._zod).check??(r.check=a=>{t.pattern.lastIndex=0,!t.pattern.test(a.value)&&a.issues.push({origin:"string",code:"invalid_format",format:t.format,input:a.value,...t.pattern?{pattern:t.pattern.toString()}:{},inst:e,continue:!t.abort})}):(i=e._zod).check??(i.check=()=>{})}),hc=x("$ZodCheckRegex",(e,t)=>{Sn.init(e,t),e._zod.check=r=>{t.pattern.lastIndex=0,!t.pattern.test(r.value)&&r.issues.push({origin:"string",code:"invalid_format",format:"regex",input:r.value,pattern:t.pattern.toString(),inst:e,continue:!t.abort})}}),dc=x("$ZodCheckLowerCase",(e,t)=>{t.pattern??(t.pattern=ic),Sn.init(e,t)}),pc=x("$ZodCheckUpperCase",(e,t)=>{t.pattern??(t.pattern=sc),Sn.init(e,t)}),mc=x("$ZodCheckIncludes",(e,t)=>{Ie.init(e,t);const r=Mt(t.includes),i=new RegExp(typeof t.position=="number"?`^.{${t.position}}${r}`:r);t.pattern=i,e._zod.onattach.push(a=>{const u=a._zod.bag;u.patterns??(u.patterns=new Set),u.patterns.add(i)}),e._zod.check=a=>{a.value.includes(t.includes,t.position)||a.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:t.includes,input:a.value,inst:e,continue:!t.abort})}}),yc=x("$ZodCheckStartsWith",(e,t)=>{Ie.init(e,t);const r=new RegExp(`^${Mt(t.prefix)}.*`);t.pattern??(t.pattern=r),e._zod.onattach.push(i=>{const a=i._zod.bag;a.patterns??(a.patterns=new Set),a.patterns.add(r)}),e._zod.check=i=>{i.value.startsWith(t.prefix)||i.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:t.prefix,input:i.value,inst:e,continue:!t.abort})}}),vc=x("$ZodCheckEndsWith",(e,t)=>{Ie.init(e,t);const r=new RegExp(`.*${Mt(t.suffix)}$`);t.pattern??(t.pattern=r),e._zod.onattach.push(i=>{const a=i._zod.bag;a.patterns??(a.patterns=new Set),a.patterns.add(r)}),e._zod.check=i=>{i.value.endsWith(t.suffix)||i.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:t.suffix,input:i.value,inst:e,continue:!t.abort})}}),wc=x("$ZodCheckOverwrite",(e,t)=>{Ie.init(e,t),e._zod.check=r=>{r.value=t.tx(r.value)}});class gc{constructor(t=[]){this.content=[],this.indent=0,this&&(this.args=t)}indented(t){this.indent+=1,t(this),this.indent-=1}write(t){if(typeof t=="function"){t(this,{execution:"sync"}),t(this,{execution:"async"});return}const i=t.split(`
`).filter(l=>l),a=Math.min(...i.map(l=>l.length-l.trimStart().length)),u=i.map(l=>l.slice(a)).map(l=>" ".repeat(this.indent*2)+l);for(const l of u)this.content.push(l)}compile(){const t=Function,r=this?.args,a=[...(this?.content??[""]).map(u=>`  ${u}`)];return new t(...r,a.join(`
`))}}const Ec={major:4,minor:1,patch:13},se=x("$ZodType",(e,t)=>{var r;e??(e={}),e._zod.def=t,e._zod.bag=e._zod.bag||{},e._zod.version=Ec;const i=[...e._zod.def.checks??[]];e._zod.traits.has("$ZodCheck")&&i.unshift(e);for(const a of i)for(const u of a._zod.onattach)u(e);if(i.length===0)(r=e._zod).deferred??(r.deferred=[]),e._zod.deferred?.push(()=>{e._zod.run=e._zod.parse});else{const a=(l,m,w)=>{let b=bt(l),z;for(const A of m){if(A._zod.def.when){if(!A._zod.def.when(l))continue}else if(b)continue;const S=l.issues.length,F=A._zod.check(l);if(F instanceof Promise&&w?.async===!1)throw new xt;if(z||F instanceof Promise)z=(z??Promise.resolve()).then(async()=>{await F,l.issues.length!==S&&(b||(b=bt(l,S)))});else{if(l.issues.length===S)continue;b||(b=bt(l,S))}}return z?z.then(()=>l):l},u=(l,m,w)=>{if(bt(l))return l.aborted=!0,l;const b=a(m,i,w);if(b instanceof Promise){if(w.async===!1)throw new xt;return b.then(z=>e._zod.parse(z,w))}return e._zod.parse(b,w)};e._zod.run=(l,m)=>{if(m.skipChecks)return e._zod.parse(l,m);if(m.direction==="backward"){const b=e._zod.parse({value:l.value,issues:[]},{...m,skipChecks:!0});return b instanceof Promise?b.then(z=>u(z,l,m)):u(b,l,m)}const w=e._zod.parse(l,m);if(w instanceof Promise){if(m.async===!1)throw new xt;return w.then(b=>a(b,i,m))}return a(w,i,m)}}e["~standard"]={validate:a=>{try{const u=Ra(e,a);return u.success?{value:u.data}:{issues:u.error?.issues}}catch{return ka(e,a).then(l=>l.success?{value:l.data}:{issues:l.error?.issues})}},vendor:"zod",version:1}}),Er=x("$ZodString",(e,t)=>{se.init(e,t),e._zod.pattern=[...e?._zod.bag?.patterns??[]].pop()??tc(e._zod.bag),e._zod.parse=(r,i)=>{if(t.coerce)try{r.value=String(r.value)}catch{}return typeof r.value=="string"||r.issues.push({expected:"string",code:"invalid_type",input:r.value,inst:e}),r}}),ue=x("$ZodStringFormat",(e,t)=>{Sn.init(e,t),Er.init(e,t)}),_c=x("$ZodGUID",(e,t)=>{t.pattern??(t.pattern=Da),ue.init(e,t)}),bc=x("$ZodUUID",(e,t)=>{if(t.version){const i={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[t.version];if(i===void 0)throw new Error(`Invalid UUID version: "${t.version}"`);t.pattern??(t.pattern=Io(i))}else t.pattern??(t.pattern=Io());ue.init(e,t)}),Tc=x("$ZodEmail",(e,t)=>{t.pattern??(t.pattern=La),ue.init(e,t)}),xc=x("$ZodURL",(e,t)=>{ue.init(e,t),e._zod.check=r=>{try{const i=r.value.trim(),a=new URL(i);t.hostname&&(t.hostname.lastIndex=0,t.hostname.test(a.hostname)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:t.hostname.source,input:r.value,inst:e,continue:!t.abort})),t.protocol&&(t.protocol.lastIndex=0,t.protocol.test(a.protocol.endsWith(":")?a.protocol.slice(0,-1):a.protocol)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:t.protocol.source,input:r.value,inst:e,continue:!t.abort})),t.normalize?r.value=a.href:r.value=i;return}catch{r.issues.push({code:"invalid_format",format:"url",input:r.value,inst:e,continue:!t.abort})}}}),Rc=x("$ZodEmoji",(e,t)=>{t.pattern??(t.pattern=Na()),ue.init(e,t)}),kc=x("$ZodNanoID",(e,t)=>{t.pattern??(t.pattern=Za),ue.init(e,t)}),Mc=x("$ZodCUID",(e,t)=>{t.pattern??(t.pattern=ja),ue.init(e,t)}),Sc=x("$ZodCUID2",(e,t)=>{t.pattern??(t.pattern=Oa),ue.init(e,t)}),zc=x("$ZodULID",(e,t)=>{t.pattern??(t.pattern=$a),ue.init(e,t)}),Hc=x("$ZodXID",(e,t)=>{t.pattern??(t.pattern=Ba),ue.init(e,t)}),Ac=x("$ZodKSUID",(e,t)=>{t.pattern??(t.pattern=Ga),ue.init(e,t)}),Cc=x("$ZodISODateTime",(e,t)=>{t.pattern??(t.pattern=ec(t)),ue.init(e,t)}),Ic=x("$ZodISODate",(e,t)=>{t.pattern??(t.pattern=qa),ue.init(e,t)}),Pc=x("$ZodISOTime",(e,t)=>{t.pattern??(t.pattern=Qa(t)),ue.init(e,t)}),jc=x("$ZodISODuration",(e,t)=>{t.pattern??(t.pattern=Ua),ue.init(e,t)}),Oc=x("$ZodIPv4",(e,t)=>{t.pattern??(t.pattern=Wa),ue.init(e,t),e._zod.bag.format="ipv4"}),$c=x("$ZodIPv6",(e,t)=>{t.pattern??(t.pattern=Va),ue.init(e,t),e._zod.bag.format="ipv6",e._zod.check=r=>{try{new URL(`http://[${r.value}]`)}catch{r.issues.push({code:"invalid_format",format:"ipv6",input:r.value,inst:e,continue:!t.abort})}}}),Bc=x("$ZodCIDRv4",(e,t)=>{t.pattern??(t.pattern=Ya),ue.init(e,t)}),Gc=x("$ZodCIDRv6",(e,t)=>{t.pattern??(t.pattern=Ka),ue.init(e,t),e._zod.check=r=>{const i=r.value.split("/");try{if(i.length!==2)throw new Error;const[a,u]=i;if(!u)throw new Error;const l=Number(u);if(`${l}`!==u)throw new Error;if(l<0||l>128)throw new Error;new URL(`http://[${a}]`)}catch{r.issues.push({code:"invalid_format",format:"cidrv6",input:r.value,inst:e,continue:!t.abort})}}});function Si(e){if(e==="")return!0;if(e.length%4!==0)return!1;try{return atob(e),!0}catch{return!1}}const Zc=x("$ZodBase64",(e,t)=>{t.pattern??(t.pattern=Xa),ue.init(e,t),e._zod.bag.contentEncoding="base64",e._zod.check=r=>{Si(r.value)||r.issues.push({code:"invalid_format",format:"base64",input:r.value,inst:e,continue:!t.abort})}});function Uc(e){if(!bi.test(e))return!1;const t=e.replace(/[-_]/g,i=>i==="-"?"+":"/"),r=t.padEnd(Math.ceil(t.length/4)*4,"=");return Si(r)}const Dc=x("$ZodBase64URL",(e,t)=>{t.pattern??(t.pattern=bi),ue.init(e,t),e._zod.bag.contentEncoding="base64url",e._zod.check=r=>{Uc(r.value)||r.issues.push({code:"invalid_format",format:"base64url",input:r.value,inst:e,continue:!t.abort})}}),Lc=x("$ZodE164",(e,t)=>{t.pattern??(t.pattern=Ja),ue.init(e,t)});function Fc(e,t=null){try{const r=e.split(".");if(r.length!==3)return!1;const[i]=r;if(!i)return!1;const a=JSON.parse(atob(i));return!("typ"in a&&a?.typ!=="JWT"||!a.alg||t&&(!("alg"in a)||a.alg!==t))}catch{return!1}}const Nc=x("$ZodJWT",(e,t)=>{ue.init(e,t),e._zod.check=r=>{Fc(r.value,t.alg)||r.issues.push({code:"invalid_format",format:"jwt",input:r.value,inst:e,continue:!t.abort})}}),zi=x("$ZodNumber",(e,t)=>{se.init(e,t),e._zod.pattern=e._zod.bag.pattern??rc,e._zod.parse=(r,i)=>{if(t.coerce)try{r.value=Number(r.value)}catch{}const a=r.value;if(typeof a=="number"&&!Number.isNaN(a)&&Number.isFinite(a))return r;const u=typeof a=="number"?Number.isNaN(a)?"NaN":Number.isFinite(a)?void 0:"Infinity":void 0;return r.issues.push({expected:"number",code:"invalid_type",input:a,inst:e,...u?{received:u}:{}}),r}}),Wc=x("$ZodNumberFormat",(e,t)=>{cc.init(e,t),zi.init(e,t)}),Vc=x("$ZodBoolean",(e,t)=>{se.init(e,t),e._zod.pattern=oc,e._zod.parse=(r,i)=>{if(t.coerce)try{r.value=!!r.value}catch{}const a=r.value;return typeof a=="boolean"||r.issues.push({expected:"boolean",code:"invalid_type",input:a,inst:e}),r}}),Yc=x("$ZodAny",(e,t)=>{se.init(e,t),e._zod.parse=r=>r}),Kc=x("$ZodUnknown",(e,t)=>{se.init(e,t),e._zod.parse=r=>r}),Xc=x("$ZodNever",(e,t)=>{se.init(e,t),e._zod.parse=(r,i)=>(r.issues.push({expected:"never",code:"invalid_type",input:r.value,inst:e}),r)});function Po(e,t,r){e.issues.length&&t.issues.push(...wr(r,e.issues)),t.value[r]=e.value}const Jc=x("$ZodArray",(e,t)=>{se.init(e,t),e._zod.parse=(r,i)=>{const a=r.value;if(!Array.isArray(a))return r.issues.push({expected:"array",code:"invalid_type",input:a,inst:e}),r;r.value=Array(a.length);const u=[];for(let l=0;l<a.length;l++){const m=a[l],w=t.element._zod.run({value:m,issues:[]},i);w instanceof Promise?u.push(w.then(b=>Po(b,r,l))):Po(w,r,l)}return u.length?Promise.all(u).then(()=>r):r}});function gn(e,t,r,i){e.issues.length&&t.issues.push(...wr(r,e.issues)),e.value===void 0?r in i&&(t.value[r]=void 0):t.value[r]=e.value}function Hi(e){const t=Object.keys(e.shape);for(const i of t)if(!e.shape?.[i]?._zod?.traits?.has("$ZodType"))throw new Error(`Invalid element at key "${i}": expected a Zod schema`);const r=pa(e.shape);return{...e,keys:t,keySet:new Set(t),numKeys:t.length,optionalKeys:new Set(r)}}function Ai(e,t,r,i,a,u){const l=[],m=a.keySet,w=a.catchall._zod,b=w.def.type;for(const z in t){if(m.has(z))continue;if(b==="never"){l.push(z);continue}const A=w.run({value:t[z],issues:[]},i);A instanceof Promise?e.push(A.then(S=>gn(S,r,z,t))):gn(A,r,z,t)}return l.length&&r.issues.push({code:"unrecognized_keys",keys:l,input:t,inst:u}),e.length?Promise.all(e).then(()=>r):r}const qc=x("$ZodObject",(e,t)=>{if(se.init(e,t),!Object.getOwnPropertyDescriptor(t,"shape")?.get){const m=t.shape;Object.defineProperty(t,"shape",{get:()=>{const w={...m};return Object.defineProperty(t,"shape",{value:w}),w}})}const i=mr(()=>Hi(t));ie(e._zod,"propValues",()=>{const m=t.shape,w={};for(const b in m){const z=m[b]._zod;if(z.values){w[b]??(w[b]=new Set);for(const A of z.values)w[b].add(A)}}return w});const a=wn,u=t.catchall;let l;e._zod.parse=(m,w)=>{l??(l=i.value);const b=m.value;if(!a(b))return m.issues.push({expected:"object",code:"invalid_type",input:b,inst:e}),m;m.value={};const z=[],A=l.shape;for(const S of l.keys){const E=A[S]._zod.run({value:b[S],issues:[]},w);E instanceof Promise?z.push(E.then(C=>gn(C,m,S,b))):gn(E,m,S,b)}return u?Ai(z,b,m,w,i.value,e):z.length?Promise.all(z).then(()=>m):m}}),Qc=x("$ZodObjectJIT",(e,t)=>{qc.init(e,t);const r=e._zod.parse,i=mr(()=>Hi(t)),a=S=>{const F=new gc(["shape","payload","ctx"]),E=i.value,C=Y=>{const $=Ho(Y);return`shape[${$}]._zod.run({ value: input[${$}], issues: [] }, ctx)`};F.write("const input = payload.value;");const H=Object.create(null);let O=0;for(const Y of E.keys)H[Y]=`key_${O++}`;F.write("const newResult = {};");for(const Y of E.keys){const $=H[Y],re=Ho(Y);F.write(`const ${$} = ${C(Y)};`),F.write(`
        if (${$}.issues.length) {
          payload.issues = payload.issues.concat(${$}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${re}, ...iss.path] : [${re}]
          })));
        }
        
        
        if (${$}.value === undefined) {
          if (${re} in input) {
            newResult[${re}] = undefined;
          }
        } else {
          newResult[${re}] = ${$}.value;
        }
        
      `)}F.write("payload.value = newResult;"),F.write("return payload;");const K=F.compile();return(Y,$)=>K(S,Y,$)};let u;const l=wn,m=!vi.jitless,b=m&&ha.value,z=t.catchall;let A;e._zod.parse=(S,F)=>{A??(A=i.value);const E=S.value;return l(E)?m&&b&&F?.async===!1&&F.jitless!==!0?(u||(u=a(t.shape)),S=u(S,F),z?Ai([],E,S,F,A,e):S):r(S,F):(S.issues.push({expected:"object",code:"invalid_type",input:E,inst:e}),S)}});function jo(e,t,r,i){for(const u of e)if(u.issues.length===0)return t.value=u.value,t;const a=e.filter(u=>!bt(u));return a.length===1?(t.value=a[0].value,a[0]):(t.issues.push({code:"invalid_union",input:t.value,inst:r,errors:e.map(u=>u.issues.map(l=>pt(l,i,dt())))}),t)}const eu=x("$ZodUnion",(e,t)=>{se.init(e,t),ie(e._zod,"optin",()=>t.options.some(a=>a._zod.optin==="optional")?"optional":void 0),ie(e._zod,"optout",()=>t.options.some(a=>a._zod.optout==="optional")?"optional":void 0),ie(e._zod,"values",()=>{if(t.options.every(a=>a._zod.values))return new Set(t.options.flatMap(a=>Array.from(a._zod.values)))}),ie(e._zod,"pattern",()=>{if(t.options.every(a=>a._zod.pattern)){const a=t.options.map(u=>u._zod.pattern);return new RegExp(`^(${a.map(u=>vr(u.source)).join("|")})$`)}});const r=t.options.length===1,i=t.options[0]._zod.run;e._zod.parse=(a,u)=>{if(r)return i(a,u);let l=!1;const m=[];for(const w of t.options){const b=w._zod.run({value:a.value,issues:[]},u);if(b instanceof Promise)m.push(b),l=!0;else{if(b.issues.length===0)return b;m.push(b)}}return l?Promise.all(m).then(w=>jo(w,a,e,u)):jo(m,a,e,u)}}),tu=x("$ZodIntersection",(e,t)=>{se.init(e,t),e._zod.parse=(r,i)=>{const a=r.value,u=t.left._zod.run({value:a,issues:[]},i),l=t.right._zod.run({value:a,issues:[]},i);return u instanceof Promise||l instanceof Promise?Promise.all([u,l]).then(([w,b])=>Oo(r,w,b)):Oo(r,u,l)}});function ur(e,t){if(e===t)return{valid:!0,data:e};if(e instanceof Date&&t instanceof Date&&+e==+t)return{valid:!0,data:e};if(Wt(e)&&Wt(t)){const r=Object.keys(t),i=Object.keys(e).filter(u=>r.indexOf(u)!==-1),a={...e,...t};for(const u of i){const l=ur(e[u],t[u]);if(!l.valid)return{valid:!1,mergeErrorPath:[u,...l.mergeErrorPath]};a[u]=l.data}return{valid:!0,data:a}}if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return{valid:!1,mergeErrorPath:[]};const r=[];for(let i=0;i<e.length;i++){const a=e[i],u=t[i],l=ur(a,u);if(!l.valid)return{valid:!1,mergeErrorPath:[i,...l.mergeErrorPath]};r.push(l.data)}return{valid:!0,data:r}}return{valid:!1,mergeErrorPath:[]}}function Oo(e,t,r){if(t.issues.length&&e.issues.push(...t.issues),r.issues.length&&e.issues.push(...r.issues),bt(e))return e;const i=ur(t.value,r.value);if(!i.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(i.mergeErrorPath)}`);return e.value=i.data,e}const Ci=x("$ZodTuple",(e,t)=>{se.init(e,t);const r=t.items;e._zod.parse=(i,a)=>{const u=i.value;if(!Array.isArray(u))return i.issues.push({input:u,inst:e,expected:"tuple",code:"invalid_type"}),i;i.value=[];const l=[],m=[...r].reverse().findIndex(z=>z._zod.optin!=="optional"),w=m===-1?0:r.length-m;if(!t.rest){const z=u.length>r.length,A=u.length<w-1;if(z||A)return i.issues.push({...z?{code:"too_big",maximum:r.length}:{code:"too_small",minimum:r.length},input:u,inst:e,origin:"array"}),i}let b=-1;for(const z of r){if(b++,b>=u.length&&b>=w)continue;const A=z._zod.run({value:u[b],issues:[]},a);A instanceof Promise?l.push(A.then(S=>ln(S,i,b))):ln(A,i,b)}if(t.rest){const z=u.slice(r.length);for(const A of z){b++;const S=t.rest._zod.run({value:A,issues:[]},a);S instanceof Promise?l.push(S.then(F=>ln(F,i,b))):ln(S,i,b)}}return l.length?Promise.all(l).then(()=>i):i}});function ln(e,t,r){e.issues.length&&t.issues.push(...wr(r,e.issues)),t.value[r]=e.value}const nu=x("$ZodEnum",(e,t)=>{se.init(e,t);const r=ua(t.entries),i=new Set(r);e._zod.values=i,e._zod.pattern=new RegExp(`^(${r.filter(a=>da.has(typeof a)).map(a=>typeof a=="string"?Mt(a):a.toString()).join("|")})$`),e._zod.parse=(a,u)=>{const l=a.value;return i.has(l)||a.issues.push({code:"invalid_value",values:r,input:l,inst:e}),a}}),ru=x("$ZodLiteral",(e,t)=>{if(se.init(e,t),t.values.length===0)throw new Error("Cannot create literal schema with no valid values");const r=new Set(t.values);e._zod.values=r,e._zod.pattern=new RegExp(`^(${t.values.map(i=>typeof i=="string"?Mt(i):i?Mt(i.toString()):String(i)).join("|")})$`),e._zod.parse=(i,a)=>{const u=i.value;return r.has(u)||i.issues.push({code:"invalid_value",values:t.values,input:u,inst:e}),i}}),ou=x("$ZodTransform",(e,t)=>{se.init(e,t),e._zod.parse=(r,i)=>{if(i.direction==="backward")throw new yi(e.constructor.name);const a=t.transform(r.value,r);if(i.async)return(a instanceof Promise?a:Promise.resolve(a)).then(l=>(r.value=l,r));if(a instanceof Promise)throw new xt;return r.value=a,r}});function $o(e,t){return e.issues.length&&t===void 0?{issues:[],value:void 0}:e}const iu=x("$ZodOptional",(e,t)=>{se.init(e,t),e._zod.optin="optional",e._zod.optout="optional",ie(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,void 0]):void 0),ie(e._zod,"pattern",()=>{const r=t.innerType._zod.pattern;return r?new RegExp(`^(${vr(r.source)})?$`):void 0}),e._zod.parse=(r,i)=>{if(t.innerType._zod.optin==="optional"){const a=t.innerType._zod.run(r,i);return a instanceof Promise?a.then(u=>$o(u,r.value)):$o(a,r.value)}return r.value===void 0?r:t.innerType._zod.run(r,i)}}),su=x("$ZodNullable",(e,t)=>{se.init(e,t),ie(e._zod,"optin",()=>t.innerType._zod.optin),ie(e._zod,"optout",()=>t.innerType._zod.optout),ie(e._zod,"pattern",()=>{const r=t.innerType._zod.pattern;return r?new RegExp(`^(${vr(r.source)}|null)$`):void 0}),ie(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,null]):void 0),e._zod.parse=(r,i)=>r.value===null?r:t.innerType._zod.run(r,i)}),au=x("$ZodDefault",(e,t)=>{se.init(e,t),e._zod.optin="optional",ie(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(r,i)=>{if(i.direction==="backward")return t.innerType._zod.run(r,i);if(r.value===void 0)return r.value=t.defaultValue,r;const a=t.innerType._zod.run(r,i);return a instanceof Promise?a.then(u=>Bo(u,t)):Bo(a,t)}});function Bo(e,t){return e.value===void 0&&(e.value=t.defaultValue),e}const cu=x("$ZodPrefault",(e,t)=>{se.init(e,t),e._zod.optin="optional",ie(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(r,i)=>(i.direction==="backward"||r.value===void 0&&(r.value=t.defaultValue),t.innerType._zod.run(r,i))}),uu=x("$ZodNonOptional",(e,t)=>{se.init(e,t),ie(e._zod,"values",()=>{const r=t.innerType._zod.values;return r?new Set([...r].filter(i=>i!==void 0)):void 0}),e._zod.parse=(r,i)=>{const a=t.innerType._zod.run(r,i);return a instanceof Promise?a.then(u=>Go(u,e)):Go(a,e)}});function Go(e,t){return!e.issues.length&&e.value===void 0&&e.issues.push({code:"invalid_type",expected:"nonoptional",input:e.value,inst:t}),e}const lu=x("$ZodCatch",(e,t)=>{se.init(e,t),ie(e._zod,"optin",()=>t.innerType._zod.optin),ie(e._zod,"optout",()=>t.innerType._zod.optout),ie(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(r,i)=>{if(i.direction==="backward")return t.innerType._zod.run(r,i);const a=t.innerType._zod.run(r,i);return a instanceof Promise?a.then(u=>(r.value=u.value,u.issues.length&&(r.value=t.catchValue({...r,error:{issues:u.issues.map(l=>pt(l,i,dt()))},input:r.value}),r.issues=[]),r)):(r.value=a.value,a.issues.length&&(r.value=t.catchValue({...r,error:{issues:a.issues.map(u=>pt(u,i,dt()))},input:r.value}),r.issues=[]),r)}}),fu=x("$ZodPipe",(e,t)=>{se.init(e,t),ie(e._zod,"values",()=>t.in._zod.values),ie(e._zod,"optin",()=>t.in._zod.optin),ie(e._zod,"optout",()=>t.out._zod.optout),ie(e._zod,"propValues",()=>t.in._zod.propValues),e._zod.parse=(r,i)=>{if(i.direction==="backward"){const u=t.out._zod.run(r,i);return u instanceof Promise?u.then(l=>fn(l,t.in,i)):fn(u,t.in,i)}const a=t.in._zod.run(r,i);return a instanceof Promise?a.then(u=>fn(u,t.out,i)):fn(a,t.out,i)}});function fn(e,t,r){return e.issues.length?(e.aborted=!0,e):t._zod.run({value:e.value,issues:e.issues},r)}const hu=x("$ZodReadonly",(e,t)=>{se.init(e,t),ie(e._zod,"propValues",()=>t.innerType._zod.propValues),ie(e._zod,"values",()=>t.innerType._zod.values),ie(e._zod,"optin",()=>t.innerType?._zod?.optin),ie(e._zod,"optout",()=>t.innerType?._zod?.optout),e._zod.parse=(r,i)=>{if(i.direction==="backward")return t.innerType._zod.run(r,i);const a=t.innerType._zod.run(r,i);return a instanceof Promise?a.then(Zo):Zo(a)}});function Zo(e){return e.value=Object.freeze(e.value),e}const du=x("$ZodFunction",(e,t)=>(se.init(e,t),e._def=t,e._zod.def=t,e.implement=r=>{if(typeof r!="function")throw new Error("implement() must be called with a function");return function(...i){const a=e._def.input?Ao(e._def.input,i):i,u=Reflect.apply(r,this,a);return e._def.output?Ao(e._def.output,u):u}},e.implementAsync=r=>{if(typeof r!="function")throw new Error("implementAsync() must be called with a function");return async function(...i){const a=e._def.input?await Co(e._def.input,i):i,u=await Reflect.apply(r,this,a);return e._def.output?await Co(e._def.output,u):u}},e._zod.parse=(r,i)=>typeof r.value!="function"?(r.issues.push({code:"invalid_type",expected:"function",input:r.value,inst:e}),r):(e._def.output&&e._def.output._zod.def.type==="promise"?r.value=e.implementAsync(r.value):r.value=e.implement(r.value),r),e.input=(...r)=>{const i=e.constructor;return Array.isArray(r[0])?new i({type:"function",input:new Ci({type:"tuple",items:r[0],rest:r[1]}),output:e._def.output}):new i({type:"function",input:r[0],output:e._def.output})},e.output=r=>{const i=e.constructor;return new i({type:"function",input:e._def.input,output:r})},e)),pu=x("$ZodCustom",(e,t)=>{Ie.init(e,t),se.init(e,t),e._zod.parse=(r,i)=>r,e._zod.check=r=>{const i=r.value,a=t.fn(i);if(a instanceof Promise)return a.then(u=>Uo(u,r,i,e));Uo(a,r,i,e)}});function Uo(e,t,r,i){if(!e){const a={code:"custom",input:r,inst:i,path:[...i._zod.def.path??[]],continue:!i._zod.def.abort};i._zod.def.params&&(a.params=i._zod.def.params),t.issues.push(Vt(a))}}var Do;class mu{constructor(){this._map=new WeakMap,this._idmap=new Map}add(t,...r){const i=r[0];if(this._map.set(t,i),i&&typeof i=="object"&&"id"in i){if(this._idmap.has(i.id))throw new Error(`ID ${i.id} already exists in the registry`);this._idmap.set(i.id,t)}return this}clear(){return this._map=new WeakMap,this._idmap=new Map,this}remove(t){const r=this._map.get(t);return r&&typeof r=="object"&&"id"in r&&this._idmap.delete(r.id),this._map.delete(t),this}get(t){const r=t._zod.parent;if(r){const i={...this.get(r)??{}};delete i.id;const a={...i,...this._map.get(t)};return Object.keys(a).length?a:void 0}return this._map.get(t)}has(t){return this._map.has(t)}}function yu(){return new mu}(Do=globalThis).__zod_globalRegistry??(Do.__zod_globalRegistry=yu());const hn=globalThis.__zod_globalRegistry;function vu(e,t){return new e({type:"string",...G(t)})}function wu(e,t){return new e({type:"string",format:"email",check:"string_format",abort:!1,...G(t)})}function Lo(e,t){return new e({type:"string",format:"guid",check:"string_format",abort:!1,...G(t)})}function gu(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,...G(t)})}function Eu(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...G(t)})}function _u(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...G(t)})}function bu(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...G(t)})}function Ii(e,t){return new e({type:"string",format:"url",check:"string_format",abort:!1,...G(t)})}function Tu(e,t){return new e({type:"string",format:"emoji",check:"string_format",abort:!1,...G(t)})}function xu(e,t){return new e({type:"string",format:"nanoid",check:"string_format",abort:!1,...G(t)})}function Ru(e,t){return new e({type:"string",format:"cuid",check:"string_format",abort:!1,...G(t)})}function ku(e,t){return new e({type:"string",format:"cuid2",check:"string_format",abort:!1,...G(t)})}function Mu(e,t){return new e({type:"string",format:"ulid",check:"string_format",abort:!1,...G(t)})}function Su(e,t){return new e({type:"string",format:"xid",check:"string_format",abort:!1,...G(t)})}function zu(e,t){return new e({type:"string",format:"ksuid",check:"string_format",abort:!1,...G(t)})}function Hu(e,t){return new e({type:"string",format:"ipv4",check:"string_format",abort:!1,...G(t)})}function Au(e,t){return new e({type:"string",format:"ipv6",check:"string_format",abort:!1,...G(t)})}function Cu(e,t){return new e({type:"string",format:"cidrv4",check:"string_format",abort:!1,...G(t)})}function Iu(e,t){return new e({type:"string",format:"cidrv6",check:"string_format",abort:!1,...G(t)})}function Pu(e,t){return new e({type:"string",format:"base64",check:"string_format",abort:!1,...G(t)})}function ju(e,t){return new e({type:"string",format:"base64url",check:"string_format",abort:!1,...G(t)})}function Ou(e,t){return new e({type:"string",format:"e164",check:"string_format",abort:!1,...G(t)})}function $u(e,t){return new e({type:"string",format:"jwt",check:"string_format",abort:!1,...G(t)})}function Bu(e,t){return new e({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...G(t)})}function Gu(e,t){return new e({type:"string",format:"date",check:"string_format",...G(t)})}function Zu(e,t){return new e({type:"string",format:"time",check:"string_format",precision:null,...G(t)})}function Uu(e,t){return new e({type:"string",format:"duration",check:"string_format",...G(t)})}function Du(e,t){return new e({type:"number",checks:[],...G(t)})}function Lu(e,t){return new e({type:"number",check:"number_format",abort:!1,format:"safeint",...G(t)})}function Fu(e,t){return new e({type:"boolean",...G(t)})}function Nu(e){return new e({type:"any"})}function Wu(e){return new e({type:"unknown"})}function Vu(e,t){return new e({type:"never",...G(t)})}function Fo(e,t){return new ki({check:"less_than",...G(t),value:e,inclusive:!1})}function er(e,t){return new ki({check:"less_than",...G(t),value:e,inclusive:!0})}function No(e,t){return new Mi({check:"greater_than",...G(t),value:e,inclusive:!1})}function tr(e,t){return new Mi({check:"greater_than",...G(t),value:e,inclusive:!0})}function Wo(e,t){return new ac({check:"multiple_of",...G(t),value:e})}function Pi(e,t){return new uc({check:"max_length",...G(t),maximum:e})}function En(e,t){return new lc({check:"min_length",...G(t),minimum:e})}function ji(e,t){return new fc({check:"length_equals",...G(t),length:e})}function Yu(e,t){return new hc({check:"string_format",format:"regex",...G(t),pattern:e})}function Ku(e){return new dc({check:"string_format",format:"lowercase",...G(e)})}function Xu(e){return new pc({check:"string_format",format:"uppercase",...G(e)})}function Ju(e,t){return new mc({check:"string_format",format:"includes",...G(t),includes:e})}function qu(e,t){return new yc({check:"string_format",format:"starts_with",...G(t),prefix:e})}function Qu(e,t){return new vc({check:"string_format",format:"ends_with",...G(t),suffix:e})}function zt(e){return new wc({check:"overwrite",tx:e})}function el(e){return zt(t=>t.normalize(e))}function tl(){return zt(e=>e.trim())}function nl(){return zt(e=>e.toLowerCase())}function rl(){return zt(e=>e.toUpperCase())}function ol(){return zt(e=>fa(e))}function il(e,t,r){return new e({type:"array",element:t,...G(r)})}function sl(e,t,r){const i=G(r);return i.abort??(i.abort=!0),new e({type:"custom",check:"custom",fn:t,...i})}function al(e,t,r){return new e({type:"custom",check:"custom",fn:t,...G(r)})}function cl(e){const t=ul(r=>(r.addIssue=i=>{if(typeof i=="string")r.issues.push(Vt(i,r.value,t._zod.def));else{const a=i;a.fatal&&(a.continue=!1),a.code??(a.code="custom"),a.input??(a.input=r.value),a.inst??(a.inst=t),a.continue??(a.continue=!t._zod.def.abort),r.issues.push(Vt(a))}},e(r.value,r)));return t}function ul(e,t){const r=new Ie({check:"custom",...G(t)});return r._zod.check=e,r}const ll=x("ZodISODateTime",(e,t)=>{Cc.init(e,t),he.init(e,t)});function fl(e){return Bu(ll,e)}const hl=x("ZodISODate",(e,t)=>{Ic.init(e,t),he.init(e,t)});function dl(e){return Gu(hl,e)}const pl=x("ZodISOTime",(e,t)=>{Pc.init(e,t),he.init(e,t)});function ml(e){return Zu(pl,e)}const yl=x("ZodISODuration",(e,t)=>{jc.init(e,t),he.init(e,t)});function vl(e){return Uu(yl,e)}const wl=(e,t)=>{_i.init(e,t),e.name="ZodError",Object.defineProperties(e,{format:{value:r=>xa(e,r)},flatten:{value:r=>Ta(e,r)},addIssue:{value:r=>{e.issues.push(r),e.message=JSON.stringify(e.issues,cr,2)}},addIssues:{value:r=>{e.issues.push(...r),e.message=JSON.stringify(e.issues,cr,2)}},isEmpty:{get(){return e.issues.length===0}}})},Be=x("ZodError",wl,{Parent:Error}),gl=xn(Be),El=Rn(Be),_l=kn(Be),bl=Mn(Be),Tl=Ma(Be),xl=Sa(Be),Rl=za(Be),kl=Ha(Be),Ml=Aa(Be),Sl=Ca(Be),zl=Ia(Be),Hl=Pa(Be),le=x("ZodType",(e,t)=>(se.init(e,t),e.def=t,e.type=t.type,Object.defineProperty(e,"_def",{value:t}),e.check=(...r)=>e.clone(yt(t,{checks:[...t.checks??[],...r.map(i=>typeof i=="function"?{_zod:{check:i,def:{check:"custom"},onattach:[]}}:i)]})),e.clone=(r,i)=>ot(e,r,i),e.brand=()=>e,e.register=((r,i)=>(r.add(e,i),e)),e.parse=(r,i)=>gl(e,r,i,{callee:e.parse}),e.safeParse=(r,i)=>_l(e,r,i),e.parseAsync=async(r,i)=>El(e,r,i,{callee:e.parseAsync}),e.safeParseAsync=async(r,i)=>bl(e,r,i),e.spa=e.safeParseAsync,e.encode=(r,i)=>Tl(e,r,i),e.decode=(r,i)=>xl(e,r,i),e.encodeAsync=async(r,i)=>Rl(e,r,i),e.decodeAsync=async(r,i)=>kl(e,r,i),e.safeEncode=(r,i)=>Ml(e,r,i),e.safeDecode=(r,i)=>Sl(e,r,i),e.safeEncodeAsync=async(r,i)=>zl(e,r,i),e.safeDecodeAsync=async(r,i)=>Hl(e,r,i),e.refine=(r,i)=>e.check(Rf(r,i)),e.superRefine=r=>e.check(kf(r)),e.overwrite=r=>e.check(zt(r)),e.optional=()=>Ko(e),e.nullable=()=>Xo(e),e.nullish=()=>Ko(Xo(e)),e.nonoptional=r=>vf(e,r),e.array=()=>_r(e),e.or=r=>Ht([e,r]),e.and=r=>sf(e,r),e.transform=r=>Jo(e,ff(r)),e.default=r=>pf(e,r),e.prefault=r=>yf(e,r),e.catch=r=>gf(e,r),e.pipe=r=>Jo(e,r),e.readonly=()=>bf(e),e.describe=r=>{const i=e.clone();return hn.add(i,{description:r}),i},Object.defineProperty(e,"description",{get(){return hn.get(e)?.description},configurable:!0}),e.meta=(...r)=>{if(r.length===0)return hn.get(e);const i=e.clone();return hn.add(i,r[0]),i},e.isOptional=()=>e.safeParse(void 0).success,e.isNullable=()=>e.safeParse(null).success,e)),Oi=x("_ZodString",(e,t)=>{Er.init(e,t),le.init(e,t);const r=e._zod.bag;e.format=r.format??null,e.minLength=r.minimum??null,e.maxLength=r.maximum??null,e.regex=(...i)=>e.check(Yu(...i)),e.includes=(...i)=>e.check(Ju(...i)),e.startsWith=(...i)=>e.check(qu(...i)),e.endsWith=(...i)=>e.check(Qu(...i)),e.min=(...i)=>e.check(En(...i)),e.max=(...i)=>e.check(Pi(...i)),e.length=(...i)=>e.check(ji(...i)),e.nonempty=(...i)=>e.check(En(1,...i)),e.lowercase=i=>e.check(Ku(i)),e.uppercase=i=>e.check(Xu(i)),e.trim=()=>e.check(tl()),e.normalize=(...i)=>e.check(el(...i)),e.toLowerCase=()=>e.check(nl()),e.toUpperCase=()=>e.check(rl()),e.slugify=()=>e.check(ol())}),Al=x("ZodString",(e,t)=>{Er.init(e,t),Oi.init(e,t),e.email=r=>e.check(wu(Cl,r)),e.url=r=>e.check(Ii($i,r)),e.jwt=r=>e.check($u(Vl,r)),e.emoji=r=>e.check(Tu(Il,r)),e.guid=r=>e.check(Lo(Vo,r)),e.uuid=r=>e.check(gu(dn,r)),e.uuidv4=r=>e.check(Eu(dn,r)),e.uuidv6=r=>e.check(_u(dn,r)),e.uuidv7=r=>e.check(bu(dn,r)),e.nanoid=r=>e.check(xu(Pl,r)),e.guid=r=>e.check(Lo(Vo,r)),e.cuid=r=>e.check(Ru(jl,r)),e.cuid2=r=>e.check(ku(Ol,r)),e.ulid=r=>e.check(Mu($l,r)),e.base64=r=>e.check(Pu(Fl,r)),e.base64url=r=>e.check(ju(Nl,r)),e.xid=r=>e.check(Su(Bl,r)),e.ksuid=r=>e.check(zu(Gl,r)),e.ipv4=r=>e.check(Hu(Zl,r)),e.ipv6=r=>e.check(Au(Ul,r)),e.cidrv4=r=>e.check(Cu(Dl,r)),e.cidrv6=r=>e.check(Iu(Ll,r)),e.e164=r=>e.check(Ou(Wl,r)),e.datetime=r=>e.check(fl(r)),e.date=r=>e.check(dl(r)),e.time=r=>e.check(ml(r)),e.duration=r=>e.check(vl(r))});function Me(e){return vu(Al,e)}const he=x("ZodStringFormat",(e,t)=>{ue.init(e,t),Oi.init(e,t)}),Cl=x("ZodEmail",(e,t)=>{Tc.init(e,t),he.init(e,t)}),Vo=x("ZodGUID",(e,t)=>{_c.init(e,t),he.init(e,t)}),dn=x("ZodUUID",(e,t)=>{bc.init(e,t),he.init(e,t)}),$i=x("ZodURL",(e,t)=>{xc.init(e,t),he.init(e,t)});function Bi(e){return Ii($i,e)}const Il=x("ZodEmoji",(e,t)=>{Rc.init(e,t),he.init(e,t)}),Pl=x("ZodNanoID",(e,t)=>{kc.init(e,t),he.init(e,t)}),jl=x("ZodCUID",(e,t)=>{Mc.init(e,t),he.init(e,t)}),Ol=x("ZodCUID2",(e,t)=>{Sc.init(e,t),he.init(e,t)}),$l=x("ZodULID",(e,t)=>{zc.init(e,t),he.init(e,t)}),Bl=x("ZodXID",(e,t)=>{Hc.init(e,t),he.init(e,t)}),Gl=x("ZodKSUID",(e,t)=>{Ac.init(e,t),he.init(e,t)}),Zl=x("ZodIPv4",(e,t)=>{Oc.init(e,t),he.init(e,t)}),Ul=x("ZodIPv6",(e,t)=>{$c.init(e,t),he.init(e,t)}),Dl=x("ZodCIDRv4",(e,t)=>{Bc.init(e,t),he.init(e,t)}),Ll=x("ZodCIDRv6",(e,t)=>{Gc.init(e,t),he.init(e,t)}),Fl=x("ZodBase64",(e,t)=>{Zc.init(e,t),he.init(e,t)}),Nl=x("ZodBase64URL",(e,t)=>{Dc.init(e,t),he.init(e,t)}),Wl=x("ZodE164",(e,t)=>{Lc.init(e,t),he.init(e,t)}),Vl=x("ZodJWT",(e,t)=>{Nc.init(e,t),he.init(e,t)}),Gi=x("ZodNumber",(e,t)=>{zi.init(e,t),le.init(e,t),e.gt=(i,a)=>e.check(No(i,a)),e.gte=(i,a)=>e.check(tr(i,a)),e.min=(i,a)=>e.check(tr(i,a)),e.lt=(i,a)=>e.check(Fo(i,a)),e.lte=(i,a)=>e.check(er(i,a)),e.max=(i,a)=>e.check(er(i,a)),e.int=i=>e.check(Yo(i)),e.safe=i=>e.check(Yo(i)),e.positive=i=>e.check(No(0,i)),e.nonnegative=i=>e.check(tr(0,i)),e.negative=i=>e.check(Fo(0,i)),e.nonpositive=i=>e.check(er(0,i)),e.multipleOf=(i,a)=>e.check(Wo(i,a)),e.step=(i,a)=>e.check(Wo(i,a)),e.finite=()=>e;const r=e._zod.bag;e.minValue=Math.max(r.minimum??Number.NEGATIVE_INFINITY,r.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,e.maxValue=Math.min(r.maximum??Number.POSITIVE_INFINITY,r.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,e.isInt=(r.format??"").includes("int")||Number.isSafeInteger(r.multipleOf??.5),e.isFinite=!0,e.format=r.format??null});function ke(e){return Du(Gi,e)}const Yl=x("ZodNumberFormat",(e,t)=>{Wc.init(e,t),Gi.init(e,t)});function Yo(e){return Lu(Yl,e)}const Kl=x("ZodBoolean",(e,t)=>{Vc.init(e,t),le.init(e,t)});function Ut(e){return Fu(Kl,e)}const Xl=x("ZodAny",(e,t)=>{Yc.init(e,t),le.init(e,t)});function Jl(){return Nu(Xl)}const ql=x("ZodUnknown",(e,t)=>{Kc.init(e,t),le.init(e,t)});function _n(){return Wu(ql)}const Ql=x("ZodNever",(e,t)=>{Xc.init(e,t),le.init(e,t)});function ef(e){return Vu(Ql,e)}const tf=x("ZodArray",(e,t)=>{Jc.init(e,t),le.init(e,t),e.element=t.element,e.min=(r,i)=>e.check(En(r,i)),e.nonempty=r=>e.check(En(1,r)),e.max=(r,i)=>e.check(Pi(r,i)),e.length=(r,i)=>e.check(ji(r,i)),e.unwrap=()=>e.element});function _r(e,t){return il(tf,e,t)}const nf=x("ZodObject",(e,t)=>{Qc.init(e,t),le.init(e,t),ie(e,"shape",()=>t.shape),e.keyof=()=>Zi(Object.keys(e._zod.def.shape)),e.catchall=r=>e.clone({...e._zod.def,catchall:r}),e.passthrough=()=>e.clone({...e._zod.def,catchall:_n()}),e.loose=()=>e.clone({...e._zod.def,catchall:_n()}),e.strict=()=>e.clone({...e._zod.def,catchall:ef()}),e.strip=()=>e.clone({...e._zod.def,catchall:void 0}),e.extend=r=>wa(e,r),e.safeExtend=r=>ga(e,r),e.merge=r=>Ea(e,r),e.pick=r=>ya(e,r),e.omit=r=>va(e,r),e.partial=(...r)=>_a(Ui,e,r[0]),e.required=(...r)=>ba(Di,e,r[0])});function we(e,t){const r={type:"object",shape:e??{},...G(t)};return new nf(r)}const rf=x("ZodUnion",(e,t)=>{eu.init(e,t),le.init(e,t),e.options=t.options});function Ht(e,t){return new rf({type:"union",options:e,...G(t)})}const of=x("ZodIntersection",(e,t)=>{tu.init(e,t),le.init(e,t)});function sf(e,t){return new of({type:"intersection",left:e,right:t})}const af=x("ZodTuple",(e,t)=>{Ci.init(e,t),le.init(e,t),e.rest=r=>e.clone({...e._zod.def,rest:r})});function cf(e,t,r){const i=t instanceof se,a=i?r:t,u=i?t:null;return new af({type:"tuple",items:e,rest:u,...G(a)})}const lr=x("ZodEnum",(e,t)=>{nu.init(e,t),le.init(e,t),e.enum=t.entries,e.options=Object.values(t.entries);const r=new Set(Object.keys(t.entries));e.extract=(i,a)=>{const u={};for(const l of i)if(r.has(l))u[l]=t.entries[l];else throw new Error(`Key ${l} not found in enum`);return new lr({...t,checks:[],...G(a),entries:u})},e.exclude=(i,a)=>{const u={...t.entries};for(const l of i)if(r.has(l))delete u[l];else throw new Error(`Key ${l} not found in enum`);return new lr({...t,checks:[],...G(a),entries:u})}});function Zi(e,t){const r=Array.isArray(e)?Object.fromEntries(e.map(i=>[i,i])):e;return new lr({type:"enum",entries:r,...G(t)})}const uf=x("ZodLiteral",(e,t)=>{ru.init(e,t),le.init(e,t),e.values=new Set(t.values),Object.defineProperty(e,"value",{get(){if(t.values.length>1)throw new Error("This schema contains multiple valid literal values. Use `.values` instead.");return t.values[0]}})});function Se(e,t){return new uf({type:"literal",values:Array.isArray(e)?e:[e],...G(t)})}const lf=x("ZodTransform",(e,t)=>{ou.init(e,t),le.init(e,t),e._zod.parse=(r,i)=>{if(i.direction==="backward")throw new yi(e.constructor.name);r.addIssue=u=>{if(typeof u=="string")r.issues.push(Vt(u,r.value,t));else{const l=u;l.fatal&&(l.continue=!1),l.code??(l.code="custom"),l.input??(l.input=r.value),l.inst??(l.inst=e),r.issues.push(Vt(l))}};const a=t.transform(r.value,r);return a instanceof Promise?a.then(u=>(r.value=u,r)):(r.value=a,r)}});function ff(e){return new lf({type:"transform",transform:e})}const Ui=x("ZodOptional",(e,t)=>{iu.init(e,t),le.init(e,t),e.unwrap=()=>e._zod.def.innerType});function Ko(e){return new Ui({type:"optional",innerType:e})}const hf=x("ZodNullable",(e,t)=>{su.init(e,t),le.init(e,t),e.unwrap=()=>e._zod.def.innerType});function Xo(e){return new hf({type:"nullable",innerType:e})}const df=x("ZodDefault",(e,t)=>{au.init(e,t),le.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeDefault=e.unwrap});function pf(e,t){return new df({type:"default",innerType:e,get defaultValue(){return typeof t=="function"?t():gi(t)}})}const mf=x("ZodPrefault",(e,t)=>{cu.init(e,t),le.init(e,t),e.unwrap=()=>e._zod.def.innerType});function yf(e,t){return new mf({type:"prefault",innerType:e,get defaultValue(){return typeof t=="function"?t():gi(t)}})}const Di=x("ZodNonOptional",(e,t)=>{uu.init(e,t),le.init(e,t),e.unwrap=()=>e._zod.def.innerType});function vf(e,t){return new Di({type:"nonoptional",innerType:e,...G(t)})}const wf=x("ZodCatch",(e,t)=>{lu.init(e,t),le.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeCatch=e.unwrap});function gf(e,t){return new wf({type:"catch",innerType:e,catchValue:typeof t=="function"?t:()=>t})}const Ef=x("ZodPipe",(e,t)=>{fu.init(e,t),le.init(e,t),e.in=t.in,e.out=t.out});function Jo(e,t){return new Ef({type:"pipe",in:e,out:t})}const _f=x("ZodReadonly",(e,t)=>{hu.init(e,t),le.init(e,t),e.unwrap=()=>e._zod.def.innerType});function bf(e){return new _f({type:"readonly",innerType:e})}const Tf=x("ZodFunction",(e,t)=>{du.init(e,t),le.init(e,t)});function xf(e){return new Tf({type:"function",input:Array.isArray(e?.input)?cf(e?.input):_r(_n()),output:_n()})}const br=x("ZodCustom",(e,t)=>{pu.init(e,t),le.init(e,t)});function Li(e,t){return sl(br,e??(()=>!0),t)}function Rf(e,t={}){return al(br,e,t)}function kf(e){return cl(e)}function pn(e,t={error:`Input not instance of ${e.name}`}){const r=new br({type:"custom",check:"custom",fn:i=>i instanceof e,abort:!0,...G(t)});return r._zod.bag.Class=e,r}const Mf=Ht([Se("mirage"),Se("mirage_v2"),Se("lucy_v2v_720p_rt")]),Sf=Ht([Se("lucy-dev-i2v"),Se("lucy-fast-v2v"),Se("lucy-pro-t2v"),Se("lucy-pro-i2v"),Se("lucy-pro-v2v"),Se("lucy-pro-flf2v"),Se("lucy-motion")]),zf=Ht([Se("lucy-pro-t2i"),Se("lucy-pro-i2i")]),Hf=Ht([Mf,Sf,zf]),nt=Ht([pn(File),pn(Blob),pn(ReadableStream),pn(URL),Bi()]),Af=Se("720p").default("720p").optional().describe("The resolution to use for the generation. For dev models, only `720p` is supported."),Gt=()=>Zi(["720p","480p"]).optional().describe("The resolution to use for the generation").default("720p"),Cf=Se("720p").default("720p").optional().describe("The resolution to use for the generation"),qo=Se("720p").optional().describe("The resolution to use for the generation").default("720p"),Xe={"lucy-pro-t2v":we({prompt:Me().min(1).max(1e3).describe("The prompt to use for the generation"),seed:ke().optional().describe("The seed to use for the generation"),resolution:Gt(),orientation:Me().optional().describe("The orientation to use for the generation")}),"lucy-pro-t2i":we({prompt:Me().min(1).max(1e3).describe("The prompt to use for the generation"),seed:ke().optional().describe("The seed to use for the generation"),resolution:Gt(),orientation:Me().optional().describe("The orientation to use for the generation")}),"lucy-pro-i2v":we({prompt:Me().min(1).max(1e3).describe("The prompt to use for the generation"),data:nt.describe("The image data to use for generation (File, Blob, ReadableStream, URL, or string URL)"),seed:ke().optional().describe("The seed to use for the generation"),resolution:Gt()}),"lucy-dev-i2v":we({prompt:Me().min(1).max(1e3).describe("The prompt to use for the generation"),data:nt.describe("The image data to use for generation (File, Blob, ReadableStream, URL, or string URL)"),seed:ke().optional().describe("The seed to use for the generation"),resolution:Af}),"lucy-pro-v2v":we({prompt:Me().min(1).max(1e3).describe("The prompt to use for the generation"),data:nt.describe("The video data to use for generation (File, Blob, ReadableStream, URL, or string URL)"),seed:ke().optional().describe("The seed to use for the generation"),resolution:qo,enhance_prompt:Ut().optional().describe("Whether to enhance the prompt"),num_inference_steps:ke().optional().describe("The number of inference steps")}),"lucy-fast-v2v":we({prompt:Me().min(1).max(1e3).describe("The prompt to use for the generation"),data:nt.describe("The video data to use for generation (File, Blob, ReadableStream, URL, or string URL)"),seed:ke().optional().describe("The seed to use for the generation"),resolution:qo,enhance_prompt:Ut().optional().describe("Whether to enhance the prompt")}),"lucy-pro-flf2v":we({prompt:Me().min(1).max(1e3).describe("The prompt to use for the generation"),start:nt.describe("The start frame image (File, Blob, ReadableStream, URL, or string URL)"),end:nt.describe("The end frame image (File, Blob, ReadableStream, URL, or string URL)"),seed:ke().optional().describe("The seed to use for the generation"),resolution:Gt()}),"lucy-pro-i2i":we({prompt:Me().min(1).max(1e3).describe("The prompt to use for the generation"),data:nt.describe("The image data to use for generation (File, Blob, ReadableStream, URL, or string URL)"),seed:ke().optional().describe("The seed to use for the generation"),resolution:Gt(),enhance_prompt:Ut().optional().describe("Whether to enhance the prompt")}),"lucy-motion":we({data:nt.describe("The image data to use for generation (File, Blob, ReadableStream, URL, or string URL)"),trajectory:_r(we({frame:ke().min(0),x:ke().min(0),y:ke().min(0)})).min(2).max(121).describe("The trajectory of the desired movement of the object in the image"),seed:ke().optional().describe("The seed to use for the generation"),resolution:Cf})},If=we({name:Hf,urlPath:Me(),queueUrlPath:Me().optional(),fps:ke().min(1),width:ke().min(1),height:ke().min(1),inputSchema:Jl()}),nr={realtime:{mirage:{urlPath:"/v1/stream",name:"mirage",fps:25,width:1280,height:704,inputSchema:we({})},mirage_v2:{urlPath:"/v1/stream",name:"mirage_v2",fps:22,width:1280,height:704,inputSchema:we({})},lucy_v2v_720p_rt:{urlPath:"/v1/stream",name:"lucy_v2v_720p_rt",fps:25,width:1280,height:704,inputSchema:we({})}},image:{"lucy-pro-t2i":{urlPath:"/v1/generate/lucy-pro-t2i",queueUrlPath:"/v1/jobs/lucy-pro-t2i",name:"lucy-pro-t2i",fps:25,width:1280,height:704,inputSchema:Xe["lucy-pro-t2i"]},"lucy-pro-i2i":{urlPath:"/v1/generate/lucy-pro-i2i",queueUrlPath:"/v1/jobs/lucy-pro-i2i",name:"lucy-pro-i2i",fps:25,width:1280,height:704,inputSchema:Xe["lucy-pro-i2i"]}},video:{"lucy-dev-i2v":{urlPath:"/v1/generate/lucy-dev-i2v",queueUrlPath:"/v1/jobs/lucy-dev-i2v",name:"lucy-dev-i2v",fps:25,width:1280,height:704,inputSchema:Xe["lucy-dev-i2v"]},"lucy-fast-v2v":{urlPath:"/v1/generate/lucy-fast-v2v",queueUrlPath:"/v1/jobs/lucy-fast-v2v",name:"lucy-fast-v2v",fps:25,width:1280,height:720,inputSchema:Xe["lucy-fast-v2v"]},"lucy-pro-t2v":{urlPath:"/v1/generate/lucy-pro-t2v",queueUrlPath:"/v1/jobs/lucy-pro-t2v",name:"lucy-pro-t2v",fps:25,width:1280,height:704,inputSchema:Xe["lucy-pro-t2v"]},"lucy-pro-i2v":{urlPath:"/v1/generate/lucy-pro-i2v",queueUrlPath:"/v1/jobs/lucy-pro-i2v",name:"lucy-pro-i2v",fps:25,width:1280,height:704,inputSchema:Xe["lucy-pro-i2v"]},"lucy-pro-v2v":{urlPath:"/v1/generate/lucy-pro-v2v",queueUrlPath:"/v1/jobs/lucy-pro-v2v",name:"lucy-pro-v2v",fps:25,width:1280,height:704,inputSchema:Xe["lucy-pro-v2v"]},"lucy-pro-flf2v":{urlPath:"/v1/generate/lucy-pro-flf2v",queueUrlPath:"/v1/jobs/lucy-pro-flf2v",name:"lucy-pro-flf2v",fps:25,width:1280,height:704,inputSchema:Xe["lucy-pro-flf2v"]},"lucy-motion":{urlPath:"/v1/generate/lucy-motion",queueUrlPath:"/v1/jobs/lucy-motion",name:"lucy-motion",fps:25,width:1280,height:704,inputSchema:Xe["lucy-motion"]}}},Pf={realtime:e=>{const t=nr.realtime[e];if(!t)throw Qn(e);return t},video:e=>{const t=nr.video[e];if(!t)throw Qn(e);return t},image:e=>{const t=nr.image[e];if(!t)throw Qn(e);return t}},jf=we({prompt:we({text:Me().min(1),enhance:Ut().optional().default(!0)}).optional()}),Of=15*1e3,$f=e=>({setPrompt:async(r,{enhance:i}={})=>{const a=we({prompt:Me().min(1),enhance:Ut().optional().default(!0)}).safeParse({prompt:r,enhance:i});if(!a.success)throw a.error;const u=e.getWebsocketMessageEmitter();let l,m;try{const w=new Promise((z,A)=>{l=S=>{S.prompt===a.data.prompt&&(S.success?z():A(S.error))},u.on("promptAck",l)});e.sendMessage({type:"prompt",prompt:a.data.prompt,enhance_prompt:a.data.enhance});const b=new Promise((z,A)=>{m=setTimeout(()=>A(new Error("Prompt timed out")),Of)});await Promise.race([w,b])}finally{l&&u.off("promptAck",l),m&&clearTimeout(m)}}});function Fi(e){return{all:e=e||new Map,on:function(t,r){var i=e.get(t);i?i.push(r):e.set(t,[r])},off:function(t,r){var i=e.get(t);i&&(r?i.splice(i.indexOf(r)>>>0,1):e.set(t,[]))},emit:function(t,r){var i=e.get(t);i&&i.slice().map(function(a){a(r)}),(i=e.get("*"))&&i.slice().map(function(a){a(t,r)})}}}const Bf=[{urls:"stun:stun.l.google.com:19302"}];var Gf=class{pc=null;ws=null;localStream=null;connectionReject=null;state="disconnected";websocketMessagesEmitter=Fi();constructor(e={}){this.callbacks=e}async connect(e,t,r=6e4,i){const a=Date.now()+r;this.localStream=t;const u=encodeURIComponent(di(i)),l=e.includes("?")?"&":"?",m=`${e}${l}user_agent=${u}`;return await new Promise((w,b)=>{this.connectionReject=b;const z=setTimeout(()=>b(new Error("WebSocket timeout")),r);this.ws=new WebSocket(m),this.ws.onopen=()=>{clearTimeout(z),w()},this.ws.onmessage=A=>{try{this.handleSignalingMessage(JSON.parse(A.data))}catch(S){console.error("[WebRTC] Parse error:",S)}},this.ws.onerror=()=>{clearTimeout(z)},this.ws.onclose=()=>this.setState("disconnected")}),await this.setupNewPeerConnection(),new Promise((w,b)=>{this.connectionReject=b;const z=setInterval(()=>{this.state==="connected"?(clearInterval(z),this.connectionReject=null,w()):Date.now()>=a&&(clearInterval(z),this.connectionReject=null,b(new Error("Connection timeout")))},100)})}async handleSignalingMessage(e){if(this.pc)try{switch(e.type){case"error":{const t=new Error(e.error);this.callbacks.onError?.(t),this.connectionReject&&(this.connectionReject(t),this.connectionReject=null);break}case"ready":{await this.applyCodecPreference("video/VP8");const t=await this.pc.createOffer();this.modifyVP8Bitrate(t),await this.callbacks.customizeOffer?.(t),await this.pc.setLocalDescription(t),this.send({type:"offer",sdp:t.sdp||""});break}case"offer":{await this.pc.setRemoteDescription({type:"offer",sdp:e.sdp});const t=await this.pc.createAnswer();await this.pc.setLocalDescription(t),this.send({type:"answer",sdp:t.sdp||""});break}case"answer":await this.pc.setRemoteDescription({type:"answer",sdp:e.sdp});break;case"ice-candidate":e.candidate&&await this.pc.addIceCandidate(e.candidate);break;case"ice-restart":{const t=e.turn_config;t&&await this.setupNewPeerConnection(t);break}case"prompt_ack":this.websocketMessagesEmitter.emit("promptAck",e);break}}catch(t){console.error("[WebRTC] Error:",t),this.callbacks.onError?.(t)}}send(e){this.ws?.readyState===WebSocket.OPEN&&this.ws.send(JSON.stringify(e))}setState(e){this.state!==e&&(this.state=e,console.log(`[WebRTC] State: ${e}`),this.callbacks.onStateChange?.(e))}async setupNewPeerConnection(e){if(!this.localStream)throw new Error("No local stream found");this.pc&&(this.pc.getSenders().forEach(r=>{r.track&&this.pc.removeTrack(r)}),this.pc.close());const t=Bf;e&&t.push({urls:e.server_url,credential:e.credential,username:e.username}),this.pc=new RTCPeerConnection({iceServers:t}),this.localStream.getTracks().forEach(r=>this.pc.addTrack(r,this.localStream)),this.pc.ontrack=r=>{r.streams?.[0]&&this.callbacks.onRemoteStream?.(r.streams[0])},this.pc.onicecandidate=r=>{this.send({type:"ice-candidate",candidate:r.candidate})},this.pc.onconnectionstatechange=()=>{if(!this.pc)return;const r=this.pc.connectionState;this.setState(r==="connected"?"connected":["connecting","new"].includes(r)?"connecting":"disconnected")},this.pc.oniceconnectionstatechange=()=>{},this.handleSignalingMessage({type:"ready"})}cleanup(){this.pc?.getSenders().forEach(e=>e.track?.stop()),this.pc?.close(),this.pc=null,this.ws?.close(),this.ws=null,this.localStream=null,this.setState("disconnected")}async applyCodecPreference(e){if(!this.pc)return;const t=this.pc.getTransceivers().find(l=>l.sender.track?.kind==="video");if(!t){console.error("Could not find video transceiver. Ensure track is added to peer connection.");return}const r=RTCRtpSender.getCapabilities("video");if(!r){console.error("Could not get video sender capabilities.");return}const i=[],a=[];r.codecs.forEach(l=>{l.mimeType.toLowerCase()===e.toLowerCase()?i.push(l):a.push(l)});const u=[...i,...a];if(u.length===0){console.warn("No video codecs found to set preferences for.");return}await t.setCodecPreferences(u)}modifyVP8Bitrate(e){if(!e.sdp)return;const t=this.callbacks.vp8MinBitrate,r=this.callbacks.vp8StartBitrate;if(t===0&&r===0)return;const i=`x-google-min-bitrate=${t};x-google-start-bitrate=${r}`,a=e.sdp.split(`\r
`),u=[];for(let l=0;l<a.length;l++){if(a[l].includes("VP8/90000")){const m=a[l].match(/a=rtpmap:(\d+) VP8/);if(m){const w=m[1];let b=-1,z=l;for(let A=l+1;A<a.length&&a[A].startsWith("a=");A++){if(a[A].startsWith(`a=fmtp:${w}`)){b=A;break}if(a[A].startsWith(`a=rtcp-fb:${w}`)&&(z=A),a[A].startsWith("a=rtpmap:"))break}if(b!==-1)a[b].includes("x-google-min-bitrate")||(a[b]+=`;${i}`);else{for(let A=l;A<=z;A++)u.push(a[A]);u.push(`a=fmtp:${w} ${i}`),l=z;continue}}}u.push(a[l])}e.sdp=u.join(`\r
`)}},rr={},or,Qo;function Zf(){if(Qo)return or;Qo=1;function e(t,r){typeof r=="boolean"&&(r={forever:r}),this._originalTimeouts=JSON.parse(JSON.stringify(t)),this._timeouts=t,this._options=r||{},this._maxRetryTime=r&&r.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}return or=e,e.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)},e.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null},e.prototype.retry=function(t){if(this._timeout&&clearTimeout(this._timeout),!t)return!1;var r=new Date().getTime();if(t&&r-this._operationStart>=this._maxRetryTime)return this._errors.push(t),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(t);var i=this._timeouts.shift();if(i===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),i=this._cachedTimeouts.slice(-1);else return!1;var a=this;return this._timer=setTimeout(function(){a._attempts++,a._operationTimeoutCb&&(a._timeout=setTimeout(function(){a._operationTimeoutCb(a._attempts)},a._operationTimeout),a._options.unref&&a._timeout.unref()),a._fn(a._attempts)},i),this._options.unref&&this._timer.unref(),!0},e.prototype.attempt=function(t,r){this._fn=t,r&&(r.timeout&&(this._operationTimeout=r.timeout),r.cb&&(this._operationTimeoutCb=r.cb));var i=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){i._operationTimeoutCb()},i._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)},e.prototype.try=function(t){console.log("Using RetryOperation.try() is deprecated"),this.attempt(t)},e.prototype.start=function(t){console.log("Using RetryOperation.start() is deprecated"),this.attempt(t)},e.prototype.start=e.prototype.try,e.prototype.errors=function(){return this._errors},e.prototype.attempts=function(){return this._attempts},e.prototype.mainError=function(){if(this._errors.length===0)return null;for(var t={},r=null,i=0,a=0;a<this._errors.length;a++){var u=this._errors[a],l=u.message,m=(t[l]||0)+1;t[l]=m,m>=i&&(r=u,i=m)}return r},or}var ei;function Uf(){return ei||(ei=1,(function(e){var t=Zf();e.operation=function(r){var i=e.timeouts(r);return new t(i,{forever:r&&(r.forever||r.retries===1/0),unref:r&&r.unref,maxRetryTime:r&&r.maxRetryTime})},e.timeouts=function(r){if(r instanceof Array)return[].concat(r);var i={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var a in r)i[a]=r[a];if(i.minTimeout>i.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var u=[],l=0;l<i.retries;l++)u.push(this.createTimeout(l,i));return r&&r.forever&&!u.length&&u.push(this.createTimeout(l,i)),u.sort(function(m,w){return m-w}),u},e.createTimeout=function(r,i){var a=i.randomize?Math.random()+1:1,u=Math.round(a*Math.max(i.minTimeout,1)*Math.pow(i.factor,r));return u=Math.min(u,i.maxTimeout),u},e.wrap=function(r,i,a){if(i instanceof Array&&(a=i,i=null),!a){a=[];for(var u in r)typeof r[u]=="function"&&a.push(u)}for(var l=0;l<a.length;l++){var m=a[l],w=r[m];r[m]=(function(z){var A=e.operation(i),S=Array.prototype.slice.call(arguments,1),F=S.pop();S.push(function(E){A.retry(E)||(E&&(arguments[0]=A.mainError()),F.apply(this,arguments))}),A.attempt(function(){z.apply(r,S)})}).bind(r,w),r[m].options=i}}})(rr)),rr}var ir,ti;function Df(){return ti||(ti=1,ir=Uf()),ir}var Lf=Df();const Ff=Bs(Lf),Nf=Object.prototype.toString,Wf=e=>Nf.call(e)==="[object Error]",Vf=new Set(["network error","Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed","fetch failed","terminated"," A network error occurred.","Network connection lost"]);function Yf(e){if(!(e&&Wf(e)&&e.name==="TypeError"&&typeof e.message=="string"))return!1;const{message:r,stack:i}=e;return r==="Load failed"?i===void 0||"__sentry_captured__"in e:r.startsWith("error sending request for url")?!0:Vf.has(r)}class Kf extends Error{constructor(t){super(),t instanceof Error?(this.originalError=t,{message:t}=t):(this.originalError=new Error(t),this.originalError.stack=this.stack),this.name="AbortError",this.message=t}}const ni=(e,t,r)=>{const i=r.retries-(t-1);return e.attemptNumber=t,e.retriesLeft=i,e};async function Xf(e,t){return new Promise((r,i)=>{t={...t},t.onFailedAttempt??=()=>{},t.shouldRetry??=()=>!0,t.retries??=10;const a=Ff.operation(t),u=()=>{a.stop(),i(t.signal?.reason)};t.signal&&!t.signal.aborted&&t.signal.addEventListener("abort",u,{once:!0});const l=()=>{t.signal?.removeEventListener("abort",u),a.stop()};a.attempt(async m=>{try{const w=await e(m);l(),r(w)}catch(w){try{if(!(w instanceof Error))throw new TypeError(`Non-error was thrown: "${w}". You should only throw errors.`);if(w instanceof Kf)throw w.originalError;if(w instanceof TypeError&&!Yf(w))throw w;if(ni(w,m,t),await t.shouldRetry(w)||(a.stop(),i(w)),await t.onFailedAttempt(w),!a.retry(w))throw a.mainError()}catch(b){ni(b,m,t),l(),i(b)}}})})}const Jf=["permission denied","not allowed","invalid session","401","invalid api key","unauthorized"];var qf=class{connection;config;constructor(e){this.config=e,this.connection=new Gf({onRemoteStream:e.onRemoteStream,onStateChange:e.onConnectionStateChange,onError:e.onError,customizeOffer:e.customizeOffer,vp8MinBitrate:e.vp8MinBitrate,vp8StartBitrate:e.vp8StartBitrate})}async connect(e){return Xf(async()=>(await this.connection.connect(this.config.webrtcUrl,e,6e4,this.config.integration),!0),{retries:5,factor:2,minTimeout:1e3,maxTimeout:1e4,onFailedAttempt:t=>{console.error(`[WebRTC] Failed to connect: ${t.message}`),this.connection.cleanup()},shouldRetry:t=>{const r=t.message.toLowerCase();return!Jf.some(i=>r.includes(i))}})}sendMessage(e){this.connection.send(e)}cleanup(){this.connection.cleanup()}isConnected(){return this.connection.state==="connected"}getConnectionState(){return this.connection.state}getWebsocketMessageEmitter(){return this.connection.websocketMessagesEmitter}};const Te=[];for(let e=0;e<256;++e)Te.push((e+256).toString(16).slice(1));function Qf(e,t=0){return(Te[e[t+0]]+Te[e[t+1]]+Te[e[t+2]]+Te[e[t+3]]+"-"+Te[e[t+4]]+Te[e[t+5]]+"-"+Te[e[t+6]]+Te[e[t+7]]+"-"+Te[e[t+8]]+Te[e[t+9]]+"-"+Te[e[t+10]]+Te[e[t+11]]+Te[e[t+12]]+Te[e[t+13]]+Te[e[t+14]]+Te[e[t+15]]).toLowerCase()}let sr;const eh=new Uint8Array(16);function th(){if(!sr){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");sr=crypto.getRandomValues.bind(crypto)}return sr(eh)}const nh=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),ri={randomUUID:nh};function rh(e,t,r){if(ri.randomUUID&&!e)return ri.randomUUID();e=e||{};const i=e.random??e.rng?.()??th();if(i.length<16)throw new Error("Random bytes length must be >= 16");return i[6]=i[6]&15|64,i[8]=i[8]&63|128,Qf(i)}const oh=jf,ih=e=>Li(t=>e.implementAsync(t)),sh=we({model:If,onRemoteStream:Li(e=>typeof e=="function",{message:"onRemoteStream must be a function"}),initialState:oh.optional(),customizeOffer:ih(xf()).optional()}),ah=e=>{const{baseUrl:t,apiKey:r,integration:i}=e;return{connect:async(u,l)=>{const m=Fi(),w=sh.safeParse(l);if(!w.success)throw w.error;const b=rh(),{onRemoteStream:z,initialState:A}=w.data,S=`${t}${l.model.urlPath}`,F=new qf({webrtcUrl:`${S}?api_key=${r}&model=${l.model.name}`,apiKey:r,sessionId:b,fps:l.model.fps,initialState:A,integration:i,onRemoteStream:z,onConnectionStateChange:C=>{m.emit("connectionChange",C)},onError:C=>{console.error("WebRTC error:",C),m.emit("error",Qs(C))},customizeOffer:l.customizeOffer,vp8MinBitrate:300,vp8StartBitrate:600});await F.connect(u);const E=$f(F);if(l.initialState&&l.initialState.prompt){const{text:C,enhance:H}=l.initialState.prompt;E.setPrompt(C,{enhance:H})}return{setPrompt:E.setPrompt,isConnected:()=>F.isConnected(),getConnectionState:()=>F.getConnectionState(),disconnect:()=>F.cleanup(),on:m.on,off:m.off,sessionId:b}}}},ch=e=>{const t=globalThis;if(typeof t.process<"u")return t.process.env?.[e]?.trim();if(typeof t.Deno<"u")return t.Deno.env?.get?.(e)?.trim()},uh=we({apiKey:Me().min(1).optional(),baseUrl:Bi().optional(),integration:Me().optional()}),lh=(e={})=>{const t=e.apiKey??ch("DECART_API_KEY");if(!t)throw Js();const r=uh.safeParse({...e,apiKey:t});if(!r.success)throw r.error.issues[0].path.includes("baseUrl")?qs(e.baseUrl):r.error;const{baseUrl:i="https://api.decart.ai",integration:a}=r.data,u=ah({baseUrl:"wss://api3.decart.ai",apiKey:t,integration:a}),l=ia({baseUrl:i,apiKey:t,integration:a}),m=ca({baseUrl:i,apiKey:t,integration:a});return{realtime:u,process:l,queue:m}};let Dt=null,Lt=null;async function fh(e="Cyberpunk city"){try{const t=Pf.realtime("mirage_v2");Lt=await navigator.mediaDevices.getUserMedia({audio:!0,video:{frameRate:t.fps,width:t.width,height:t.height}}),Dt=await lh({apiKey:"test_YnjzrXCPYMWBIzaXknpnpfIDhSOoWmmPVypWlxcIullrCmleQvhJuydFHxoqFyxh"}).realtime.connect(Lt,{model:t,onRemoteStream:a=>{const u=document.querySelector("#mirage-video-output");u&&(u.srcObject=a,u.play().catch(l=>console.error("Error playing video:",l)))}}),Dt.setPrompt(e);const i=document.getElementById("mirage-container");i&&i.classList.add("active")}catch(t){console.error("Failed to start Mirage stream:",t)}}function hh(){Dt&&(Dt.disconnect(),Dt=null),Lt&&(Lt.getTracks().forEach(r=>r.stop()),Lt=null);const e=document.getElementById("mirage-container");e&&e.classList.remove("active");const t=document.querySelector("#mirage-video-output");t&&(t.srcObject=null)}let Ce,Ae,_t,B,Ni=[],Wi=[],Vi,Tt={},Yi=0,mn=0,oi=!1,Ft=null,$e=null,St=0,zn=null,Tr=!1,ht=null,Nt=null;const yn=[];let ii=0;const dh=350;let Rt=null,fr=null,hr=null,dr=null,si=null,ai=null,ci=null,ui=!1,Je={name:"Player",outfitColor:"#e74c3c",skinColor:"#ffd5b5",hairColor:"#2c1810",hairStyle:0,accessory:0,hat:0};const li={wordsLearned:[{polish:"Cze",english:"Hello",pronunciation:"cheshch"},{polish:"Dzikuj",english:"Thank you",pronunciation:"jen-KOO-yeh"},{polish:"Prosz",english:"Please / You're welcome",pronunciation:"PRO-sheh"},{polish:"Tak",english:"Yes",pronunciation:"tahk"},{polish:"Nie",english:"No",pronunciation:"nyeh"},{polish:"Dzie dobry",english:"Good day",pronunciation:"jen DOB-ri"},{polish:"Do widzenia",english:"Goodbye",pronunciation:"do vee-DZEN-ya"},{polish:"Przepraszam",english:"Excuse me / Sorry",pronunciation:"psheh-PRA-shahm"}],attempts:[{word:"Cze",accuracy:92,status:"good"},{word:"Dzikuj",accuracy:78,status:"medium"},{word:"Przepraszam",accuracy:65,status:"medium"},{word:"Prosz",accuracy:88,status:"good"},{word:"Do widzenia",accuracy:45,status:"poor"},{word:"Dzie dobry",accuracy:71,status:"medium"}]},ph=[{name:"Elder Frost",position:{x:15,z:15},appearance:{skinColor:16766389,outfitColor:4886745,outfitSecondary:9136404,outfitStyle:"robe",hairColor:13421772,hairStyle:"bald",hat:"none",accessory:"glasses",hasBeard:!0,pantsColor:2899536},dialogue:[{speaker:"npc",text:"Cze! Welcome to our village, traveler!"},{speaker:"player",text:"Hello! This place is beautiful."},{speaker:"npc",text:"Dzikuj! The winter has been harsh..."},{speaker:"npc",text:"But we manage with good company!"},{speaker:"player",text:"I'd love to learn more about your culture."},{speaker:"npc",text:"Feel free to explore! Do widzenia!"}]},{name:"Farmer Beet",position:{x:-20,z:10},appearance:{skinColor:13010498,outfitColor:3447003,outfitSecondary:2719929,outfitStyle:"overalls",hairColor:2889744,hairStyle:"short",hat:"straw",accessory:"none",hasBeard:!1,pantsColor:3447003},dialogue:[{speaker:"npc",text:"Dzie dobry, stranger!"},{speaker:"player",text:"Good morning! Nice farm you have."},{speaker:"npc",text:"Dzikuj! I grow the best turnips!"},{speaker:"npc",text:"Even in winter, my greenhouse works."},{speaker:"player",text:"That's impressive dedication!"},{speaker:"npc",text:"Prosz, stop by for vegetables anytime!"}]},{name:"Blacksmith Ember",position:{x:25,z:-15},appearance:{skinColor:9262372,outfitColor:4861984,outfitSecondary:9136404,outfitStyle:"apron",hairColor:1710618,hairStyle:"mohawk",hat:"none",accessory:"goggles",hasBeard:!0,pantsColor:2889744},dialogue:[{speaker:"npc",text:"*clang clang* Cze! A visitor!"},{speaker:"player",text:"Hello! What are you working on?"},{speaker:"npc",text:"I forge the finest tools here."},{speaker:"player",text:"Your craftsmanship looks amazing."},{speaker:"npc",text:"Dzikuj! Let me know if you need anything crafted!"}]},{name:"Merchant Luna",position:{x:-15,z:-20},appearance:{skinColor:16105626,outfitColor:10181046,outfitSecondary:9323693,outfitStyle:"dress",hairColor:15277667,hairStyle:"long",hat:"beret",accessory:"earrings",hasBeard:!1,pantsColor:10181046},dialogue:[{speaker:"npc",text:"Dzie dobry, dear customer~"},{speaker:"player",text:"What do you sell here?"},{speaker:"npc",text:"I have wares from across the land!"},{speaker:"npc",text:"Prosz, take a look around~"},{speaker:"player",text:"I'll definitely browse your collection."},{speaker:"npc",text:"Dzikuj! Do widzenia!"}]},{name:"Guard Rex",position:{x:0,z:30},appearance:{skinColor:16766389,outfitColor:2899536,outfitSecondary:15844367,outfitStyle:"uniform",hairColor:2889744,hairStyle:"buzz",hat:"police",accessory:"badge",hasBeard:!1,pantsColor:2899536},dialogue:[{speaker:"npc",text:"Halt! State your business!"},{speaker:"player",text:"I'm just exploring the village..."},{speaker:"npc",text:"...Just kidding! Cze!"},{speaker:"npc",text:"I'm Rex, head of the guard."},{speaker:"player",text:"Is it safe around here?"},{speaker:"npc",text:"Tak! Very peaceful. Stay vigilant though!"}]},{name:"Chef Pierre",position:{x:35,z:5},appearance:{skinColor:16766389,outfitColor:16777215,outfitSecondary:15844367,outfitStyle:"chef",hairColor:2889744,hairStyle:"curly",hat:"chef",accessory:"mustache",hasBeard:!1,pantsColor:1710638},dialogue:[{speaker:"npc",text:"Bon appetit! I mean... Cze!"},{speaker:"player",text:"Something smells delicious!"},{speaker:"npc",text:"Dzikuj! I'm preparing pierogi today!"},{speaker:"npc",text:"Polish cuisine is magnifique!"},{speaker:"player",text:"I'd love to try some!"},{speaker:"npc",text:"Prosz, visit me after cooking!"}]},{name:"Builder Kaz",position:{x:-30,z:-30},appearance:{skinColor:13010498,outfitColor:15965202,outfitSecondary:13421772,outfitStyle:"vest",hairColor:1710618,hairStyle:"flat",hat:"hardhat",accessory:"none",hasBeard:!0,pantsColor:3426654},dialogue:[{speaker:"npc",text:"Cze! Watch your step here!"},{speaker:"player",text:"What are you building?"},{speaker:"npc",text:"A new community center!"},{speaker:"npc",text:"Everyone in the village helps out."},{speaker:"player",text:"That's wonderful teamwork!"},{speaker:"npc",text:"Tak! Do widzenia, stay safe!"}]},{name:"Artist Mila",position:{x:-40,z:25},appearance:{skinColor:16105626,outfitColor:1752220,outfitSecondary:1482885,outfitStyle:"smock",hairColor:10181046,hairStyle:"pigtails",hat:"none",accessory:"paintbrush",hasBeard:!1,pantsColor:9323693},dialogue:[{speaker:"npc",text:"Dzie dobry, fellow creative!"},{speaker:"player",text:"Your paintings are beautiful!"},{speaker:"npc",text:"Dzikuj! Art captures the soul!"},{speaker:"npc",text:"Would you like to see my gallery?"},{speaker:"player",text:"I'd love that!"},{speaker:"npc",text:"Prosz, follow me sometime!"}]},{name:"Sailor Jack",position:{x:45,z:25},appearance:{skinColor:14395770,outfitColor:1981023,outfitSecondary:16777215,outfitStyle:"striped",hairColor:16113744,hairStyle:"short",hat:"cap",accessory:"none",hasBeard:!0,pantsColor:1710638},dialogue:[{speaker:"npc",text:"Ahoy there! Cze, landluber!"},{speaker:"player",text:"A sailor? In a winter village?"},{speaker:"npc",text:"Ha! The lake freezes, but sailors never rest!"},{speaker:"npc",text:"Dzikuj for the company!"},{speaker:"player",text:"Any stories from the waters?"},{speaker:"npc",text:"Many! Come visit my boat sometime. Do widzenia!"}]},{name:"Nurse Rosa",position:{x:-50,z:-10},appearance:{skinColor:16772306,outfitColor:16738740,outfitSecondary:16777215,outfitStyle:"scrubs",hairColor:16739179,hairStyle:"ponytail",hat:"none",accessory:"glasses",hasBeard:!1,pantsColor:16738740},dialogue:[{speaker:"npc",text:"Dzie dobry! Are you feeling well?"},{speaker:"player",text:"I'm fine, just exploring!"},{speaker:"npc",text:"That's wonderful! Stay warm out there."},{speaker:"npc",text:"The cold can be harsh on newcomers."},{speaker:"player",text:"Any health tips?"},{speaker:"npc",text:"Drink warm tea! Prosz, visit if you need anything!"}]},{name:"Scholar Tym",position:{x:50,z:-30},appearance:{skinColor:10840890,outfitColor:4854924,outfitSecondary:9136404,outfitStyle:"robe",hairColor:2600544,hairStyle:"wavy",hat:"wizard",accessory:"round_glasses",hasBeard:!1,pantsColor:2889744},dialogue:[{speaker:"npc",text:"Cze, curious traveler!"},{speaker:"player",text:"Are you a wizard?"},{speaker:"npc",text:"A scholar! Though some call me... mysterious."},{speaker:"npc",text:"Dzikuj for visiting the library!"},{speaker:"player",text:"What do you study?"},{speaker:"npc",text:"Languages! Polish is fascinating. Do widzenia!"}]},{name:"Thief Marcus",position:{x:-55,z:40},appearance:{skinColor:6044974,outfitColor:1710618,outfitSecondary:2899536,outfitStyle:"cloak",hairColor:1710618,hairStyle:"slickback",hat:"hood",accessory:"eyepatch",hasBeard:!0,pantsColor:1710638},dialogue:[{speaker:"npc",text:"Psst... Cze, stranger."},{speaker:"player",text:"Who are you?"},{speaker:"npc",text:"Just a... traveling merchant. Tak, that's it."},{speaker:"npc",text:"I have rare items, if you're interested."},{speaker:"player",text:"Sounds suspicious..."},{speaker:"npc",text:"Nie, nie! Everything is legitimate! Do widzenia!"}]},{name:"Dancer Zofia",position:{x:20,z:45},appearance:{skinColor:16105626,outfitColor:15158332,outfitSecondary:15844367,outfitStyle:"dress",hairColor:2889744,hairStyle:"curly",hat:"flower",accessory:"earrings",hasBeard:!1,pantsColor:15158332},dialogue:[{speaker:"npc",text:"Dzie dobry! Care to dance?"},{speaker:"player",text:"I don't know how to dance..."},{speaker:"npc",text:"That's okay! Feel the music in your heart!"},{speaker:"npc",text:"Polish folk dances are beautiful!"},{speaker:"player",text:"Maybe you could teach me sometime?"},{speaker:"npc",text:"Tak! Dzikuj for your enthusiasm! Do widzenia!"}]},{name:"Miner Gus",position:{x:-25,z:55},appearance:{skinColor:9262372,outfitColor:5597999,outfitSecondary:9127187,outfitStyle:"overalls",hairColor:9127187,hairStyle:"buzz",hat:"hardhat",accessory:"goggles",hasBeard:!0,pantsColor:5597999},dialogue:[{speaker:"npc",text:"Cze! Fresh from the mines!"},{speaker:"player",text:"What do you mine here?"},{speaker:"npc",text:"Precious gems and coal!"},{speaker:"npc",text:"Dzikuj for asking! Most folks avoid us miners."},{speaker:"player",text:"It sounds like hard work."},{speaker:"npc",text:"Tak, but rewarding! Do widzenia, friend!"}]}];window.addEventListener("load",mh);function mh(){const e=localStorage.getItem("playerCharacter");e&&(Je=JSON.parse(e)),document.getElementById("playerName").textContent=Je.name||"Player",yh(),_h(),bh(),Th(),xh(),Rh(),Mh(),zh(),Ah(),Ch(),gh();const t=document.querySelector(".input_video"),r=document.querySelector(".output_canvas");t&&r&&Ls(t,r),Eh(),Vi=new THREE.Clock,Xi()}function yh(){["sounds/footstep_snow_1.mp3","sounds/footstep_snow_2.mp3","sounds/footstep_snow_3.mp3","sounds/footstep_snow_4.mp3"].forEach(t=>{const r=new Audio(t);r.volume=.4,yn.push(r)}),Rt=new Audio("sounds/ambient_wind.mp3"),Rt.loop=!0,Rt.volume=.3,fr=new Audio("sounds/dialogue_open.mp3"),fr.volume=.5,hr=new Audio("sounds/dialogue_advance.mp3"),hr.volume=.4,dr=new Audio("sounds/interact_prompt.mp3"),dr.volume=.3,si=new Audio("sounds/cat_meow.mp3"),si.volume=.6,ai=new Audio("sounds/bird_chirp.mp3"),ai.volume=.5,ci=new Audio("sounds/quest_complete.mp3"),ci.volume=.6}function xr(e){if(e){const t=e.cloneNode();t.volume=e.volume,t.play().catch(()=>{})}}function vh(){Rt&&Rt.paused&&Rt.play().catch(()=>{})}function wh(){const e=Date.now();if(e-ii<dh||(ii=e,yn.length===0))return;const r=yn[Math.floor(Math.random()*yn.length)].cloneNode();r.volume=.3+Math.random()*.2,r.playbackRate=.9+Math.random()*.2,r.play().catch(()=>{})}function gh(){const e=document.getElementById("journalBtn"),t=document.getElementById("journalBtnChat"),r=document.getElementById("journalModal"),i=document.getElementById("journalClose");e.addEventListener("click",()=>{pr(),r.classList.add("active")}),t.addEventListener("click",()=>{pr(),r.classList.add("active")}),i.addEventListener("click",()=>{r.classList.remove("active")}),r.addEventListener("click",a=>{a.target===r&&r.classList.remove("active")})}function pr(){const e=document.getElementById("wordList");e.innerHTML=li.wordsLearned.map(r=>`
        <div class="word-item">
            <div class="word-polish">${r.polish}</div>
            <div class="word-english">${r.english}</div>
            <div class="word-pronunciation">/${r.pronunciation}/</div>
        </div>
    `).join("");const t=document.getElementById("attemptList");t.innerHTML=li.attempts.map(r=>`
        <div class="attempt-item">
            <span class="attempt-word">${r.word}</span>
            <span class="attempt-accuracy ${r.status}">${r.accuracy}%</span>
        </div>
    `).join("")}function Eh(){const e=document.getElementById("loadingBar");let t=0;const r=setInterval(()=>{t+=Math.random()*15,t>=100&&(t=100,clearInterval(r),setTimeout(()=>{document.getElementById("loadingScreen").classList.add("hidden")},500)),e.style.width=t+"%"},200)}function _h(){Ce=new THREE.Scene,Ce.background=new THREE.Color(8900331),Ce.fog=new THREE.Fog(13166840,50,150),Ae=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,1e3),Ae.position.set(0,5,10),_t=new THREE.WebGLRenderer({canvas:document.getElementById("gameCanvas"),antialias:!0}),_t.setSize(window.innerWidth,window.innerHeight),_t.shadowMap.enabled=!0,_t.shadowMap.type=THREE.PCFSoftShadowMap,window.addEventListener("resize",()=>{Ae.aspect=window.innerWidth/window.innerHeight,Ae.updateProjectionMatrix(),_t.setSize(window.innerWidth,window.innerHeight)})}function bh(){const e=new THREE.AmbientLight(11584734,.6);Ce.add(e);const t=new THREE.DirectionalLight(16777215,.8);t.position.set(50,100,50),t.castShadow=!0,t.shadow.mapSize.width=2048,t.shadow.mapSize.height=2048,t.shadow.camera.near=.5,t.shadow.camera.far=500,t.shadow.camera.left=-100,t.shadow.camera.right=100,t.shadow.camera.top=100,t.shadow.camera.bottom=-100,Ce.add(t);const r=new THREE.HemisphereLight(8900331,10017165,.4);Ce.add(r)}function Th(){const e=new THREE.PlaneGeometry(200,200,50,50),t=new THREE.MeshStandardMaterial({color:16777215,roughness:.8,metalness:.1}),r=e.attributes.position;for(let a=0;a<r.count;a++)r.setZ(a,Math.random()*.5);e.computeVertexNormals();const i=new THREE.Mesh(e,t);i.rotation.x=-Math.PI/2,i.receiveShadow=!0,Ce.add(i);for(let a=0;a<30;a++){const u=new THREE.CircleGeometry(1+Math.random()*2,8),l=new THREE.MeshStandardMaterial({color:5933658}),m=new THREE.Mesh(u,l);m.rotation.x=-Math.PI/2,m.position.set((Math.random()-.5)*150,.01,(Math.random()-.5)*150),Ce.add(m)}}function xh(){B=new THREE.Group;const e=parseInt(Je.outfitColor.replace("#","0x")),t=parseInt(Je.skinColor.replace("#","0x")),r=parseInt(Je.hairColor.replace("#","0x")),i=["Spiky","Mohawk","Flat Top","Long","Short","Ponytail","Bald","Curly","Afro","Pigtails","Buzz Cut","Side Part"],a=["None","Cap","Beanie","Top Hat","Cowboy","Hard Hat","Crown","Headphones","Police Cap","Beret"],u=["None","Glasses","Sunglasses","Round Glasses","Eye Patch","Monocle","Bandana","Scarf"],l=i[Je.hairStyle]||"Spiky",m=a[Je.hat]||"None",w=u[Je.accessory]||"None",b=new THREE.BoxGeometry(.5,1,.5),z=new THREE.MeshStandardMaterial({color:3816026}),A=new THREE.Mesh(b,z);A.position.set(-.35,.5,0),A.castShadow=!0,B.add(A);const S=new THREE.Mesh(b,z);S.position.set(.35,.5,0),S.castShadow=!0,B.add(S);const F=new THREE.BoxGeometry(.55,.25,.6),E=new THREE.MeshStandardMaterial({color:4861984}),C=new THREE.Mesh(F,E);C.position.set(-.35,.12,.05),B.add(C);const H=new THREE.Mesh(F,E);H.position.set(.35,.12,.05),B.add(H);const O=new THREE.BoxGeometry(1.5,2,1),K=new THREE.MeshStandardMaterial({color:e}),Y=new THREE.Mesh(O,K);Y.position.y=2,Y.castShadow=!0,B.add(Y);const $=new THREE.BoxGeometry(.4,1.5,.4),re=new THREE.MeshStandardMaterial({color:t}),De=new THREE.Mesh($,re);De.position.set(-.95,2.2,0),De.castShadow=!0,B.add(De);const xe=new THREE.Mesh($,re);xe.position.set(.95,2.2,0),xe.castShadow=!0,B.add(xe);const fe=new THREE.BoxGeometry(.35,.35,.35),Re=new THREE.MeshStandardMaterial({color:t}),g=new THREE.Mesh(fe,Re);g.position.set(-.95,1.3,0),B.add(g);const T=new THREE.Mesh(fe,Re);T.position.set(.95,1.3,0),B.add(T);const N=new THREE.BoxGeometry(1,1,1),Z=new THREE.MeshStandardMaterial({color:t}),ee=new THREE.Mesh(N,Z);ee.position.y=3.5,ee.castShadow=!0,B.add(ee);const ae=new THREE.BoxGeometry(.18,.18,.1),M=new THREE.MeshStandardMaterial({color:2894892}),L=new THREE.Mesh(ae,M);L.position.set(-.25,3.55,.5),B.add(L);const q=new THREE.Mesh(ae,M);q.position.set(.25,3.55,.5),B.add(q);const ne=new THREE.BoxGeometry(.06,.06,.05),ve=new THREE.MeshStandardMaterial({color:16777215,emissive:16777215,emissiveIntensity:.5}),Ge=new THREE.Mesh(ne,ve);Ge.position.set(-.22,3.58,.55),B.add(Ge);const ge=new THREE.Mesh(ne,ve);ge.position.set(.28,3.58,.55),B.add(ge);const Ee=new THREE.BoxGeometry(.22,.06,.1),Pe=new THREE.MeshStandardMaterial({color:r}),je=new THREE.Mesh(Ee,Pe);je.position.set(-.25,3.72,.5),B.add(je);const Qe=new THREE.Mesh(Ee,Pe);Qe.position.set(.25,3.72,.5),B.add(Qe);const vt=new THREE.BoxGeometry(.3,.08,.1),it=new THREE.MeshStandardMaterial({color:9127187}),st=new THREE.Mesh(vt,it);st.position.set(0,3.25,.5),B.add(st);const pe=new THREE.MeshStandardMaterial({color:r});if(l!=="Bald"){if(l==="Spiky"){const X=new THREE.BoxGeometry(.2,.4,.2);[[-.3,4.2,.2],[0,4.3,.2],[.3,4.2,.2],[-.2,4.15,-.2],[.2,4.15,-.2]].forEach(_=>{const y=new THREE.Mesh(X,pe);y.position.set(..._),B.add(y)})}else if(l==="Short"||l==="Buzz Cut"){const X=new THREE.BoxGeometry(1.05,.3,1.05),R=new THREE.Mesh(X,pe);R.position.set(0,4.1,0),B.add(R)}else if(l==="Mohawk"){const X=new THREE.BoxGeometry(.25,.7,.8),R=new THREE.Mesh(X,pe);R.position.set(0,4.3,0),B.add(R)}else if(l==="Long"){const X=new THREE.BoxGeometry(1.1,.3,1.1),R=new THREE.Mesh(X,pe);R.position.set(0,4.1,0),B.add(R);const _=new THREE.BoxGeometry(.2,1.2,1.1),y=new THREE.Mesh(_,pe);y.position.set(-.55,3.5,0),B.add(y);const P=new THREE.Mesh(_,pe);P.position.set(.55,3.5,0),B.add(P)}else if(l==="Curly"||l==="Afro"){const X=l==="Afro"?.5:.35,R=new THREE.BoxGeometry(X,X,X);[[-.3,4.15,.2],[.3,4.15,.2],[0,4.2,.3],[-.35,4.1,-.2],[.35,4.1,-.2],[0,4.15,-.3]].forEach(y=>{const P=new THREE.Mesh(R,pe);P.position.set(...y),B.add(P)})}else if(l==="Ponytail"){const X=new THREE.BoxGeometry(1.05,.2,1.05),R=new THREE.Mesh(X,pe);R.position.set(0,4.05,0),B.add(R);const _=new THREE.BoxGeometry(.25,.8,.25),y=new THREE.Mesh(_,pe);y.position.set(0,3.5,-.5),B.add(y)}else if(l==="Pigtails"){const X=new THREE.BoxGeometry(1.05,.2,1.05),R=new THREE.Mesh(X,pe);R.position.set(0,4.05,0),B.add(R);const _=new THREE.BoxGeometry(.25,.8,.25),y=new THREE.Mesh(_,pe);y.position.set(-.55,3.5,0),B.add(y);const P=new THREE.Mesh(_,pe);P.position.set(.55,3.5,0),B.add(P)}else if(l==="Flat Top"){const X=new THREE.BoxGeometry(1.1,.25,1.1),R=new THREE.Mesh(X,pe);R.position.set(0,4.1,0),B.add(R)}else if(l==="Side Part"){const X=new THREE.BoxGeometry(1.1,.35,1.05),R=new THREE.Mesh(X,pe);R.position.set(-.1,4.1,0),B.add(R)}}if(m!=="None"){if(m==="Cap"){const X=new THREE.BoxGeometry(1.1,.35,1.1),R=new THREE.MeshStandardMaterial({color:2899536}),_=new THREE.Mesh(X,R);_.position.set(0,4.15,0),B.add(_);const y=new THREE.BoxGeometry(.8,.1,.4),P=new THREE.Mesh(y,R);P.position.set(0,4.05,.6),B.add(P)}else if(m==="Beanie"){const X=new THREE.BoxGeometry(1.1,.5,1.1),R=new THREE.MeshStandardMaterial({color:9323693}),_=new THREE.Mesh(X,R);_.position.set(0,4.2,0),B.add(_)}else if(m==="Crown"){const X=new THREE.BoxGeometry(1.1,.2,1.1),R=new THREE.MeshStandardMaterial({color:15844367,emissive:15844367,emissiveIntensity:.2}),_=new THREE.Mesh(X,R);_.position.set(0,4.1,0),B.add(_);const y=new THREE.BoxGeometry(.15,.3,.15);[[-.35,4.35,0],[0,4.4,0],[.35,4.35,0]].forEach(D=>{const J=new THREE.Mesh(y,R);J.position.set(...D),B.add(J)})}}if(w!=="None"){if(w==="Glasses"||w==="Round Glasses"){const X=new THREE.BoxGeometry(.9,.2,.1),R=new THREE.MeshStandardMaterial({color:3355443}),_=new THREE.Mesh(X,R);_.position.set(0,3.55,.55),B.add(_)}else if(w==="Sunglasses"){const X=new THREE.BoxGeometry(.28,.2,.1),R=new THREE.MeshStandardMaterial({color:1118481}),_=new THREE.Mesh(X,R);_.position.set(-.25,3.55,.55),B.add(_);const y=new THREE.Mesh(X,R);y.position.set(.25,3.55,.55),B.add(y)}else if(w==="Scarf"){const X=new THREE.BoxGeometry(1.6,.3,.3),R=new THREE.MeshStandardMaterial({color:15158332}),_=new THREE.Mesh(X,R);_.position.set(0,2.9,.3),B.add(_)}}B.position.set(0,0,0),Ce.add(B)}function Rh(){ph.forEach(e=>{const t=kh(e.appearance);t.position.set(e.position.x,0,e.position.z),t.userData.name=e.name,t.userData.dialogue=e.dialogue,t.userData.appearance=e.appearance,Ni.push(t),Ce.add(t),e.name})}function kh(e){const t=new THREE.Group,{skinColor:r,outfitColor:i,outfitSecondary:a,outfitStyle:u,hairColor:l,hairStyle:m,hat:w,accessory:b,hasBeard:z,pantsColor:A}=e,S=new THREE.BoxGeometry(.5,1,.5),F=new THREE.MeshStandardMaterial({color:A||3816026}),E=new THREE.Mesh(S,F);E.position.set(-.35,.5,0),E.castShadow=!0,t.add(E);const C=new THREE.Mesh(S,F);C.position.set(.35,.5,0),C.castShadow=!0,t.add(C);const H=new THREE.BoxGeometry(.55,.25,.6),O=new THREE.MeshStandardMaterial({color:4861984}),K=new THREE.Mesh(H,O);K.position.set(-.35,.12,.05),t.add(K);const Y=new THREE.Mesh(H,O);Y.position.set(.35,.12,.05),t.add(Y);let $=1.5,re=2;if(u==="dress"){const R=new THREE.BoxGeometry(1.8,2.2,1),_=new THREE.MeshStandardMaterial({color:i}),y=new THREE.Mesh(R,_);y.position.y=2,y.castShadow=!0,t.add(y);const P=new THREE.BoxGeometry(1.85,.15,1.05),D=new THREE.MeshStandardMaterial({color:a||15844367}),J=new THREE.Mesh(P,D);J.position.y=1,t.add(J)}else if(u==="striped"){const R=new THREE.BoxGeometry($,re,1),_=new THREE.MeshStandardMaterial({color:i}),y=new THREE.Mesh(R,_);y.position.y=2,y.castShadow=!0,t.add(y);const P=a||16777215;for(let D=0;D<4;D++){const J=new THREE.BoxGeometry($+.02,.25,1.02),me=new THREE.MeshStandardMaterial({color:P}),ye=new THREE.Mesh(J,me);ye.position.y=1.3+D*.5,t.add(ye)}}else if(u==="cloak"){const R=new THREE.BoxGeometry(1.8,2.3,1.2),_=new THREE.MeshStandardMaterial({color:i}),y=new THREE.Mesh(R,_);y.position.y=2,y.castShadow=!0,t.add(y)}else if(u==="scrubs"){const R=new THREE.BoxGeometry($,re,1),_=new THREE.MeshStandardMaterial({color:i}),y=new THREE.Mesh(R,_);y.position.y=2,y.castShadow=!0,t.add(y);const P=new THREE.BoxGeometry(.4,.3,.1),D=new THREE.MeshStandardMaterial({color:r}),J=new THREE.Mesh(P,D);J.position.set(0,2.85,.5),t.add(J)}else{const R=new THREE.BoxGeometry($,re,1),_=new THREE.MeshStandardMaterial({color:i}),y=new THREE.Mesh(R,_);y.position.y=2,y.castShadow=!0,t.add(y)}if(u==="overalls"){const R=new THREE.BoxGeometry(.15,.8,.1),_=new THREE.MeshStandardMaterial({color:i}),y=new THREE.Mesh(R,_);y.position.set(-.4,2.8,.5),t.add(y);const P=new THREE.Mesh(R,_);P.position.set(.4,2.8,.5),t.add(P)}else if(u==="uniform"||u==="chef"){const R=new THREE.BoxGeometry(.12,.12,.1),_=new THREE.MeshStandardMaterial({color:15844367});for(let y=0;y<3;y++){const P=new THREE.Mesh(R,_);P.position.set(0,2.6-y*.4,.55),t.add(P)}}else if(u==="apron"){const R=new THREE.BoxGeometry(1.2,1.5,.15),_=new THREE.MeshStandardMaterial({color:9136404}),y=new THREE.Mesh(R,_);y.position.set(0,1.8,.55),t.add(y)}else if(u==="vest"){const R=new THREE.BoxGeometry(.1,1.5,.1),_=new THREE.MeshStandardMaterial({color:13421772,emissive:4473924}),y=new THREE.Mesh(R,_);y.position.set(-.5,2.2,.55),t.add(y);const P=new THREE.Mesh(R,_);P.position.set(.5,2.2,.55),t.add(P)}else if(u==="robe"){const R=new THREE.BoxGeometry(1.6,.3,.3),_=new THREE.MeshStandardMaterial({color:a||9136404}),y=new THREE.Mesh(R,_);y.position.set(0,2.85,.3),t.add(y)}else if(u==="smock"){const R=new THREE.BoxGeometry(1.6,2.1,1),_=new THREE.MeshStandardMaterial({color:i}),y=new THREE.Mesh(R,_);y.position.y=2,y.castShadow=!0,t.add(y);const P=[15158332,15844367,3447003,10181046];[[-.4,2.3,.52],[.3,1.8,.52],[-.2,1.5,.52],[.4,2.5,.52]].forEach((J,me)=>{const ye=new THREE.BoxGeometry(.2,.2,.05),Ye=new THREE.MeshStandardMaterial({color:P[me]}),et=new THREE.Mesh(ye,Ye);et.position.set(...J),t.add(et)})}const De=new THREE.BoxGeometry(.4,1.5,.4),xe=new THREE.MeshStandardMaterial({color:r}),fe=new THREE.Mesh(De,xe);fe.position.set(-.95,2.2,0),fe.castShadow=!0,t.add(fe);const Re=new THREE.Mesh(De,xe);Re.position.set(.95,2.2,0),Re.castShadow=!0,t.add(Re);const g=new THREE.BoxGeometry(.35,.35,.35),T=new THREE.MeshStandardMaterial({color:r}),N=new THREE.Mesh(g,T);N.position.set(-.95,1.3,0),t.add(N);const Z=new THREE.Mesh(g,T);Z.position.set(.95,1.3,0),t.add(Z);const ee=new THREE.BoxGeometry(1,1,1),ae=new THREE.MeshStandardMaterial({color:r}),M=new THREE.Mesh(ee,ae);M.position.y=3.5,M.castShadow=!0,t.add(M);const L=new THREE.BoxGeometry(.18,.18,.1),q=new THREE.MeshStandardMaterial({color:2894892}),ne=new THREE.Mesh(L,q);ne.position.set(-.25,3.55,.5),t.add(ne);const ve=new THREE.Mesh(L,q);ve.position.set(.25,3.55,.5),t.add(ve);const Ge=new THREE.BoxGeometry(.06,.06,.05),ge=new THREE.MeshStandardMaterial({color:16777215,emissive:16777215,emissiveIntensity:.5}),Ee=new THREE.Mesh(Ge,ge);Ee.position.set(-.22,3.58,.55),t.add(Ee);const Pe=new THREE.Mesh(Ge,ge);Pe.position.set(.28,3.58,.55),t.add(Pe);const je=new THREE.BoxGeometry(.22,.06,.1),Qe=new THREE.MeshStandardMaterial({color:l}),vt=new THREE.Mesh(je,Qe);vt.position.set(-.25,3.72,.5),t.add(vt);const it=new THREE.Mesh(je,Qe);it.position.set(.25,3.72,.5),t.add(it);const st=new THREE.BoxGeometry(.3,.08,.1),pe=new THREE.MeshStandardMaterial({color:9127187}),X=new THREE.Mesh(st,pe);if(X.position.set(0,3.25,.5),t.add(X),z){const R=new THREE.BoxGeometry(.8,.5,.3),_=new THREE.MeshStandardMaterial({color:l}),y=new THREE.Mesh(R,_);y.position.set(0,3.1,.4),t.add(y)}if(m!=="bald"){const R=new THREE.MeshStandardMaterial({color:l});if(m==="short"||m==="buzz"){const _=new THREE.BoxGeometry(1.05,.3,1.05),y=new THREE.Mesh(_,R);y.position.set(0,4.1,0),t.add(y)}else if(m==="mohawk"){const _=new THREE.BoxGeometry(.25,.7,.8),y=new THREE.Mesh(_,R);y.position.set(0,4.3,0),t.add(y)}else if(m==="long"){const _=new THREE.BoxGeometry(1.1,.3,1.1),y=new THREE.Mesh(_,R);y.position.set(0,4.1,0),t.add(y);const P=new THREE.BoxGeometry(.2,1.2,1.1),D=new THREE.Mesh(P,R);D.position.set(-.55,3.5,0),t.add(D);const J=new THREE.Mesh(P,R);J.position.set(.55,3.5,0),t.add(J);const me=new THREE.BoxGeometry(1.1,1.5,.2),ye=new THREE.Mesh(me,R);ye.position.set(0,3.3,-.55),t.add(ye)}else if(m==="curly"){const _=new THREE.BoxGeometry(.35,.35,.35);[[-.3,4.15,.2],[.3,4.15,.2],[0,4.2,.3],[-.35,4.1,-.2],[.35,4.1,-.2],[0,4.15,-.3]].forEach(P=>{const D=new THREE.Mesh(_,R);D.position.set(...P),t.add(D)})}else if(m==="flat"){const _=new THREE.BoxGeometry(1.1,.25,1.1),y=new THREE.Mesh(_,R);y.position.set(0,4.1,0),t.add(y)}else if(m==="pigtails"){const _=new THREE.BoxGeometry(1.05,.2,1.05),y=new THREE.Mesh(_,R);y.position.set(0,4.05,0),t.add(y);const P=new THREE.BoxGeometry(.25,.8,.25),D=new THREE.Mesh(P,R);D.position.set(-.55,3.5,0),t.add(D);const J=new THREE.Mesh(P,R);J.position.set(.55,3.5,0),t.add(J)}else if(m==="wavy"){const _=new THREE.BoxGeometry(1.1,.4,1.1),y=new THREE.Mesh(_,R);y.position.set(0,4.15,0),t.add(y);const P=new THREE.BoxGeometry(.25,.8,.8),D=new THREE.Mesh(P,R);D.position.set(-.55,3.5,0),t.add(D);const J=new THREE.Mesh(P,R);J.position.set(.55,3.5,0),t.add(J)}else if(m==="slickback"){const _=new THREE.BoxGeometry(1.05,.25,1.1),y=new THREE.Mesh(_,R);y.position.set(0,4.08,-.05),t.add(y)}else if(m==="ponytail"){const _=new THREE.BoxGeometry(1.05,.2,1.05),y=new THREE.Mesh(_,R);y.position.set(0,4.05,0),t.add(y);const P=new THREE.BoxGeometry(.25,.9,.25),D=new THREE.Mesh(P,R);D.position.set(0,3.4,-.5),t.add(D)}}if(w!=="none"){if(w==="straw"){const R=new THREE.BoxGeometry(1.6,.15,1.6),_=new THREE.MeshStandardMaterial({color:14329120}),y=new THREE.Mesh(R,_);y.position.set(0,4.05,0),t.add(y);const P=new THREE.BoxGeometry(.9,.5,.9),D=new THREE.Mesh(P,_);D.position.set(0,4.3,0),t.add(D)}else if(w==="police"){const R=new THREE.BoxGeometry(1.1,.35,1.1),_=new THREE.MeshStandardMaterial({color:2899536}),y=new THREE.Mesh(R,_);y.position.set(0,4.15,0),t.add(y);const P=new THREE.BoxGeometry(.25,.2,.1),D=new THREE.MeshStandardMaterial({color:15844367,emissive:15844367,emissiveIntensity:.3}),J=new THREE.Mesh(P,D);J.position.set(0,4.2,.55),t.add(J);const me=new THREE.BoxGeometry(.8,.1,.4),ye=new THREE.MeshStandardMaterial({color:1710618}),Ye=new THREE.Mesh(me,ye);Ye.position.set(0,4.05,.6),t.add(Ye)}else if(w==="chef"){const R=new THREE.BoxGeometry(.9,.8,.9),_=new THREE.MeshStandardMaterial({color:16777215}),y=new THREE.Mesh(R,_);y.position.set(0,4.4,0),t.add(y);const P=new THREE.BoxGeometry(1,.4,1),D=new THREE.Mesh(P,_);D.position.set(0,4.9,0),t.add(D)}else if(w==="hardhat"){const R=new THREE.BoxGeometry(1.2,.5,1.2),_=new THREE.MeshStandardMaterial({color:15965202}),y=new THREE.Mesh(R,_);y.position.set(0,4.2,0),t.add(y)}else if(w==="beret"){const R=new THREE.BoxGeometry(1.1,.25,1.1),_=new THREE.MeshStandardMaterial({color:12597547}),y=new THREE.Mesh(R,_);y.position.set(.1,4.1,0),y.rotation.z=.15,t.add(y)}else if(w==="hood"){const R=new THREE.BoxGeometry(1.3,.8,1.3),_=new THREE.MeshStandardMaterial({color:1710618}),y=new THREE.Mesh(R,_);y.position.set(0,4,0),t.add(y);const P=new THREE.BoxGeometry(1.4,.3,.5),D=new THREE.Mesh(P,_);D.position.set(0,4.3,.5),t.add(D)}else if(w==="wizard"){const R=new THREE.BoxGeometry(1.4,.15,1.4),_=new THREE.MeshStandardMaterial({color:4854924}),y=new THREE.Mesh(R,_);y.position.set(0,4.05,0),t.add(y);const P=new THREE.BoxGeometry(.8,1.2,.8),D=new THREE.Mesh(P,_);D.position.set(0,4.7,0),t.add(D);const J=new THREE.BoxGeometry(.15,.15,.1),me=new THREE.MeshStandardMaterial({color:15844367,emissive:15844367,emissiveIntensity:.3}),ye=new THREE.Mesh(J,me);ye.position.set(0,5.2,.4),t.add(ye)}else if(w==="flower"){const R=new THREE.BoxGeometry(1.15,.2,1.15),_=new THREE.MeshStandardMaterial({color:3066993}),y=new THREE.Mesh(R,_);y.position.set(0,4.05,0),t.add(y);const P=[15158332,15844367,16738740,10181046];[[-.35,4.2,.3],[.35,4.2,.3],[0,4.25,.4],[-.4,4.15,-.2],[.4,4.15,-.2]].forEach((J,me)=>{const ye=new THREE.BoxGeometry(.2,.2,.15),Ye=new THREE.MeshStandardMaterial({color:P[me%P.length]}),et=new THREE.Mesh(ye,Ye);et.position.set(...J),t.add(et)})}else if(w==="cap"){const R=new THREE.BoxGeometry(1.1,.35,1.1),_=new THREE.MeshStandardMaterial({color:2899536}),y=new THREE.Mesh(R,_);y.position.set(0,4.15,0),t.add(y);const P=new THREE.BoxGeometry(.8,.1,.4),D=new THREE.Mesh(P,_);D.position.set(0,4.05,.6),t.add(D)}}if(b!=="none"){if(b==="glasses"||b==="goggles"){const R=b==="goggles"?9127187:3355443,_=new THREE.BoxGeometry(.9,.2,.1),y=new THREE.MeshStandardMaterial({color:R}),P=new THREE.Mesh(_,y);P.position.set(0,3.55,.55),t.add(P);const D=new THREE.BoxGeometry(.25,.2,.08),J=new THREE.MeshStandardMaterial({color:b==="goggles"?8965375:16777215,transparent:!0,opacity:.5}),me=new THREE.Mesh(D,J);me.position.set(-.25,3.55,.58),t.add(me);const ye=new THREE.Mesh(D,J);ye.position.set(.25,3.55,.58),t.add(ye)}else if(b==="badge"){const R=new THREE.BoxGeometry(.3,.35,.1),_=new THREE.MeshStandardMaterial({color:15844367,emissive:15844367,emissiveIntensity:.2}),y=new THREE.Mesh(R,_);y.position.set(-.5,2.6,.55),t.add(y)}else if(b==="earrings"){const R=new THREE.BoxGeometry(.1,.2,.1),_=new THREE.MeshStandardMaterial({color:15844367,emissive:15844367,emissiveIntensity:.3}),y=new THREE.Mesh(R,_);y.position.set(-.55,3.35,0),t.add(y);const P=new THREE.Mesh(R,_);P.position.set(.55,3.35,0),t.add(P)}else if(b==="mustache"){const R=new THREE.BoxGeometry(.5,.12,.15),_=new THREE.MeshStandardMaterial({color:2889744}),y=new THREE.Mesh(R,_);y.position.set(0,3.32,.5),t.add(y)}else if(b==="paintbrush"){const R=new THREE.BoxGeometry(.1,.6,.1),_=new THREE.MeshStandardMaterial({color:9127187}),y=new THREE.Mesh(R,_);y.position.set(.95,1.6,.3),y.rotation.x=.5,t.add(y);const P=new THREE.BoxGeometry(.15,.25,.15),D=new THREE.MeshStandardMaterial({color:15158332}),J=new THREE.Mesh(P,D);J.position.set(.95,1.95,.45),t.add(J)}else if(b==="eyepatch"){const R=new THREE.BoxGeometry(.3,.25,.1),_=new THREE.MeshStandardMaterial({color:1710618}),y=new THREE.Mesh(R,_);y.position.set(-.25,3.55,.55),t.add(y);const P=new THREE.BoxGeometry(1.2,.08,.08),D=new THREE.Mesh(P,_);D.position.set(0,3.6,.3),t.add(D)}else if(b==="round_glasses"){const R=new THREE.BoxGeometry(.9,.25,.1),_=new THREE.MeshStandardMaterial({color:14329120}),y=new THREE.Mesh(R,_);y.position.set(0,3.55,.55),t.add(y);const P=new THREE.BoxGeometry(.28,.28,.08),D=new THREE.MeshStandardMaterial({color:16777215,transparent:!0,opacity:.4}),J=new THREE.Mesh(P,D);J.position.set(-.25,3.55,.58),t.add(J);const me=new THREE.Mesh(P,D);me.position.set(.25,3.55,.58),t.add(me)}}return t}function Mh(){[{x:-40,z:-30},{x:-50,z:20},{x:45,z:-40},{x:60,z:30},{x:-30,z:50},{x:35,z:55},{x:-60,z:-50},{x:70,z:-20},{x:-45,z:40},{x:55,z:45},{x:-70,z:10},{x:40,z:-60}].forEach(t=>{const r=Sh();r.position.set(t.x,0,t.z),Ce.add(r)})}function Sh(){const e=new THREE.Group,t=new THREE.BoxGeometry(1.5,6,1.5),r=new THREE.MeshStandardMaterial({color:6964256}),i=new THREE.Mesh(t,r);i.position.y=3,i.castShadow=!0,e.add(i);const a=[2972205,3832378,4889162];for(let u=0;u<4;u++){const l=5-u*.8,m=new THREE.BoxGeometry(l,2,l),w=new THREE.MeshStandardMaterial({color:a[u%3]}),b=new THREE.Mesh(m,w);b.position.y=6+u*1.8,b.castShadow=!0,e.add(b);const z=new THREE.BoxGeometry(l+.3,.4,l+.3),A=new THREE.MeshStandardMaterial({color:16777215}),S=new THREE.Mesh(z,A);S.position.y=7+u*1.8,e.add(S)}return e}function zh(){[{x:-35,z:-10},{x:40,z:10},{x:10,z:-35},{x:-10,z:40}].forEach(t=>{const r=Hh();r.position.set(t.x,0,t.z),r.rotation.y=Math.random()*Math.PI*2,Ce.add(r)})}function Hh(){const e=new THREE.Group,t=new THREE.BoxGeometry(8,5,6),r=new THREE.MeshStandardMaterial({color:11034656}),i=new THREE.Mesh(t,r);i.position.y=2.5,i.castShadow=!0,i.receiveShadow=!0,e.add(i);const a=new THREE.BoxGeometry(9,1,7),u=new THREE.MeshStandardMaterial({color:12599360}),l=new THREE.Mesh(a,u);l.position.y=5.5,l.castShadow=!0,e.add(l);const m=new THREE.BoxGeometry(7,1,5),w=new THREE.Mesh(m,u);w.position.y=6.5,w.castShadow=!0,e.add(w);const b=new THREE.BoxGeometry(5,1,3),z=new THREE.Mesh(b,u);z.position.y=7.5,z.castShadow=!0,e.add(z);const A=new THREE.MeshStandardMaterial({color:16777215}),S=new THREE.BoxGeometry(9.5,.5,7.5),F=new THREE.Mesh(S,A);F.position.y=8,e.add(F);const E=new THREE.BoxGeometry(1.5,3,.2),C=new THREE.MeshStandardMaterial({color:4861984}),H=new THREE.Mesh(E,C);H.position.set(0,1.5,3.1),e.add(H);const O=new THREE.BoxGeometry(1.2,1.2,.2),K=new THREE.MeshStandardMaterial({color:8965375,emissive:16777096,emissiveIntensity:.3}),Y=new THREE.Mesh(O,K);Y.position.set(-2.5,3,3.1),e.add(Y);const $=new THREE.Mesh(O,K);return $.position.set(2.5,3,3.1),e.add($),e}function Ah(){const e=new THREE.BufferGeometry,t=2e3,r=new Float32Array(t*3);for(let u=0;u<t*3;u+=3)r[u]=(Math.random()-.5)*150,r[u+1]=Math.random()*50,r[u+2]=(Math.random()-.5)*150;e.setAttribute("position",new THREE.BufferAttribute(r,3));const i=new THREE.PointsMaterial({color:16777215,size:.3,transparent:!0,opacity:.8}),a=new THREE.Points(e,i);a.userData.velocities=[];for(let u=0;u<t;u++)a.userData.velocities.push({y:Math.random()*.02+.01,x:(Math.random()-.5)*.01});Wi.push(a),Ce.add(a)}function Ch(){document.addEventListener("keydown",e=>{Tt[e.key.toLowerCase()]=!0,e.key.toLowerCase()==="e"&&Ft&&!$e&&Ih(Ft),e.key===" "&&$e&&(e.preventDefault(),Oh()),e.key==="Escape"&&document.getElementById("journalModal").classList.remove("active"),e.key.toLowerCase()==="f"&&(pr(),document.getElementById("journalModal").classList.add("active"))}),document.addEventListener("keyup",e=>{Tt[e.key.toLowerCase()]=!1}),document.addEventListener("click",e=>{vh(),!$e&&!e.target.closest(".journal-btn")&&!e.target.closest(".journal-modal")&&document.body.requestPointerLock()}),document.addEventListener("pointerlockchange",()=>{oi=document.pointerLockElement===document.body}),document.addEventListener("mousemove",e=>{oi&&!$e&&(Yi+=e.movementX*.002,mn+=e.movementY*.002,mn=Math.max(-Math.PI/3,Math.min(Math.PI/3,mn)))})}function Ih(e){$e=e.userData.dialogue,zn=e,St=0,xr(fr);const t=Math.atan2(e.position.x-B.position.x,e.position.z-B.position.z);B.rotation.y=t;const r=Math.atan2(B.position.x-e.position.x,B.position.z-e.position.z);e.rotation.y=r,document.getElementById("playerInfo").classList.add("hidden"),document.getElementById("miniMap").classList.add("hidden"),document.getElementById("controlsHint").classList.add("hidden"),document.getElementById("interactPrompt").classList.remove("active"),document.getElementById("journalBtn").classList.add("hidden");const i=document.getElementById("chatContainer");i.innerHTML="",document.getElementById("chatWrapper").classList.add("active"),document.getElementById("journalBtnChat").classList.add("active"),Ae.position.clone(),Tr=!0,Ph(),document.exitPointerLock(),Ki();const l=`A realistic ${(e.userData.name||"Villager").split(" ")[0]||"Villager"} in Warsaw Old Town, Polish architecture, winter, high quality`;fh(l)}function Ph(){const e=zn,t=new THREE.Vector3;t.copy(e.position),t.y=e.position.y+3.5;const r=new THREE.Vector3(0,0,1);r.applyAxisAngle(new THREE.Vector3(0,1,0),e.rotation.y),ht=t.clone(),ht.add(r.clone().multiplyScalar(2.5)),ht.y=t.y+1.2;const i=new THREE.Vector3(-1,0,0);i.applyAxisAngle(new THREE.Vector3(0,1,0),e.rotation.y),ht.add(i.multiplyScalar(.3)),Nt=t.clone()}function jh(){Tr=!1,ht=null,Nt=null}function Ki(){if(!$e||St>=$e.length)return;const e=$e[St],t=document.getElementById("chatContainer"),r=document.createElement("div");r.className=`chat-bubble ${e.speaker}`;const i=e.speaker==="npc"?zn.userData.name:Je.name||"Player";r.innerHTML=`
        <div class="speaker-name">${i}</div>
        <div class="message-text">${e.text}</div>
    `,t.appendChild(r),t.scrollTop=t.scrollHeight,document.getElementById("continuePrompt").classList.add("active")}function Oh(){St++,St>=$e.length?$h():(xr(hr),Ki())}function $h(){$e=null,zn=null,St=0,document.getElementById("chatWrapper").classList.remove("active"),document.getElementById("journalBtnChat").classList.remove("active"),document.getElementById("continuePrompt").classList.remove("active"),document.getElementById("playerInfo").classList.remove("hidden"),document.getElementById("miniMap").classList.remove("hidden"),document.getElementById("controlsHint").classList.remove("hidden"),document.getElementById("journalBtn").classList.remove("hidden"),jh(),hh()}function Bh(e){if($e)return;const t=15,r=new THREE.Vector3,i=new THREE.Vector3;Ae.getWorldDirection(i),i.y=0,i.normalize();const a=new THREE.Vector3;a.crossVectors(i,new THREE.Vector3(0,1,0)),Tt.w&&r.add(i),Tt.s&&r.sub(i),Tt.a&&r.sub(a),Tt.d&&r.add(a);const u=Ks();if(u.x!==0||u.y!==0){const l=i.clone().multiplyScalar(-u.y),m=a.clone().multiplyScalar(u.x);r.add(l),r.add(m)}r.length()>0&&(r.normalize(),B.position.add(r.multiplyScalar(t*e)),B.rotation.y=Math.atan2(r.x,r.z),wh()),B.position.x=Math.max(-90,Math.min(90,B.position.x)),B.position.z=Math.max(-90,Math.min(90,B.position.z))}function Gh(){if(Tr&&ht&&Nt){Ae.position.lerp(ht,.08);const e=new THREE.Vector3;Ae.getWorldDirection(e),e.add(Ae.position),e.lerp(Nt,.08),Ae.lookAt(Nt)}else{const t=new THREE.Vector3(0,8,12).clone();t.applyAxisAngle(new THREE.Vector3(0,1,0),-Yi),Ae.position.copy(B.position).add(t),Ae.position.y=B.position.y+8-mn*5,Ae.lookAt(B.position.x,B.position.y+3,B.position.z)}}function Zh(){let e=null,t=1/0;Ni.forEach(u=>{const l=B.position.distanceTo(u.position);if(l<10){const m=Math.atan2(B.position.x-u.position.x,B.position.z-u.position.z);u.rotation.y=m}l<5&&l<t&&(e=u,t=l)}),Ft=e;const r=document.getElementById("interactPrompt"),i=Ft&&!$e;i?(r.classList.add("active"),ui||xr(dr)):r.classList.remove("active"),ui=i,Xs()&&Ft&&t<10?ar(!0):ar(!1)}function Uh(e){Wi.forEach(t=>{const r=t.geometry.attributes.position.array,i=t.userData.velocities;for(let a=0;a<r.length;a+=3){const u=a/3;r[a]+=i[u].x,r[a+1]-=i[u].y,r[a+1]<0&&(r[a+1]=50,r[a]=(Math.random()-.5)*150,r[a+2]=(Math.random()-.5)*150)}t.geometry.attributes.position.needsUpdate=!0})}function Xi(){requestAnimationFrame(Xi);const e=Vi.getDelta();Bh(e),Gh(),Zh(),Uh(),_t.render(Ce,Ae)}
